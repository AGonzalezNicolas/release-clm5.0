===============================================================
Tag name:  clm3_6_36
Originator(s):  erik (erik)
Date: Mon Apr 27 14:10:13 MDT 2009
One-line Summary: Handle transient aersol, make maxpatchpft=numpft+1 default, new datasets for 1.9x2.5 and 0.9x1.25, change doalb

Purpose of changes:

Changes so can do aerosol transient time-series (1850-2000) (kauff). New surfdata
datasets for 1.9x2.5 and 0.9x1.25 (1850 and 2000). New 1850-2000 pftdyn dataset for
1.9x2.5. New aerosol and ndep for 1.9x2.5 (1850 and 2000). Change to doalb from Mariana.
Make maxpatchpft=numpft+1 the default and remove all finidat files

Bugs fixed (include bugzilla ID): 936 (create_test bug)

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  920 (glacier_mec problems in mksurfdata)
                                  926 (pftdyn code needs to be shared in mksurfdata)
                                  935 (RTM warning NOT an error)
                                  937 (undef value on bangkok for maxpatchpft=numpft+1 case)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: maxpatchpft default is now numpft+1

Describe any changes made to the namelist: build-namelist now allows 1850-2000 for sim_year for transient datasets
    aerdep now chooses a transient dataset for this case as well

List any changes to the defaults for the boundary datasets:
    New aerosol deposition and nitrogen deposition datasets for 1.9x2.5 and transient
    New pftdyn dataset for 1.9x2.5 for 1850-2000
    New surfdata for 1.9x2.5 and 0.9x1.25

Describe any substantial timing or memory changes: None

Code reviewed by: self, kauff (aer transient), mvertens (doalb changes)

List any svn externals directories updated (csm_share, mct, etc.): scripts, drv, datm7, and pio
    scripts to scripts4_090424
    drv     to vocemis-drydep08_drvseq3_0_14
    datm7   to datm7_090406
    pio     to pio38_prod

List all files eliminated: None

List all files added and what they do: Add file for generic settings NOT used by a specific model component

A      models/lnd/clm/bld/namelist_files/namelist_defaults_overall.xml

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>>>>>>>>>>> Add cice decomp info, use xml input file for PE change
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_10x15_dh
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_4x5_dh
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_1.9x2.5_dh
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_64x128_s
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_0.9x1.25_dh
M      models/lnd/clm/test/system/TCT_ccsmseq.sh --- use xml file format for PE change
>>>>>>>>>>>>>>>>>>>>>>>> Base LANDMASK on SUM(PCT_PFT) rather than LANDFRAC_PFT
M      models/lnd/clm/tools/ncl_scripts/pftdyntest2raw.ncl
>>>>>>>>>>>>>>>>>>>>>>>> Add 1850-2000 simyr option
M      models/lnd/clm/bld/config_files/config_definition.xml ------ maxpatchpft default
is numpft+1
M      models/lnd/clm/bld/namelist_files/namelist_definition.xml -- Add 1850-2000 to valid sim_year values
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml - Remove finidat files, 
                                              remove data in namelist_defaults_overall,
                                              new fsurdat,forganic,furbinp for 1.9x2.5 and 0.9x1.25
                                              1850-2000 PFT dataset for 1.9x2.5
                                              new aerdep and ndep datasets for 1.9x2.5 and 0.9x1.25, 
                                              and transient 1850-2000 aerdep datasets
M      models/lnd/clm/bld/build-namelist ----------- Be careful if datasets are picked
based on full sim_year (which could be 1850-2000) or the first year (1850 finidat,
fsurdat files)
M      models/lnd/clm/bld/listDefaultNamelist.pl --- Use list of defaults files
M      models/lnd/clm/bld/queryDefaultNamelist.pl -- Use list of defaults files, remove scpto option
M      models/lnd/clm/bld/queryDefaultXML.pm ------- Use list of defaults files
>>>>>>>>>>>>>>>>>>>>>>>> doalb changes from Mariana Vertenstein (branches/new_doalb)
>>>>>>>>>>>>>>>>>>>>>>>> remove caldayp1 use next_swcday sent from atm
M      models/lnd/clm/src/biogeochem/DGVMMod.F90 ---------- remove caldayp1, send nextsw_cday
M      models/lnd/clm/src/main/clm_comp.F90 --------------- don't calcualte caldayp1, calc declinp1 based on nextsw_cday
M      models/lnd/clm/src/main/driver.F90 ----------------- Pass nextsw_cday instead of caldayp1
M      models/lnd/clm/src/main/initSurfAlbMod.F90 --------- Don't pass calday and declin
M      models/lnd/clm/src/main/lnd_comp_mct.F90 ----------- Remove never_doAlb logic, pass nextsw_cday down
M      models/lnd/clm/src/biogeophys/SurfaceAlbedoMod.F90 - cosz based on nextsw_cday NOT caldayp1
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 --------- Do NOT pass calday, declin
>>>>>>>>>>>>>>>>>>>>>>>> aerdep changes from Brian Kauffman (cbgcdev05_clm3_6_35)
M      models/lnd/clm/src/main/aerdepMod.F90 -- Time-interpolation done each time-step (rather than just each day) method slightly different.
                                                Also allows transient file where uses first year 
                                               until reaches middle years, then after last year continues to use last year.

Summary of testing:

  bluefire: All PASS except TBL and... up to test 62
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
038 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
039 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
040 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
042 smCA8 TSM.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 10
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5

CLM tag used for the baseline comparison tests if applicable: clm3_6_35

Changes answers relative to baseline: Yes -- default for maxpatchpft is numpft+1 
                                             rather than 4
                                      And aersol time-interpolation is different
                                      method is different and also does interpolation
                                      for every time-step NOT held constant each day.

===============================================================
===============================================================
Tag name:  clm3_6_35
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Mon Apr 20 15:19:17 MDT 2009
One-line Summary: Fix major logic bug in mksurfdata

Purpose of changes: Fix major logic bug in mksurfdata (bug 934) which requires us to recreate any surface datasets
                    created with clm3_6_32. The bug zero'd out LAI for some PFT's and biased the LAI values
                    (LAI, SAI, veg-bot, veg-top).

 This is a note from dlawren
   "I have taken a look at the new surface files and they look correct to me.  LAI
   is defined everywhere.  I did a quick test using this surface dataset with a
   spunup file from Keith's prior 1850 simulation and it worked fine (no errors).
    I also confirmed that indeed the gridbox mean LAI is different by up to about
   +-0.5.  In most places the difference is below +-0.1."


Bugs fixed (include bugzilla ID): 934 (pftdyn logic bug)

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  920 (glacier_mec problems in mksurfdata)
                                  926 (pftdyn code needs to be shared in mksurfdata)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Self (but new 1.9x2.5 surface dataset checked by dlawren and lawrence)

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: 

A      models/lnd/clm/tools/ncl_scripts/pftdyntest2raw.ncl --- Create raw pftdyn test datasets, so can create new ones.

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/tools/mksurfdata/mklaiMod.F90 ---------------- Fix pftdyn logic error.
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90 ---------------- Move soil-text calc higher up, allow more space for filenames
M      models/lnd/clm/tools/mksurfdata/mksurfdata.globalirrig ------ Make output in double precision
M      models/lnd/clm/tools/mksurfdata/mksurfdata.regional --------- Make output in double precision
M      models/lnd/clm/tools/mksurfdata/mksurfdata.pftdyn ----------- Make output in double precision
M      models/lnd/clm/tools/mksurfdata/mksurfdata.singlept --------- Make output in double precision
M      models/lnd/clm/tools/mksurfdata/mksurfdata.namelist --------- Make output in double precision
M      models/lnd/clm/tools/mksurfdata/mksurfdata.pl --------------- Get T62, 2x2.5 and qtr deg res's, only do 2000 for urban single-point
M      models/lnd/clm/tools/mksurfdata/pftdyn_simyr1850-2005.txt --- Allow larger size for filenames
M      models/lnd/clm/tools/mksurfdata/pftdyn_simyr2000.txt -------- Allow larger size for filenames
M      models/lnd/clm/tools/mksurfdata/pftdyn_simyr1850.txt -------- Allow larger size for filenames

MM     models/lnd/clm/tools/ncl_scripts/aerdepregrid.ncl ----------- Add svn keywords
MM     models/lnd/clm/tools/ncl_scripts/clmi_increasesoillayer.ncl - Add svn keywords
M      models/lnd/clm/tools/ncl_scripts/README --------------------- Update doc on files

Summary of testing: No testing except for mksurfdata on bluefire

001 sm774 TSMtools.sh mksurfdata tools__ds singlept .............................................PASS
002 sm754 TSMtools.sh mksurfdata tools__s globalirrig ...........................................PASS
003 sm756 TSMtools.sh mksurfdata tools__s pftdyn ................................................PASS

CLM tag used for the baseline comparison tests if applicable: clm3_6_34

Changes answers relative to baseline: no bit-for-bit (other than mksurfdata)

===============================================================
===============================================================
Tag name:  clm3_6_34
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Sun Apr 19 09:34:43 MDT 2009
One-line Summary: Fix bangkok urban bug

Purpose of changes: Fix urban bug found from bangkok testing (#927) and eliminate potential water balance error

Bugs fixed (include bugzilla ID): 927

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  920 (glacier_mec problems in mksurfdata)
                                  926 (pftdyn code needs to be shared in mksurfdata)
                                  934 (pftdyn logic bug)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: myself, Erik Kluzek, Sean Swenson

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/biogeophys/SurfaceAlbedoMod.F90 .... Change loop over all columns to filter_nourbanc
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 .... Change some net_solar fields from intent(out) to intent(inout).
              add soilalpha_u restriction on soil evaporation/transpiration selection for pervious road (this second
              change is bit for bit for all bluefire/bangkok testing, but will prevent small water balance errors in
              special situations (e.g., perpetual January simulations)

Summary of testing:

  bluefire: All PASS except:
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
069 smJ61 TSM.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 96 cold ...........FAIL! rc= 10
070 erJ61 TER.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 10+38 cold ........FAIL! rc= 5
071 brJ61 TBR.sh 4p_casasc_dh clm_urb^nl_urb_br 19981230:NONE:1800 1.9x2.5 gx1v6 72+72 cold .....FAIL! rc= 5
072 blJ61 TBL.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 48 cold ...........FAIL! rc= 4
082 bl744 TBLtools.sh mksurfdata tools__s namelist ..............................................FAIL! rc= 7
084 bl774 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 6
086 bl754 TBLtools.sh mksurfdata tools__s globalirrig ...........................................FAIL! rc= 6
088 bl756 TBLtools.sh mksurfdata tools__s pftdyn ................................................FAIL! rc= 7
093 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
094 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
095 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 4
096 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 4
097 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 4
  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95: All PASS except:
008 blA92 TBL.sh _sc_dm clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ...................FAIL! rc= 5
011 blD91 TBL.sh _persc_dh clm_per^nl_urb 19981231:NONE:1200 4x5 gx3v5 144 cold .................FAIL! rc= 5
033 blH52 TBL.sh 17p_cnnsc_dm clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS@2000 48 cold .........FAIL! rc= 5
034 smJ92 TSM.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 96 cold ...............FAIL! rc= 10
035 erJ92 TER.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 10+38 cold ............FAIL! rc= 5
036 brJ92 TBR.sh 4p_casasc_dm clm_urb^nl_urb_br 19981230:NONE:1800 4x5 gx3v5 72+72 cold .........FAIL! rc= 5
037 blJ92 TBL.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 48 cold ...............FAIL! rc= 4
041 blL51 TBL.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 48 arb_ic ..................FAIL! rc= 5
048 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
049 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
052 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dh ext_ccsm_seq_cam 48 .......................FAIL! rc= 8
053 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_33

Changes answers relative to baseline: No, bit for bit

===============================================================
===============================================================
Tag name:  clm3_6_33
Originator(s):  erik (erik)
Date: Thu Apr 16 14:45:23 MDT 2009
One-line Summary: Bring in dynpft changes from cbgc branch

Purpose of changes: New method for dealing with dynamic land-use changes

   morph routine casa() in casa_ecosystemDyn(), so casa is more similar to CN & DGVM,
   and prepares casa code for adding additional carbon flux functionality.
   Larger plan is to duplicate these and other mods from casafire branch on this branch.
   Add new method for conserving heat & water wrt dynamic land use.
   Conserves heat & water for any change in the land-unit, column, or pft arrangment. 
   when pftdyn is activated, "normalize" sum of new pft weights in a column
   to be the same as the sum of the old pft weights
   otherwise BalanceCheck will generate water/heat balance errors.

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  920 (glacier_mec problems in mksurfdata)
                                  926 (pftdyn code needs to be shared in mksurfdata)
                                  927 (problem with urban on bangkok/lahey)
                                  934 (pftdyn logic bug)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by:
  B. Kauffman, D. Lawrence, G. Bonan, K. Oleson

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated:

  D    biogeochem/CASASummary.F90 ................ code relocated inside CASAMod.F90

List all files added and what they do:

  A    main/dynlandMod.F90 ............... new routine is here

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>>> models/lnd/clm/src
  M    biogeochem/CASAMod.F90 .......... Add in CASASummary.F90, add casa_recosystemDyn subroutine
  M    main/pftdynMod.F90 .............. when pftdyn is active, "normalize" pft weights in a column
  M    biogeophys/BalanceCheckMod.F90 .. improved imbalance write statement
  M    main/driver.F90 ................. CASAsummary, CASAPhenology now called in 
                                         casa_ecocsystemDyn()
  M    main/initSurfAlbMod.F90 ......... casa() renamed casa_ecocsystemDyn()
  M    main/driver.F90         ......... call new routine here
  M    main/clmtype.F90        ......... define new fields
  M    main/clmtypeInitMod.F90 ......... init   new fields
  M    main/histFldsMod.F90    ......... put new fields on hist file
  M    main/clm_atmlnd.F90     ......... heat  imbalance is applied here 
                                         (to latent heat flux)
  M    riverroute/RtmMod.F90   ......... water imbalance is applied here (to runoff)

Summary of testing:

  bluefire: All PASS except pftdyn TBL tests and ...
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
069 smJ61 TSM.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 96 cold ...........FAIL! rc= 10
070 erJ61 TER.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 10+38 cold ........FAIL! rc= 5
071 brJ61 TBR.sh 4p_casasc_dh clm_urb^nl_urb_br 19981230:NONE:1800 1.9x2.5 gx1v6 72+72 cold .....FAIL! rc= 5
093 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
094 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
095 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 4
096 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 4
097 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 4
  jaguar: All PASS except
005 smA91 TSM.sh _sc_dh clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ...................FAIL! rc= 10
006 erA91 TER.sh _sc_dh clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic ................FAIL! rc= 5
007 brA91 TBR.sh _sc_dh clm_urb^nl_urb_br 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .............FAIL! rc= 5
009 smE92 TSM.sh 4p_vodsrsc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 96 arb_ic ............FAIL! rc= 10
010 erE92 TER.sh 4p_vodsrsc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 10+38 arb_ic .........FAIL! rc= 5
011 brE92 TBR.sh 4p_vodsrsc_dm clm_urb^nl_urb_br 19981230:NONE:1800 4x5 gx3v5 72+72 arb_ic ......FAIL! rc= 5
013 smEH2 TSM.sh 4p_vodsrsc_dm clm_urb^nl_urb 19981231:NONE:3600 1.9x2.5^0.9x1.25 gx1v6 48 arb_ic FAIL! rc= 10
014 erEH2 TER.sh 4p_vodsrsc_dm clm_urb^nl_urb 19981231:NONE:3600 1.9x2.5^0.9x1.25 gx1v6 10+38 arb_icFAIL! rc= 5
015 brEH2 TBR.sh 4p_vodsrsc_dm clm_urb^nl_urb_br 19981231:NONE:3600 1.9x2.5^0.9x1.25 gx1v6 24+24 arbFAIL! rc= 5
021 smH92 TSM.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 96 cold .............FAIL! rc= 10
022 erH92 TER.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 10+38 cold ..........FAIL! rc= 5
023 brH92 TBR.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 72+72 cold ..........FAIL! rc= 5
025 smJ62 TSM.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 96 cold ...........FAIL! rc= 10
026 erJ62 TER.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 10+38 cold ........FAIL! rc= 5
027 brJ62 TBR.sh 4p_casasc_dm clm_urb^nl_urb_br 19981230:NONE:1800 1.9x2.5 gx1v6 72+72 cold .....FAIL! rc= 5
034 smLI2 TSM.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
035 erLI2 TER.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
036 brLI2 TBR.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
038 erP65 TSM_ccsmseq.sh ERS f19_g15 I ..........................................................FAIL! rc= 4
039 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 4
  lightning/pathscale: All PASS except pftdyn TBL tests and ...
011 erA91 TER.sh _sc_dh clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic ................FAIL! rc= 7
012 brA91 TBR.sh _sc_dh clm_urb^nl_urb_br 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .............FAIL! rc= 5
018 smG42 TSM.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
019 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
020 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
022 smG46 TSM.sh 17p_sc_m clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
023 smJ42 TSM.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 10x15 USGS 96 cold ..............FAIL! rc= 10
024 erJ42 TER.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 10x15 USGS 10+38 cold ...........FAIL! rc= 5
025 brJ42 TBR.sh 4p_casasc_dm clm_urb^nl_urb_br 19981230:NONE:1800 10x15 USGS 72+72 cold ........FAIL! rc= 5
027 smL51 TSM.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 96 arb_ic ..................FAIL! rc= 10
028 erL51 TER.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 5
029 brL51 TBR.sh _sc_dh clm_urb^nl_urb_br 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ............FAIL! rc= 5
036 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
037 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
038 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 4
  bangkok/lf95: All PASS except pftdyn TBL tests and ...
005 smA92 TSM.sh _sc_dm clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ...................FAIL! rc= 10
006 erA92 TER.sh _sc_dm clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic ................FAIL! rc= 5
007 brA92 TBR.sh _sc_dm clm_urb^nl_urb_br 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .............FAIL! rc= 5
009 smD91 TSM.sh _persc_dh clm_per^nl_urb 19981231:NONE:1200 4x5 gx3v5 144 cold .................FAIL! rc= 10
010 erD91 TER.sh _persc_dh clm_per^nl_urb 19981231:NONE:1200 4x5 gx3v5 72+72 cold ...............FAIL! rc= 5
030 smH52 TSM.sh 17p_cnnsc_dm clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS@2000 96 cold .........FAIL! rc= 10
031 erH52 TER.sh 17p_cnnsc_dm clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS@2000 10+38 cold ......FAIL! rc= 5
032 brH52 TBR.sh 17p_cnnsc_dm clm_urb^nl_urb_br 19980115:NONE:1800 10x15 USGS@2000 72+72 cold ...FAIL! rc= 5
034 smJ92 TSM.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 96 cold ...............FAIL! rc= 10
035 erJ92 TER.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 10+38 cold ............FAIL! rc= 5
036 brJ92 TBR.sh 4p_casasc_dm clm_urb^nl_urb_br 19981230:NONE:1800 4x5 gx3v5 72+72 cold .........FAIL! rc= 5
038 smL51 TSM.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 96 arb_ic ..................FAIL! rc= 10
039 erL51 TER.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 5
040 brL51 TBR.sh _sc_dh clm_urb^nl_urb_br 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ............FAIL! rc= 5
048 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
049 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
052 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dh ext_ccsm_seq_cam 48 .......................FAIL! rc= 8
053 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  breeze/gale/hail/gust/ifort: All PASS

CLM tag used for the baseline comparison tests if applicable: clm3_6_33

Changes answers relative to baseline: Only for pftdyn mode

===============================================================
================================================================================
Tag name:  clm3_6_32
Originator(s):  dlawren, erik, jet
Date: Fri Apr 10 14:38:52 MDT 2009
One-line Summary: Add irrigation area to mksrfdata, fix high-res and pftdyn problems

Purpose of changes:  Add irrigation area to mksrfdat tool, for irrigated area copy PFT=15 LAI and heights
	into PFT=16, PFT=15 is unirrigated crop, PFT=16 is irrigated crop
   fix pftdyn mode for mksurfdata (erik), bug fixes to mksurfdata from John Truesdale
   script changes to make gx1v6 default.

Bugs fixed (include bugzilla ID): 919 (pftdyn mode in mksurfdata)
                                  821 (problems running mksurfdata at high-res)
                                  357 (codes replicated in tools)

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  920 (glacier_mec problems in mksurfdata)
                                  926 (pftdyn code needs to be shared in mksurfdata)
                                  927 (problem with urban on bangkok/lahey)
                                  934 (pftdyn logic bug)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: Building with PIO is on by default

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: gx1v6 for and 0.47 res
   fix 5x5_amazon surface dataset.

Describe any substantial timing or memory changes: None

Code reviewed by: self, jet, dlawren

List any svn externals directories updated (csm_share, mct, etc.): scripts, drv, datm7,
csm_share, esmf_wrf_timemgr

  scripts   to scripts4_090406
  drv       to vocemis-drydep08_drvseq3_0_13
  datm7     to datm7_090403
  csm_share to share3_090407
  timemgr   to esmf_wrf_timemgr_090402

List all files eliminated: Remove text urban input files, globalurban mksurf namelist --
as urban is default.

D      models/lnd/clm/bld/urban_input/metropolis_fluxes.txt
D      models/lnd/clm/bld/urban_input/urbanc_alpha_fluxes.txt
D      models/lnd/clm/bld/urban_input/asphaltjungle_fluxes.txt
D      models/lnd/clm/bld/urban_input/mexicocityMEX_fluxes.txt
D      models/lnd/clm/bld/urban_input/vancouverCAN_fluxes.txt
D      models/lnd/clm/tools/mksurfdata/mksurfdata.globalurban 

List all files added and what they do:

A      models/lnd/clm/tools/mksurfdata/pftdyn_simyr1850-2005.txt . List of dynamic PFT files from 1850 to 2005
A      models/lnd/clm/tools/mksurfdata/pftdyn_simyr1850.txt ...... Dynamic PFT file for 1850
A      models/lnd/clm/tools/mksurfdata/pftdyn_simyr2000.txt ...... Dynamic PFT file for 2000
A      models/lnd/clm/tools/mksurfdata/mkirrig.F90 ............... calculates irrigated area from irrigated area on input dataset
A      models/lnd/clm/tools/mksurfdata/mksurfdata.globalirrig .... namelist file pointing to irrigated area source file
A      models/lnd/clm/bld/namelist_files/namelist_defaults_datm.xml datm namelist info
A      models/lnd/clm/bld/namelist_files/namelist_defaults_drv.xml  drv namelist info

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>> Add firrig option, fix bugs, fix pftdyn mode
M      models/lnd/clm/tools/mksurfdata/mkvarctl.F90 .............. Add mksrf_firrig
M      models/lnd/clm/tools/mksurfdata/mklaiMod.F90 .............. Copy LAI in PFT=15 into PFT=16 if mksrf_irrig /= ''
                                                        use standard averaging for pftdyn
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90 ............. Add mksrf_firrig
M      models/lnd/clm/tools/mksurfdata/README
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90 .............. Add pct_irr to surface dataset if mksrf_irrig /= ''
M      models/lnd/clm/tools/mksurfdata/Srcfiles
M      models/lnd/clm/tools/mksurfdata/mkpftMod.F90 .............. Adjust PCT_PFT for non-irrigated (PFT=15) and irrigted (PFT=16) crops
M      models/lnd/clm/tools/mksurfdata/mkglcmec.F90 .............. Check for divide by zero (JT)
M      models/lnd/clm/tools/mksurfdata/mkvarctl.F90 .............. Initialize files to blank
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90 ............. Only output data needed for pftdyn files
M      models/lnd/clm/tools/mksurfdata/mkorganic.F90 ............. Allocate bug-fix (JT)
M      models/lnd/clm/tools/mksurfdata/mkurban.F90 ............... bug-fix (JT)
M      models/lnd/clm/tools/mksurfdata/areaMod.F90 ............... bug-fix (JT) 
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90 .............. add mkirrig, changes for pftdyn
M      models/lnd/clm/tools/mksurfdata/Srcfiles .................. add mkirrig.F90
M      models/lnd/clm/tools/mksurfdata/mkpftMod.F90 .............. if firrig => irrig/non-irrig crops
>>>>>>>>>>>>>>> Always create files using the transient input raw datasets
M      models/lnd/clm/tools/mksurfdata/mksurfdata.pl
M      models/lnd/clm/tools/mksurfdata/mksurfdata.namelist
M      models/lnd/clm/tools/mksurfdata/mksurfdata.regional 
M      models/lnd/clm/tools/mksurfdata/mksurfdata.singlept
M      models/lnd/clm/tools/mksurfdata/mksurfdata.namelist
>>>>>>>>>>>>>>> Add needed fields (mask, LANDMASK) to urban datasets
M      models/lnd/clm/tools/ncl_scripts/addgrid2spointurban.ncl
>>>>>>>>>>>>>>> Turn pio on, work with defaults
M      models/lnd/clm/bld/configure
M      models/lnd/clm/bld/config_files/config_definition.xml
M      models/lnd/clm/bld/run-ibm.csh
M      models/lnd/clm/bld/clm.cpl7.template
M      models/lnd/clm/bld/build-namelist
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml
>>>>>>>>>>>>>>> Add mask,PCT_URBAN and LANDMASK to urban point input files
M      models/lnd/clm/bld/urban_input/vancouverCAN_fluxes.nc ..... Add mask
M      models/lnd/clm/bld/urban_input/metropolis_fluxes.nc ....... Add mask
M      models/lnd/clm/bld/urban_input/urbanc_alpha_fluxes.nc ..... Add mask
M      models/lnd/clm/bld/urban_input/asphaltjungle_fluxes.nc .... Add mask
M      models/lnd/clm/bld/urban_input/mexicocityMEX_fluxes.nc .... Changes from Keith, add mask
>>>>>>>>>>>>>>> 
M      models/lnd/clm/test/system/tests_pretag_bluefire - add pftdyn test
M      models/lnd/clm/test/system/test_driver.sh -------- use beta14
M      models/lnd/clm/test/system/input_tests_master ---- fix TBR tests, 
M      models/lnd/clm/test/system/TCBext_ccsmseq_cam.sh - remove eshr
M      models/lnd/clm/test/system/TSM.sh ---------------- fix 
M      models/lnd/clm/test/system/tests_pretag_bangkok -- put some serial tests first
M      models/lnd/clm/test/system/CLM_runcmnd.sh -------- remove bluesky
>>>>>>>>>>>>>>> Always use T_REF2M NOT t_ref2m
M      models/lnd/clm/src/biogeophys/BiogeophysRestMod.F90

Summary of testing:

  bluefire: All PASS except
004 blA74 TBL.sh _sc_ds clm_urb^nl_urb 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ............FAIL! rc= 5
009 blA91 TBL.sh _sc_dh clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ...................FAIL! rc= 5
012 blD91 TBL.sh _persc_dh clm_per^nl_urb 19981231:NONE:1200 4x5 gx3v5 144 cold .................FAIL! rc= 7
014 blH74 TBL.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 cold ........FAIL! rc= 5
019 blE91 TBL.sh 4p_vodsrsc_dh clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 48 arb_ic ............FAIL! rc= 5
024 blF92 TBL.sh 17p_vodsrsc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 48 cold .............FAIL! rc= 5
028 blF93 TBL.sh 17p_vodsrsc_do clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 48 cold .............FAIL! rc= 5
032 blEH1 TBL.sh 4p_vodsrsc_dh clm_urb^nl_urb 19981231:NONE:3600 1.9x2.5^0.9x1.25 gx1v6 48 arb_ic FAIL! rc= 5
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 7
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 7
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 7
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v6 48 cold .................FAIL! rc= 7
055 blH51 TBL.sh 17p_cnnsc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS@2000 48 cold .........FAIL! rc= 5
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
062 blL78 TBL.sh _sc_s clm_urb^nl_urb 19971231:NONE:1800 1x1_brazil navy -10 arb_ic .............FAIL! rc= 5
065 smL83 TSM.sh _sc_do clm_urb^nl_urb 19980115:NONE:3600 5x5_amazon navy -10 arb_ic ............FAIL! rc= 10
066 erL83 TER.sh _sc_do clm_urb^nl_urb 19980115:NONE:3600 5x5_amazon navy -5+-5 arb_ic ..........FAIL! rc= 5
067 brL83 TBR.sh _sc_do clm_urb^nl_urb_br 19980115:NONE:3600 5x5_amazon navy -10+-10 arb_ic .....FAIL! rc= 5
068 blL83 TBL.sh _sc_do clm_urb^nl_urb 19980115:NONE:3600 5x5_amazon navy -10 arb_ic ............FAIL! rc= 4
069 smJ61 TSM.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 96 cold ...........FAIL! rc= 10
070 erJ61 TER.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 10+38 cold ........FAIL! rc= 5
071 brJ61 TBR.sh 4p_casasc_dh clm_urb^nl_urb_br 19981230:NONE:1800 1.9x2.5 gx1v6 72+72 cold .....FAIL! rc= 5
072 blJ61 TBL.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 48 cold ...........FAIL! rc= 4
073 smJ05 TSM.sh 4p_casasc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v6 48 arb_ic .....FAIL! rc= 10
077 blJ74 TBL.sh 4p_casasc_ds clm_urb^nl_urb 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic ..FAIL! rc= 5
084 bl774 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 6
086 bl754 TBLtools.sh mksurfdata tools__s globalirrig ...........................................FAIL! rc= 6
088 bl756 TBLtools.sh mksurfdata tools__s pftdyn ................................................FAIL! rc= 7
093 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
094 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
095 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 4
096 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 4
097 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 4
    jaguar: ALL FAIL except
029 smJ05 TSM.sh 4p_casasc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v6 48 arb_ic .....PASS
    breeze/pathscale: All PASS
    bangkok/lahey: All PASS except
005 smA92 TSM.sh _sc_dm clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ...................FAIL! rc= 10
006 erA92 TER.sh _sc_dm clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic ................FAIL! rc= 5
007 brA92 TBR.sh _sc_dm clm_urb^nl_urb_br 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .............FAIL! rc= 5
009 smD91 TSM.sh _persc_dh clm_per^nl_urb 19981231:NONE:1200 4x5 gx3v5 144 cold .................FAIL! rc= 10
010 erD91 TER.sh _persc_dh clm_per^nl_urb 19981231:NONE:1200 4x5 gx3v5 72+72 cold ...............FAIL! rc= 5
014 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 7
030 smH52 TSM.sh 17p_cnnsc_dm clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS@2000 96 cold .........FAIL! rc= 10
031 erH52 TER.sh 17p_cnnsc_dm clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS@2000 10+38 cold ......FAIL! rc= 5
032 brH52 TBR.sh 17p_cnnsc_dm clm_urb^nl_urb_br 19980115:NONE:1800 10x15 USGS@2000 72+72 cold ...FAIL! rc= 5
034 smJ92 TSM.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 96 cold ...............FAIL! rc= 10
035 erJ92 TER.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 10+38 cold ............FAIL! rc= 5
036 brJ92 TBR.sh 4p_casasc_dm clm_urb^nl_urb_br 19981230:NONE:1800 4x5 gx3v5 72+72 cold .........FAIL! rc= 5
038 smL51 TSM.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 96 arb_ic ..................FAIL! rc= 10
039 erL51 TER.sh _sc_dh clm_urb^nl_urb 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 5
040 brL51 TBR.sh _sc_dh clm_urb^nl_urb_br 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ............FAIL! rc= 5
052 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dh ext_ccsm_seq_cam 48 .......................FAIL! rc= 8
053 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4

CLM tag used for the baseline comparison tests if applicable: clm3_6_30

Changes answers relative to baseline: No bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_31
Originator(s):  erik (erik)
Date: Wed Apr  1 00:58:15 MDT 2009
One-line Summary: New surface datasets for 1850,2000, support for 0.9x1.25_gx1v6, urban always on. New pft-physiology file. Update scripts so remove some CLM_ env_conf vars. Fix CN for urban/pftdyn.

Purpose of changes:

New surface datasets for 1850,2000. sim_year can be 1850 or 2000
(1870 no longer supported), support for 0.9x1.25_gx1v6. Demand furbinp (urban always on),
wasteheat='ON_WASTEHEAT' by default. Change cpl7 template so can either do a cold start
or require a finidat file (cold or startup). New pft-physiology file for CN used by 
everything. Update scripts so remove some CLM_ env_conf vars: CLM_BGC, CLM_DYNNDEP, 
CLM_DYNPFT, CLM_CO2_TYPE, remove CLMNCEP from scripts/datm (keeping CLM_QIAN mode). 
Change final CN loop to go over soil filter -- so CN,CASA,DGVM can work with urban. 
Remove traffic_flux array as it's subscript was out of bounds on breeze.  lnd_comp_mct
changed so that check for spval allows for rounding of spval.

Bugs fixed (include bugzilla ID): 904 (I cases start in 2003 rather than 1948)
                                  897 (string comparision in scripts)
                                  357 (remove duplicated files in tools)

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  919 (problems in mksurfdata for pftdyn mode)
                                  920 (glacier_mec problems in mksurfdata)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: Add -pio option to configure 
   Will set the BUILDPIO CPP token as well as adding pio source to Filepath.

Describe any changes made to the namelist: Add pio_inparm namelist when -pio 
   was set in configure

List any changes to the defaults for the boundary datasets:
   New 1850 and 2000 surface datasets with urban enabled for most resolutions
   Also new 1850 and 2000 finidat files for 1.9x2.5 resolution (other finidat files removed)

Describe any substantial timing or memory changes: None

Code reviewed by: Peter Thornton, Keith Oleson, Forrest Hoffman

List any svn externals directories updated (csm_share, mct, etc.): scripts, datm, csm_share, mct, pio

   scripts4_090325
   datm7_090325
   vocemis-drydep11_share3_090112
   CT2_6_0_090308
  pio28_prod

List all files eliminated:

>>>>>>>>>>>>>> Remove DGVM namelist tests.
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_h
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_m
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_o
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_s
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_dh
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_dm
D      models/lnd/clm/test/system/config_files/10p_dgvmsc_do

>>>>>>>>>>>>>> Remove script that creates ASCII global data for urban.
D      models/lnd/clm/tools/ncl_scripts/generate_ascii_avg_urbanparam_file_p7.ncl

>>>>>>>>>>>>>> Remove modules replicated in mkgriddata by mksurfdata modules
>>>>>>>>>>>>>> use the versions in mksurfdata.
D      models/lnd/clm/tools/mkgriddata/ncdio.F90
D      models/lnd/clm/tools/mkgriddata/domainMod.F90
D      models/lnd/clm/tools/mkgriddata/areaMod.F90

List all files added and what they do:

>>>>>>>>>>>>>> Add point datasets that now have urban information in them.
A      models/lnd/clm/bld/urban_input/surfdata_1x1_tropicAtl_urb3den_simyr2000_c090320.nc
A      models/lnd/clm/bld/urban_input/surfdata_1x1_brazil_urb3den_simyr2000_c090320.nc
A      models/lnd/clm/bld/urban_input/surfdata_1x1_brazil_urb3den_simyr1850_c090317.nc

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>> Make most tests with urban, remove dgvm tests
M      models/lnd/clm/test/system/tests_pretag_bluefire
M      models/lnd/clm/test/system/config_files/README
M      models/lnd/clm/test/system/tests_pretag_jaguar
M      models/lnd/clm/test/system/tests_pretag_bangkok
M      models/lnd/clm/test/system/test_driver.sh
M      models/lnd/clm/test/system/tests_posttag_hybrid_regression
M      models/lnd/clm/test/system/tests_posttag_purempi_regression
M      models/lnd/clm/test/system/nl_files/clm_per
M      models/lnd/clm/test/system/nl_files/clm_per0
M      models/lnd/clm/test/system/input_tests_master
M      models/lnd/clm/test/system/tests_posttag_lightning

>>>>>>>>>>>>>> Add all_urban mode for single-point mode
M      models/lnd/clm/tools/mksurfdata/mkvarctl.F90
M      models/lnd/clm/tools/mksurfdata/ncdio.F90
M      models/lnd/clm/tools/mksurfdata/mkglacier.F90
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90
M      models/lnd/clm/tools/mksurfdata/mklanwat.F90
M      models/lnd/clm/tools/mksurfdata/mkurban.F90
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90
M      models/lnd/clm/tools/mksurfdata/mksurfdata.pl
M      models/lnd/clm/tools/mksurfdata/mkpftMod.F90

>>>>>>>>>>>>>> Add pio option to configure, and if set add pio_inparm namelist
>>>>>>>>>>>>>> Datasets to 1850/2000 and most with urban.
M      models/lnd/clm/bld/configure ------------- Add pio option
M      models/lnd/clm/bld/config_files/config_definition.xml - Add pio to config_cache.xml
M      models/lnd/clm/bld/clm.cpl7.template ----- require furbinp, remove CLM_ env vars
M      models/lnd/clm/bld/build-namelist -------- make sure sim_year sent in, change
                                                  some names etc.
M      models/lnd/clm/bld/namelist_files/namelist_definition.xml ---- Add pio_inparm
M      models/lnd/clm/bld/namelist_files/datm.streams.template.xml -- Remove CLM_NCEP
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml -- urban datasets
              for most resolutions, datasets for 1850 and 2000, remove most finidat

>>>>>>>>>>>>>> Add data from grid files as well as LANDMASK and PCT_URBAN.
M      models/lnd/clm/bld/urban_input/asphaltjungle_fluxes.nc
M      models/lnd/clm/bld/urban_input/metropolis_fluxes.nc
M      models/lnd/clm/bld/urban_input/mexicocityMEX_fluxes.nc
M      models/lnd/clm/bld/urban_input/urbanc_alpha_fluxes.nc
M      models/lnd/clm/bld/urban_input/vancouverCAN_fluxes.nc

>>>>>>>>>>>>>> Changes from Forrest H./Peter T. to fix some CN problems (single-point, pftdyn)
M      models/lnd/clm/src/biogeochem/CNSetValueMod.F90
M      models/lnd/clm/src/main/driver.F90
M      models/lnd/clm/src/main/pftdynMod.F90
M      models/lnd/clm/src/main/lnd_comp_mct.F90 --------- Change from Mark Flanner
                                                          to fix roundoff issues for aerosols.
M      models/lnd/clm/src/biogeophys/Hydrology2Mod.F90
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 ------- Remove traffic_flux as subscript 
                                                          bounds was being exceeded on breeze.

Summary of testing:

  bluefire: All PASS except TBL and...
023 brF92 TBR.sh 17p_vodsrsc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 72+72 cold ..........FAIL! rc= 13
027 brF93 TBR.sh 17p_vodsrsc_do clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 72+72 cold ..........FAIL! rc= 13
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
065 smL83 TSM.sh _sc_do clm_urb^nl_urb 19980115:NONE:3600 5x5_amazon navy -10 arb_ic ............FAIL! rc= 10
066 erL83 TER.sh _sc_do clm_urb^nl_urb 19980115:NONE:3600 5x5_amazon navy -5+-5 arb_ic ..........FAIL! rc= 5
067 brL83 TBR.sh _sc_do clm_urb^nl_urb_br 19980115:NONE:3600 5x5_amazon navy -10+-10 arb_ic .....FAIL! rc= 5
069 smJ61 TSM.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 96 cold ...........FAIL! rc= 10
070 erJ61 TER.sh 4p_casasc_dh clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 10+38 cold ........FAIL! rc= 5
071 brJ61 TBR.sh 4p_casasc_dh clm_urb^nl_urb_br 19981230:NONE:1800 1.9x2.5 gx1v6 72+72 cold .....FAIL! rc= 5
076 brJ74 TBR.sh 4p_casasc_ds clm_urb^nl_urb 10001230:NONE:3600 1x1_tropicAtl test -3+-3 arb_ic .FAIL! rc= 13
  jaguar: All PASS except TBL and...
005 smA91 TSM.sh _sc_dh clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ...................FAIL! rc= 10
006 erA91 TER.sh _sc_dh clm_urb^nl_urb 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic ................FAIL! rc= 5
007 brA91 TBR.sh _sc_dh clm_urb^nl_urb_br 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .............FAIL! rc= 5
009 smE92 TSM.sh 4p_vodsrsc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 96 arb_ic ............FAIL! rc= 10
010 erE92 TER.sh 4p_vodsrsc_dm clm_urb^nl_urb 19981230:NONE:1800 4x5 gx3v5 10+38 arb_ic .........FAIL! rc= 5
011 brE92 TBR.sh 4p_vodsrsc_dm clm_urb^nl_urb_br 19981230:NONE:1800 4x5 gx3v5 72+72 arb_ic ......FAIL! rc= 5
017 smG43 TSM.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
018 erG43 TER.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 10+38 arb_ic ................FAIL! rc= 5
019 brG43 TBR.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
025 smJ62 TSM.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 96 cold ...........FAIL! rc= 10
026 erJ62 TER.sh 4p_casasc_dm clm_urb^nl_urb 19981230:NONE:1800 1.9x2.5 gx1v6 10+38 cold ........FAIL! rc= 5
027 brJ62 TBR.sh 4p_casasc_dm clm_urb^nl_urb_br 19981230:NONE:1800 1.9x2.5 gx1v6 72+72 cold .....FAIL! rc= 5
029 smJ05 TSM.sh 4p_casasc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5 48 startup ....FAIL! rc= 10
030 smJ74 TSM.sh 4p_casasc_ds clm_urb^nl_urb 10001230:NONE:3600 1x1_tropicAtl test -1100 arb_ic .FAIL! rc= 10
031 erJ74 TER.sh 4p_casasc_ds clm_urb^nl_urb 10001230:NONE:3600 1x1_tropicAtl test -10+-10 arb_ic FAIL! rc= 5
032 brJ74 TBR.sh 4p_casasc_ds clm_urb^nl_urb 10001230:NONE:3600 1x1_tropicAtl test -3+-3 arb_ic .FAIL! rc= 5
034 smLI2 TSM.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
035 erLI2 TER.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
036 brLI2 TBR.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
039 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 7
  bangkok/lf95: All PASS except TBL
  breeze/gale/hail/gust/ifort: All PASS

TBL tests are different since most tests are now with urban.

Most of the fails are due to missing files.

CLM tag used for the baseline comparison tests if applicable: clm3_6_30

Changes answers relative to baseline: Yes for CN -- new pft-physiology file

===============================================================
===============================================================
Tag name:  clm3_6_30
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Thu Mar 19 20:44:33 MDT 2009
One-line Summary: Fix urban roof/wall layers

Purpose of changes: Fix urban roof/wall layers

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Me

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/main/iniTimeConst.F90 ---- divide roof/wall thickness by nlevurb instead of nlevsoi

Summary of testing:

  bluefire: All urban testing passed except TBL
  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_29

Changes answers relative to baseline: Urban only

===============================================================
===============================================================
Tag name:  clm3_6_29
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Thu Mar 19 07:16:05 MDT 2009
One-line Summary: CN SAI, CN testing fix, rad step size fix

Purpose of changes:  Add SAI decay for CN mode.
                     Fix CN for tests SmI58, smH51, erH51, brH51
                     Add new get_rad_step_size function used by SAI decay function.  This is the "simple fix"
                     and yields correct radiation time step size for all time steps except one for the I and F
                     cases.  The "complete fix" involves changes to other component models and will be available soon.

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: K. Oleson, G. Bonan, F. Hoffman, M. Vertenstein, J. Truesdale

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/biogeochem/CNrestMod.F90 --- add seven CN fields deleted previously for restart
M      models/lnd/clm/src/biogeochem/CNVegStructUpdateMod.F90 ---- add SAI decay function (calls get_rad_step_size)
M      models/lnd/clm/src/main/clm_time_manager.F90 ---- changes to fix get_rad_step_size function
M      models/lnd/clm/src/main/lnd_comp_mct.F90 ---- changes to fix get_rad_step_size function

Summary of testing:

  bluefire: All PASS except:
013 smH74 TSM.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -1100 cold .......FAIL! rc= 10
014 blH74 TBL.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 cold ........FAIL! rc= 4
020 smE95 TSM.sh 4p_vodsrsc_h clm_std 19981231:NONE:1800 4x5 gx3v5 48 arb_ic ....................FAIL! rc= 10
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
055 blH51 TBL.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@2000 48 cold ................FAIL! rc= 7
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

smH74 and blH74 failures are being investigated.
blH51 fails because it fails in clm3_6_28 (fixed in this commit).
Other failures are known.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_28

Changes answers relative to baseline:  CN mode only due to SAI decay factor

===============================================================
===============================================================
Tag name:  clm3_6_28
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Tue Mar 17 07:03:12 MDT 2009
One-line Summary: Fix permission denied error when reading surface dataset

Purpose of changes: Change nf_open statement in UrbanInputMod.F90

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Erik K.

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/biogeophys/UrbanInputMod.F90 ---- don't use getavu for nf_open

Summary of testing:

  bluefire: All PASS except for:
013 smH74 TSM.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -1100 cold .......FAIL! rc= 10
014 blH74 TBL.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 cold ........FAIL! rc= 4
020 smE95 TSM.sh 4p_vodsrsc_h clm_std 19981231:NONE:1800 4x5 gx3v5 48 arb_ic ....................FAIL! rc= 10
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 5
053 erH51 TER.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@2000 10+38 cold .............FAIL! rc= 7
054 brH51 TBR.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@2000 72+72 cold .............FAIL! rc= 6
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

sm74, blH74, smI58 are known failures related to CN and are being investigated.
blC61 fails because clm3_6_27 fails (fixed in this tag).
Other failures are known.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_27

Changes answers relative to baseline: bfb

===============================================================
===============================================================
Tag name:  clm3_6_27
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date: Mon Mar 16 10:52:05 MDT 2009
One-line Summary: Urban model changes and FGR12 fix

Purpose of changes:  Fix large urban saturation excess runoff.
                     Limit urban dew formation.
                     Change FGR12 diagnostic.

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference)
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: Not tested

Code reviewed by: K. Oleson

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/biogeophys/SoilTemperatureMod.F90 ---- change eflx_fgr12 diagnostic
M      models/lnd/clm/src/biogeophys/Biogeophysics1Mod.F90 ---- limit urban dew formation and calculate
              pervious road qred over nlevsoi, not nlevurb
M      models/lnd/clm/src/biogeophys/SoilHydrologyMod.F90 ---- prevent large saturation excess due to 
              ponded ice

Summary of testing:

  bluefire: All PASS tests_pretag_bluefire except TBL and :
013 smH74 TSM.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -1100 cold .......FAIL! rc= 10
020 smE95 TSM.sh 4p_vodsrsc_h clm_std 19981231:NONE:1800 4x5 gx3v5 48 arb_ic ....................FAIL! rc= 10
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
048 smC61 TSM.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 -6 cold .................FAIL! rc= 10
049 erC61 TER.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 10+38 cold ..............FAIL! rc= 5
050 brC61 TBR.sh _sc_dh clm_urb^nl_urb_br 19981001:NONE:1800 1.9x2.5 gx1v5 -3+-3 cold ...........FAIL! rc= 5
053 erH51 TER.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@2000 10+38 cold .............FAIL! rc= 7
054 brH51 TBR.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@2000 72+72 cold .............FAIL! rc= 6
056 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc=5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

smH74 and smI58 are CN-related tests that did not fail in clm3_6_25, but fail in clm3_6_26 and in this tag and 
thus should be investigated further.
smC61, erC61, brC61 fail because of permission denied when reading surface dataset. This appears to be a test
suite problem only.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_26

Changes answers relative to baseline: Urban answers change because of runoff fix.
                                      Standard mode answers only change in FGR12 diagnostic.

===============================================================
===============================================================
Tag name: clm3_6_26
Originator(s): Peter Thornton
Date: 3/14/09
One-line Summary: CN time step and restart file changes

Purpose of changes: shorten CN restart file. Requires moving CLM to physical model timestep.

Bugs fixed (include bugzilla ID):

Known bugs (include bugzilla ID):
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: nonee

Describe any substantial timing or memory changes: CLM restart file reduced in size by ~factor of 3.

Code reviewed by: Forrest Hoffman

List any svn externals directories updated (csm_share, mct, etc.): none

List all files eliminated: none

List all files added and what they do:


List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/biogeochem/CNCStateUpdate2Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate2Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNNStateUpdate1Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNBalanceCheckMod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNNStateUpdate3Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNFireMod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNMRespMod.F90 - change q10
M      models/lnd/clm/src/biogeochem/CNPhenologyMod.F90 - remove reference to retransn
M      models/lnd/clm/src/biogeochem/CNCStateUpdate1Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNDecompMod.F90 - change q10
M      models/lnd/clm/src/biogeochem/CNCStateUpdate3Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate1Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNrestMod.F90 - eliminate many CN variables
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate3Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNAnnualUpdateMod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNNStateUpdate2Mod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNNDynamicsMod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNAllocationMod.F90 - change time step, and cleanup some variable names
M      models/lnd/clm/src/biogeochem/CNEcosystemDynMod.F90 - change time step
M      models/lnd/clm/src/biogeochem/CNSetValueMod.F90 - cleanup variable names
M      models/lnd/clm/src/biogeochem/CNVegStructUpdateMod.F90 - change time step
M      models/lnd/clm/src/main/CNiniTimeVar.F90 - cleanup variable names
M      models/lnd/clm/src/main/driver.F90 - change time step
M      models/lnd/clm/src/main/clmtypeInitMod.F90 - cleanup variable names
M      models/lnd/clm/src/main/pftdynMod.F90 - change time step
M      models/lnd/clm/src/main/clm_time_manager.F90 - change time step
M      models/lnd/clm/src/main/clmtype.F90 - cleanup variable names
M      models/lnd/clm/src/main/histFldsMod.F90 - cleanup variable names

Summary of testing:

  bluefire:
  jaguar:
 Ran the CLM test suite, with the following results:
smA74 TSM.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................PASS
erA74 TER.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -5+-5 arb_ic .................PASS
brA74 TBR.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -5+-5 arb_ic .................PASS
blA74 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................SKIPPED*
smA91 TSM.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ..........................PASS
erA91 TER.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 7 (passes with 512 tasks)
brA91 TBR.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 6 (passes with 512 tasks)
blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ..........................SKIPPED*
smE92 TSM.sh 4p_vodsrsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 96 arb_ic ...................PASS
erE92 TER.sh 4p_vodsrsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 10+38 arb_ic ................PASS
brE92 TBR.sh 4p_vodsrsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 72+72 arb_ic ................PASS
blE92 TBL.sh 4p_vodsrsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 48 arb_ic ...................SKIPPED*
smEH2 TSM.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 48 arb_ic .......PASS
erEH2 TER.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 10+38 arb_ic ....PASS
brEH2 TBR.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 24+24 arb_ic ....PASS
blEH2 TBL.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 48 arb_ic .......SKIPPED*
smG43 TSM.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
erG43 TER.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 10+38 arb_ic ................FAIL! rc= 5
brG43 TBR.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
blG43 TBL.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................SKIPPED*
smH92 TSM.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 96 cold .............PASS
erH92 TER.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 10+38 cold ..........PASS
brH92 TBR.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 72+72 cold ..........PASS
blH92 TBL.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@2000 48 cold .............SKIPPED*
smJ62 TSM.sh 4p_casasc_dm clm_std 19981230:NONE:1800 1.9x2.5 gx1v5 96 startup ...............PASS
erJ62 TER.sh 4p_casasc_dm clm_std 19981230:NONE:1800 1.9x2.5 gx1v5 10+38 startup ............PASS
brJ62 TBR.sh 4p_casasc_dm clm_std 19981230:NONE:1800 1.9x2.5 gx1v5 72+72 startup ............PASS
blJ62 TBL.sh 4p_casasc_dm clm_std 19981230:NONE:1800 1.9x2.5 gx1v5 48 startup ...............SKIPPED* 
smJ05 TSM.sh 4p_casasc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5 48 startup ....FAIL! rc= 10
smJ74 TSM.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -1100 arb_ic ........PASS
erJ74 TER.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -10+-10 arb_ic ......PASS
brJ74 TBR.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -3+-3 arb_ic ........PASS
blJ74 TBL.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic .........SKIPPED*
smK92 TSM.sh 10p_dgvmsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 96 arb_ic ...................PASS
erK92 TER.sh 10p_dgvmsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 10+38 arb_ic ................PASS
brK92 TBR.sh 10p_dgvmsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 72+72 arb_ic ................PASS
blK92 TBL.sh 10p_dgvmsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 48 arb_ic ...................SKIPPED*
smLI2 TSM.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
erLI2 TER.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
brLI2 TBR.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
blLI2 TBL.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................SKIPPED*
erP65 TSM_ccsmseq.sh ERS f19_g15 I ..........................................................PASS
erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................PASS  kraken:

Note: the tests that FAIL here are the same that FAIL on jaguar with clm3_6_25.

  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable:

Changes answers relative to baseline:

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
    q10 changes are climate changing. Time step changes are larger than roundoff, similar climate.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
===============================================================
Tag name:  clm3_6_25
Originator(s):  dlawren (Lawrence David 1384 CGD), erik (Kluzek Erik), tcraig (Craig Tony)
Date: Fri Mar 13 15:11:01 MDT 2009
One-line Summary: Daylength control on Vcmax, 1%Lake,wetland,glacier in mksrfdat, remove ELEVATION in surface data file

Purpose of changes: Include changes from Peter Thornton to include daylength control 
on vcmax in photosynthesis scheme; Set minimum lake, wetland, and glacier area to 1% 
to be more consistent with urban and to represent more lakes and wetlands; remove 
temporary unused ELEVATION field from surface dataset

Bugs fixed (include bugzilla ID): 877 (CN restart problem)
                                  911 (high PE count problem)

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference) 
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: New global urban datasets 10x15 and 1.9x2.5 resolutions

Describe any substantial timing or memory changes: None

Code reviewed by: David Lawrence (code), Erik Kluzek (testing and build), Tony Craig (DecompInitMod.F90)

List any svn externals directories updated (csm_share, mct, etc.): scripts, mct, datm

  scripts to scripts4_090310
  datm7   to datm7_090229
  mct     to MCT2_6_0_090308

List all files eliminated: None

List all files added and what they do:

A  models/lnd/clm/test/system/config_files/tools__s ..... Optimized serial mode for tools

List all existing files that have been modified, and describe the changes:

M  models/lnd/clm/tools/mksurfdata/mkglcmec.F90 ..... correct bug in error check
M  models/lnd/clm/tools/mksurfdata/mkglacier.F90 .... reduce min glacier frac from 5 to 1%
M  models/lnd/clm/tools/mksurfdata/mkfileMod.F90 .... remove ELEVATION field
M  models/lnd/clm/tools/mksurfdata/mklanwat.F90 ..... reduce min lake,wetland frac from 5 to 1%
M  models/lnd/clm/tools/mksurfdata/mksrfdat.F90 ..... remove ELEVATION field
M  models/lnd/clm/tools/mksurfdata/README ........... add documentation about being slow unless use OPT=TRUE in gmake
M  models/lnd/clm/src/main/decompInitMod.F90 ........ Changes from Tony Craig to fix for high PE counts
M  models/lnd/clm/src/main/clm_comp.F90 ............. daylength control on vcmax changes
M  models/lnd/clm/src/main/driver.F90 ............... daylength control on vcmax changes
M  models/lnd/clm/src/main/clmtypeInitMod.F90 ....... daylength control on vcmax changes
M  models/lnd/clm/src/main/iniTimeConst.F90 ......... daylength control on vcmax changes
M  models/lnd/clm/src/main/clmtype.F90 .............. daylength control on vcmax changes
M  models/lnd/clm/src/biogeophys/CanopyFluxesMod.F90  daylength control on vcmax changes

M  models/lnd/clm/test/system/test_driver.sh ........ update to beta10, fix some issues on jaguar
M  models/lnd/clm/test/system/input_tests_master .... do most mksurfdata testing optimized
                                                      change CN tests to cold-starts, change 1890 to 1870

M  models/lnd/clm/bld/build-namelist ................ pass sim_year and maxpft in when determining default for finidat
M  models/lnd/clm/bld/clm.cpl7.template ............. add in ignore logic like cam
M  models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml . update input files

Summary of testing:

  bluefire: All PASS except TBL and...
020 smE95 TSM.sh 4p_vodsrsc_h clm_std 19981231:NONE:1800 4x5 gx3v5 48 arb_ic ....................FAIL! rc= 10
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
052 smH51 TSM.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@1890 96 cold ................FAIL! rc= 8
053 erH51 TER.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@1890 10+38 cold .............FAIL! rc= 5
054 brH51 TBR.sh 17p_cnnsc_dh clm_std 19980115:NONE:1800 10x15 USGS@1890 72+72 cold .............FAIL! rc= 5
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6
  jaguar: Limited testing...
  lightning/pathscale: All PASS except TBL and...
002 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
003 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
004 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
006 smOC4 TSM.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 10
007 erOC4 TER.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 115+115 arb_icFAIL! rc= 5
008 brOC4 TBR.sh _vansc_ds clm_urb1pt^nl_urb_br 19920812:NONE:3600 1x1_vancouverCAN navy 72+72 arb_iFAIL! rc= 5
011 erA91 TER.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 7
012 brA91 TBR.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 6
019 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 7
020 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 6
024 erJ42 TER.sh 4p_casasc_dm clm_std 19981230:NONE:1800 10x15 USGS 10+38 startup ...............FAIL! rc= 7
025 brJ42 TBR.sh 4p_casasc_dm clm_std 19981230:NONE:1800 10x15 USGS 72+72 startup ...............FAIL! rc= 6
027 smK51 TSM.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 96 arb_ic ..................FAIL! rc= 10
028 erK51 TER.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 5
029 brK51 TBR.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 72+72 arb_ic ...............FAIL! rc= 5
032 erL51 TER.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ......................FAIL! rc= 7
033 brL51 TBR.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ......................FAIL! rc= 6
040 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
041 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
042 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 5
  breeze/gale/hail/gust/ifort: All PASS except TBL

CLM tag used for the baseline comparison tests if applicable: clm3_6_24

Changes answers relative to baseline: Yes

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers:
    - what code configurations: All
    - what platforms/compilers: All
    - nature of change: similar climate

  Dave Lawrence ran a short simulation to show that answers do NOT change significantly

===============================================================
===============================================================
Tag name:  clm3_6_24
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Mon Mar  9 21:01:47 MDT 2009
One-line Summary: Fix urban testing and some history field changes

Purpose of changes:  Convert urban ascii files to netcdf to get urban testing to work.
                     Add rh_ref2m calculation for urban and change urban/rural humidity from specific to relative in
                         history files.

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 672 (3.5.4-3.5.14 diffs)
                                  698 (cprnc bug gives false difference) 
                                  701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  722 (threading slow)
                                  789 (1pt sims 2.5X slow)
                                  794 (hist avg strange)
                                  821 (mksurfdata for qtr deg)
                                  851 (abort when files non-exist on jaguar)
                                  877 (CN restart problem)
                                  883 (aerosol deposition not from atm)
                                  903 (problems in driver with open-MP on PGI)
                                  990 (illegal instruction)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: In namelist_defaults_clm.xml:
                                           Change *.txt urban files to *.nc 
                                           Change aerosoldep_monthly_1990s_mean_1x1_urbanc_alpha_c090119.nc to
                                                  aerosoldep_monthly_1990s_mean_1x1_urbanc_alpha_c090114.nc
                                           Change path for surfdata_0096x0144_090223_v2.nc from
                                                  lnd/clm2/surfdata/ to lnd/clm2/urbdata

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: Not tested

Code reviewed by: K. Oleson

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: A      models/lnd/clm/bld/urban_input/vancouverCAN_fluxes.nc
                                       A      models/lnd/clm/bld/urban_input/metropolis_fluxes.nc
                                       A      models/lnd/clm/bld/urban_input/urbanc_alpha_fluxes.nc
                                       A      models/lnd/clm/bld/urban_input/asphaltjungle_fluxes.nc
                                       A      models/lnd/clm/bld/urban_input/mexicocityMEX_fluxes.nc

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/test/system/nl_files/nl_urb ---- Remove TSNOW from hist_fincl1, remove Q2M, Q2M_R, Q2M_U and 
              add RH2M, RH2M_R, RH2M_U to hist_fincl2
M      models/lnd/clm/test/system/nl_files/nl_urb_br ---  Remove TSNOW from hist_fincl1
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml ---- Change *.txt urban files to *.nc 
              Change aerosoldep_monthly_1990s_mean_1x1_urbanc_alpha_c090119.nc to
              aerosoldep_monthly_1990s_mean_1x1_urbanc_alpha_c090114.nc
              Change path for surfdata_0096x0144_090223_v2.nc from
              lnd/clm2/surfdata/ to lnd/clm2/urbdata
M      models/lnd/clm/src/main/clmtypeInitMod.F90 ---- delete q_ref2m_r, q_ref2m_u, and add rh_ref2m_r, rh_ref2m_u
M      models/lnd/clm/src/main/clmtype.F90 ---- delete q_ref2m_r, q_ref2m_u, and add rh_ref2m_r, rh_ref2m_u
M      models/lnd/clm/src/main/histFldsMod.F90 ---- delete Q2M_U, Q2M_R, and add RH2M_U, RH2M_R
M      models/lnd/clm/src/biogeophys/UrbanInitMod.F90 ---- delete q_ref2m_u and add rh_ref2m_u
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 ---- delete q_ref2m_u and add calculation for rh_ref2m_u
M      models/lnd/clm/src/biogeophys/BareGroundFluxesMod.F90 ---- delete q_ref2m_r and add rh_ref2m_r
M      models/lnd/clm/src/biogeophys/CanopyFluxesMod.F90 ---- delete q_ref2m_r and add rh_ref2m_r

Summary of testing:

  bluefire: All PASS except:
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
037 smG45 TSM.sh 17p_sc_h clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 5
052 smH51 TSM.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..........FAIL! rc= 1
053 erH51 TER.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic .......FAIL! rc= 1
054 brH51 TBR.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic .......FAIL! rc= 1
055 blH51 TBL.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..........FAIL! rc= 1
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
090 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
091 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
092 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
093 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
094 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

Urban baseline tests fail because clm3_6_23 still used *.txt files
Other failures are known from previous tags.
mksurfdata tests not run because of bug that makes these tests run very slow.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_23

Changes answers relative to baseline: bfb

===============================================================
===============================================================
Tag name:  clm3_6_23
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Sun Mar  8 17:24:36 MDT 2009
One-line Summary: Prune history fields and change to snowdp threshold for solar radiation penetration into snow

Purpose of changes:  Eliminate history fields no longer needed and eliminate any associated code with these fields.  
                     Change snowdp threshold for solar radiation penetration into snow from 0.05 to 0.10.

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 990 (illegal instruction)
                                  883 (aerosol deposition not from atm), 877 (CN restart problem)
                                  903 (problems in driver with open-MP on PGI)
                                  672 (3.5.4-3.5.14 diffs)
                                  851 (abort when files non-exist on jaguar)
                                  821 (mksurfdata for qtr deg), 789 (1pt sims 2.5X slow)
                                  794 (hist avg strange), 722 (threading slow)
                                  701 (svn keyword), 698 (cprnc bug gives false difference)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: Not tested

Code reviewed by: dlawren, slevis, oleson

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:
M      models/lnd/clm/src/main/inicFileMod.F90 ---- Remove snowage
M      models/lnd/clm/src/main/driver.F90 ---- Remove snowage
M      models/lnd/clm/src/main/clmtypeInitMod.F90 ---- Remove snowage, t_snow, dsmpdw_l, dhkdw_l, dwat_l, qflx_in_soil,
              qflx_out_soil, qflx_tranout_soil, remove CLAMP cpps around rh_ref2m
M      models/lnd/clm/src/main/histFileMod.F90 ---- add set_urb, set_nourb, set_spec to hist_addfld2d
M      models/lnd/clm/src/main/clmtype.F90 ---- Remove snowage, t_snow, dsmpdw_l, dhkdw_l, dwat_l, qflx_in_soil,
              qflx_out_soil, qflx_tranout_soil, remove CLAMP cpps around rh_ref2m
M      models/lnd/clm/src/main/histFldsMod.F90 ---- Remove SNOWAGE, change TBUILD to active, change HCSOISNO to HC,
              remove TSNOW, remove CLAMP cpps around rh_ref2m, change BUILDHEAT, URBAN_AC, URBAN_HEAT, WASTEHEAT,
              HEAT_FROM_AC to active, remove ZBOT_PFT, change FGR long_name, remove HWR, change RSSUN and RSSHA to
              minimum quantity and make inactive, change DPVLTRB[1-4] to inactive, remove DSMPDW, DHKDW, DWAT,
              QFLX_OUT_SOIL, QFLX_IN_SOIL, QFLX_TRAN_SOIL, QFLX_RSUB_SAT, set SMP and HK to set_spec=spval and 
              inactive, change QRGWL and QRUNOFF long_name, change DVOLRDT_LND, DVOLRDT_LND_*, DVOLRDT_OCN,
              DVOLRDT_OCN_* to inactive, remove FMICR, FCO2, DMI, add set_urb=spval to numerous SNICAR fields
M      models/lnd/clm/src/main/mkarbinitMod.F90 ---- Remove snowage
M      models/lnd/clm/src/biogeophys/SurfaceRadiationMod.F90 ---- Change maximum snow depth for vertical solar 
              absorption from 0.0 5 to 0.1 to prevent unrealistic soil warming at shallow snow depths
M      models/lnd/clm/src/biogeophys/SnowHydrologyMod.F90 ----  Remove some comments
M      models/lnd/clm/src/biogeophys/SurfaceAlbedoMod.F90 ---- Removed SnowAlbedo routine, which is no longer used 
              and removed snowage variable which is also no longer used
M      models/lnd/clm/src/biogeophys/Hydrology1Mod.F90 ---- Remove snowage
M      models/lnd/clm/src/biogeophys/Hydrology2Mod.F90 ---- Remove snowage, t_snow, dsmpdw_l, dhkdw_l, dwat_l,
              qflx_in_soil, qflx_out_soil, qflx_tranout_soil
M      models/lnd/clm/src/biogeophys/BiogeophysicsLakeMod.F90 ---- Remove CLAMP cpps around rh_ref2m and 
              related variables
M      models/lnd/clm/src/biogeophys/BiogeophysRestMod.F90 ---- Remove snowage and some comments
M      models/lnd/clm/src/biogeophys/SoilHydrologyMod.F90 ---- Remove variables and calculations for 
              dsmpdw_l, dhkdw_l, dwat_l, qflx_in_soil, qflx_out_soil, qflx_tranout_soil
M      models/lnd/clm/src/biogeophys/BareGroundFluxesMod.F90 ---- Remove CLAMP cpps around rh_ref2m and
              related variables
M      models/lnd/clm/src/biogeophys/CanopyFluxesMod.F90 ----  Remove CLAMP cpps around rh_ref2m and 
              related variables

Summary of testing:

  bluefire: All PASS except:
009 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ..........................FAIL! rc= 7
012 blD91 TBL.sh _persc_dh clm_per 19981231:NONE:1200 4x5 gx3v5 144 startup .....................FAIL! rc= 7
019 blE91 TBL.sh 4p_vodsrsc_dh clm_std 19981230:NONE:1800 4x5 gx3v5 48 arb_ic ...................FAIL! rc= 7
024 blF92 TBL.sh 17p_vodsrsc_dm clm_std 19981230:NONE:1800 4x5 gx3v5 48 cold ....................FAIL! rc= 7
028 blF93 TBL.sh 17p_vodsrsc_do clm_std 19981230:NONE:1800 4x5 gx3v5 48 cold ....................FAIL! rc= 7
032 blEH1 TBL.sh 4p_vodsrsc_dh clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 48 arb_ic .......FAIL! rc= 7
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
037 smG45 TSM.sh 17p_sc_h clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
038 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
039 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
040 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 4
042 smCA8 TSM.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 10
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 4
044 smNB4 TSM.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 10
045 erNB4 TER.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 59+100 arb_icFAIL! rc= 5
046 brNB4 TBR.sh _mexsc_ds clm_urb1pt^nl_urb_br 19931201:NONE:3600 1x1_mexicocityMEX navy 72+72 arb_FAIL! rc= 5
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 4
048 smC61 TSM.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 -6 cold .................FAIL! rc= 10
049 erC61 TER.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 10+38 cold ..............FAIL! rc= 5
050 brC61 TBR.sh _sc_dh clm_urb^nl_urb_br 19981001:NONE:1800 1.9x2.5 gx1v5 -3+-3 cold ...........FAIL! rc= 5
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 4
052 smH51 TSM.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..........FAIL! rc= 1
053 erH51 TER.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic .......FAIL! rc= 1
054 brH51 TBR.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic .......FAIL! rc= 1
055 blH51 TBL.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..........FAIL! rc= 1
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
072 blJ61 TBL.sh 4p_casasc_dh clm_std 19981230:NONE:1800 1.9x2.5 gx1v5 48 startup ...............FAIL! rc= 7
081 blK91 TBL.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 4x5 gx3v5 48 arb_ic ...................FAIL! rc= 7
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
099 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

Baseline tests fail because of snowdp change in SurfaceRadiationMod.F90.
The other tests failed in clm3_6_19 as well.
Urban tests will continue to fail until testing suite is updated to reflect the fact that urban data is now
read in from netcdf files instead of ascii files.
mksurfdata tests not run because of bug that makes these tests run very slow.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_20

Changes answers relative to baseline: yes (because of snowdp change but should have small effects)

===============================================================
===============================================================
Tag name:  clm3_6_22
Originator(s): kauff
Date:
One-line Summary: replace 1870 finidat file <plus other changes TBD?>

Purpose of changes:

Describe any changes made to the namelist: None
- replace finidat file for 1870 runs (can't be same as 2000 run)
  caused 1870 runs only to fail

M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml

===============================================================
Tag name:  clm3_6_21
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Wed Mar  4 20:14:23 MST 2009
One-line Summary: History file changes and finish testing on tags clm3_6_19 and clm3_6_20

Purpose of changes: Remove set_urb=spval for turbulent deposition velocity history fields.
                    This also finishes testing not done for tags clm3_6_19 and clm3_6_20. 

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID):
Known bugs (include bugzilla ID): 883 (aerosol deposition not from atm), 877 (CN restart problem)
                                   903 (problems in driver with open-MP on PGI)
                                   672 (3.5.4-3.5.14 diffs)
                                   851 (abort when files non-exist on jaguar)
                                   821 (mksurfdata for qtr deg), 789 (1pt sims 2.5X slow)
                                  794 (hist avg strange), 722 (threading slow)
                                  701 (svn keyword), 698 (cprnc bug gives false difference)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: Not tested

Code reviewed by: K. Oleson

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/src/main/histFldsMod.F90 ---- remove set_urb=spval for turbulent velocity history fields

Summary of testing:

  bluefire: All PASS except:

033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
037 smG45 TSM.sh 17p_sc_h clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
038 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
039 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
040 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 4
042 smCA8 TSM.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 10
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 4
044 smNB4 TSM.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 10
045 erNB4 TER.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 59+100 arb_icFAIL! rc= 5
046 brNB4 TBR.sh _mexsc_ds clm_urb1pt^nl_urb_br 19931201:NONE:3600 1x1_mexicocityMEX navy 72+72 arb_FAIL! rc= 5
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 4
048 smC61 TSM.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 -6 cold .................FAIL! rc= 10
049 erC61 TER.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 10+38 cold ..............FAIL! rc= 5
050 brC61 TBR.sh _sc_dh clm_urb^nl_urb_br 19981001:NONE:1800 1.9x2.5 gx1v5 -3+-3 cold ...........FAIL! rc= 5
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 4
052 smH51 TSM.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..........FAIL! rc= 1
053 erH51 TER.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic .......FAIL! rc= 1
054 brH51 TBR.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic .......FAIL! rc= 1
055 blH51 TBL.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..........FAIL! rc= 1
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

The above tests failed in clm3_6_19 and clm3_6_17, the latter tag being the last tag to be fully tested.
Urban tests will continue to fail until testing suite is updated to reflect the fact that urban data is now 
read in from netcdf files instead of ascii files.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_20

Changes answers relative to baseline:  bfb except when DUST and urban is on, the turbulent deposition 
velocity fields will be different because urban is no longer set to spval.

===============================================================
===============================================================
Tag name:  clm3_6_20
Originator(s):  mvr
Date:  Tue Mar  3  2009
One-line Summary: one line change to cpl7 template file to fix 1870 control setting

Purpose of changes: 

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): None
	
Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets:  None

Describe any substantial timing or memory changes: None

Code reviewed by: mvertens

List any svn externals directories updated (csm_share, mct, etc.):  

List all files eliminated: None

List all files added and what they do:  

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/bld/clm.cpl7.template


Summary of testing: manually tested via ccsm scripts

  bluefire: 
  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: n/a

Changes answers relative to baseline: n/a
	

===============================================================
===============================================================
Tag name:  clm3_6_19
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Fri Feb 27 15:47:48 MST 2009
One-line Summary: Changes to urban model and urban surface data

Purpose of changes: Changes to urban physical model and changes to mksurfdata for urban

Bugs fixed (include bugzilla ID): None

Known bugs (include bugzilla ID): 883 (aerosol deposition not from atm), 877 (CN restart problem)
                                   903 (problems in driver with open-MP on PGI)
                                   672 (3.5.4-3.5.14 diffs)
                                   851 (abort when files non-exist on jaguar)
                                   821 (mksurfdata for qtr deg), 789 (1pt sims 2.5X slow)
                                  794 (hist avg strange), 722 (threading slow) 
                                  701 (svn keyword), 698 (cprnc bug gives false difference)
                                  717 (archiving bug -- only archive 1000 files at a time)

Describe any changes made to build system: datm.cpl7.template modified to add gx1v6 domain file

Describe any changes made to the namelist: namelist_defaults_clm.xml modified to make sure finidat
      is blank when urban is turned on

List any changes to the defaults for the boundary datasets:  Raw "mksrf" urban file has been updated
   to /fis/cgd/tss/oleson/urban_sfcdata/Feddema_urban_data_080410/mksrf_urban_3den_0.5x0.5_CY2000.c090223_v2.nc
   New FV1.9x2.5 surface dataset with urban included is
   /fis/cgd/tss/oleson/urban_sfcdata/Feddema_urban_data_080410/surfdata_0096x0144_090223_v2.nc
   Neither of these has been fully tested in all model configurations.

Describe any substantial timing or memory changes: None

Code reviewed by: M. Vertens

List any svn externals directories updated (csm_share, mct, etc.):  
scripts updated to https://svn-ccsm-models.cgd.ucar.edu/scripts/trunk_tags/scripts4_090224/

List all files eliminated: None

List all files added and what they do:  
A      models/lnd/clm/tools/mksurfdata/mkelev.F90 ---- makes elevation field at desired resolution, this is
                                                       only used to screen out pct_urban in high altitude areas

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/tools/mksurfdata/mksurfdata.globalurban ---- replace raw urban dataset
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90 ---- add ELEVATION field
M      models/lnd/clm/tools/mksurfdata/mkvarpar.F90 ---- add elevation threshold parameter
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90 ---- add elevation field and screen pct_urban
M      models/lnd/clm/tools/mksurfdata/Srcfiles ---- add mkelev.F90
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml ---- add new FV1.9x2.5 dataset and make
             sure finidat is blank when urban is requested
M      models/lnd/clm/src/main/clm_varcon.F90 ---- add wasteheat limit factor
M      models/lnd/clm/src/main/clmtypeInitMod.F90 ---- add new anthropogenic heat variables
M      models/lnd/clm/src/main/clmtype.F90 ---- add new anthropogenic heat variables
M      models/lnd/clm/src/main/histFldsMod.F90 ---- add new anthropogenic heat variables, set_urb=0 for 
             VOC variables, set_urb=0 for dust flux
M      models/lnd/clm/src/main/mkarbinitMod.F90 ---- initialize walls and roofs to 292 to avoid AC/HEAT 
             initialization shock
M      models/lnd/clm/src/biogeophys/BalanceCheckMod.F90 --- reformulate energy balance check based on
             new anthropogenic heat variables, change threshold for water balance error to reflect value
             for rest of CLM
M      models/lnd/clm/src/biogeophys/SoilTemperatureMod.F90 ---- put wasteheat and traffic heat into 
             canyon floor, not walls and roofs
M      models/lnd/clm/src/biogeophys/UrbanInputMod.F90 ---- cleanup
M      models/lnd/clm/src/biogeophys/Biogeophysics2Mod.F90 ---- adjust ground heat flux for new wasteheat terms
M      models/lnd/clm/src/biogeophys/UrbanInitMod.F90 ---- initialize new anthropogenic heat terms
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 ---- new wasteheat fluxes and heat from AC


Summary of testing:

  bluefire: All PASS except

033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
038 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
039 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
040 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 4
042 smCA8 TSM.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 10
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 4
044 smNB4 TSM.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 10
045 erNB4 TER.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 59+100 arb_icFAIL! rc= 5
046 brNB4 TBR.sh _mexsc_ds clm_urb1pt^nl_urb_br 19931201:NONE:3600 1x1_mexicocityMEX navy 72+72 arb_FAIL! rc= 5
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 4
048 smC61 TSM.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 -6 cold .................FAIL! rc= 10
049 erC61 TER.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 10+38 cold ..............FAIL! rc= 5
050 brC61 TBR.sh _sc_dh clm_urb^nl_urb_br 19981001:NONE:1800 1.9x2.5 gx1v5 -3+-3 cold ...........FAIL! rc= 5
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 4
052 smH51 TSM.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..........FAIL! rc= 1
053 erH51 TER.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic .......FAIL! rc= 1
054 brH51 TBR.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic .......FAIL! rc= 1
055 blH51 TBL.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..........FAIL! rc= 1
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
086 bl744 TBLtools.sh mksurfdata tools__ds namelist .............................................FAIL! rc= 4
088 bl774 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 4
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

The above tests failed in the last tag that was fully tested (clm3_6_17).
NOTE that this testing was conducted BEFORE the namelist changes were made, the scripts directory
was updated, and the datm.cpl7.template was changed, and before the commit was updated to clm3_6_18.
But people are in a hurry.

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_17

Changes answers relative to baseline: bit-for-bit for standard modes.
                                      Urban answers are different.
                                      But see testing notes.

===============================================================
================================================================================
Tag name:  clm3_6_18
Originator(s):  kauff
Date: Thu Feb 26 18:15:33 MST 2009
One-line Summary: Add support for gx1v6 ocn domain & "1870 run"

Purpose of changes:  Add support for gx1v6 ocn domain & "1870 run"
                     

Bugs fixed (include bugzilla ID):  None

Known bugs (include bugzilla ID): 
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

  xml changes...
  - new attribute value: mask="gx1v6"
  - sim_year="1870" replaces sim_year="1890"

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets:

   lnd/clm2/initdata/clmi.B.0033-01-01_1.9x2.5_gx1v6_simyr2000_c090226.n

Describe any substantial timing or memory changes:  None

Code reviewed by: 
   This tag is largely E. Kluzek's mods checked in by B. Kauffman
   when Erik was unavailable to finish the tag, thus documentation here
   may be missing some important information only known to Erik.

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: 

M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90
M      models/lnd/clm/bld/namelist_files/namelist_definition.xml
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml
M      models/lnd/clm/bld/build-namelist
M      scripts/create_newcase
M      scripts/ccsm_utils/Tools/perl5lib/t/04.t
M      models/lnd/clm/tools/cprnc/Makefile

Summary of testing:

   be1005en% cat TestStatus.out
   doing a 10 day initial test
   doing a 5 day restart test
   Initial Test log is /ptmp/kauff/ERS.f19_g16.B.bluefire.173302/run/cpl.log.090226-174726
   Restart Test log is /ptmp/kauff/ERS.f19_g16.B.bluefire.173302/run/cpl.log.090226-180411
   Comparing initial log file with second log file
   log files match!
   PASS

These are known failures

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_17

Changes answers relative to baseline: 
   should bit-for-bit for previously supported resolutions

================================================================================
================================================================================

Tag name:  clm3_6_17
Originator(s):  oleson (Oleson Keith 1332 CGD)
Date:  Thu Feb 19 15:35:44 MST 2009
One-line Summary: Urban model changes and mksurfdata changes to incorporate urban data

Purpose of changes:  Put in several changes to the urban model.
                     Modify mksurfdata so that urban data are included in surface dataset.

Bugs fixed (include bugzilla ID):  None

Known bugs (include bugzilla ID): 883 (aerosol deposition not from atm), 877 (CN restart problem)
                                   903 (problems in driver with open-MP on PGI)
                                   672 (3.5.4-3.5.14 diffs)
                                   851 (abort when files non-exist on jaguar)
                                   821 (mksurfdata for qtr deg), 789 (1pt sims 2.5X slow)
                                  794 (hist avg strange), 722 (threading slow) 
                                  701 (svn keyword), 698 (cprnc bug gives false difference)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets:  If a raw "mksrf" urban file is used with 
   PCT_URBAN greater than zero, then urban parameters will be calculated and added to surface dataset.
   This doesn't affect any variables in the surface dataset.  If urban is desired the latest raw urban 
   file is /fis/cgd/tss/oleson/urban_sfcdata/Feddema_urban_data_080410/mksrf_urban_3den_0.5x0.5_CY2000.c090213.nc
   This has not been fully tested in all model configurations.

Describe any substantial timing or memory changes:  None

Code reviewed by: K. Oleson, E. Kluzek

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: 

A      models/lnd/clm/tools/mksurfdata/mkurbanparMod.F90 ---- generate urban parameters from raw urban parameter dataset  
List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/tools/mksurfdata/mksurfdata.globalurban ---- new default raw urban dataset
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90 ---- changes to generate urban parameters
M      models/lnd/clm/tools/mksurfdata/creategridMod.F90 ---- changes to generate urban parameters 
M      models/lnd/clm/tools/mksurfdata/mkvarpar.F90 ---- changes to generate urban parameters
M      models/lnd/clm/tools/mksurfdata/mkurban.F90 ---- changes to generate urban parameters
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90 ---- changes to generate urban parameters
M      models/lnd/clm/tools/mksurfdata/Srcfiles ---- add mkurbanparMod.F90
M      models/lnd/clm/src/main/clm_varpar.F90 ---- add numsolar variable
M      models/lnd/clm/src/main/initGridCellsMod.F90 ---- change decomp reference for wtlunit_roof and wtroad_perv
M      models/lnd/clm/src/main/surfrdMod.F90 ---- changes to read in urban parameters from surface dataset
M      models/lnd/clm/src/main/histFldsMod.F90 ---- set_urb=spval for dust fluxes within DUST cpp.
M      models/lnd/clm/src/biogeophys/UrbanInputMod.F90 ---- urban parameters now read in from netcdf surface dataset 
                                                            instead of ascii file
M      models/lnd/clm/src/biogeophys/UrbanInitMod.F90 ---- change decomp reference for g index
M      models/lnd/clm/src/biogeophys/FrictionVelocityMod.F90 ---- fv is now calculated for urban when DUST is on
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 ---- change decomp reference for g index

Summary of testing:

  bluefire: All PASS except
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
038 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
039 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
040 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 4
042 smCA8 TSM.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 10
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 4
044 smNB4 TSM.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 10
045 erNB4 TER.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 59+100 arb_icFAIL! rc= 5
046 brNB4 TBR.sh _mexsc_ds clm_urb1pt^nl_urb_br 19931201:NONE:3600 1x1_mexicocityMEX navy 72+72 arb_FAIL! rc= 5
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 4
048 smC61 TSM.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 -6 cold .................FAIL! rc= 10
049 erC61 TER.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 10+38 cold ..............FAIL! rc= 5
050 brC61 TBR.sh _sc_dh clm_urb^nl_urb_br 19981001:NONE:1800 1.9x2.5 gx1v5 -3+-3 cold ...........FAIL! rc= 5
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 4
052 smH51 TSM.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..........FAIL! rc= 1
053 erH51 TER.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic .......FAIL! rc= 1
054 brH51 TBR.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic .......FAIL! rc= 1
055 blH51 TBL.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..........FAIL! rc= 1
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
082 sm654 TSMtools.sh mkgriddata tools__ds namelist .............................................FAIL! rc= 6
083 sm674 TSMtools.sh mkgriddata tools__ds singlept .............................................FAIL! rc= 6
084 sm694 TSMtools.sh mkgriddata tools__ds ccsm_dom .............................................FAIL! rc= 6
086 bl744 TBLtools.sh mksurfdata tools__ds namelist .............................................FAIL! rc= 4
088 bl774 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 4
096 sm9J2 TSMext_ccsmseq_cam.sh ext_ccsm_seq_0.9x1.25_dh ext_ccsm_seq_cam 48 ....................FAIL! rc= 8
097 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
098 erP61 TSM_ccsmseq.sh ERS f19_g15 I4804 ......................................................FAIL! rc= 6
099 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804 ....................................................FAIL! rc= 6
100 erP68 TSM_ccsmseq.sh ERS f19_g15 ICASA ......................................................FAIL! rc= 6

These are known failures

  jaguar:
  kraken:
  lightning/pathscale:
  bangkok/lf95:
  breeze/gale/hail/gust/ifort:

CLM tag used for the baseline comparison tests if applicable: clm3_6_16

Changes answers relative to baseline: bit-for-bit for standard modes
                                      Urban answers are different

===============================================================
===============================================================
Tag name:  clm3_6_16
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Thu Feb 12 11:53:44 MST 2009
One-line Summary: Multiple elevation classes on surface dataset, urban fixes, mpi-serial and testing fixes

Purpose of changes: Modify surface dataset files to include multiple elevation class information for use with ice sheet model
                    Fix some urban issues
                    Fix rootfr for urban so zero in bedrock
                    Fix so organic is zero for urban
                    Fix index issue in SoilTemperature for urban, so global urban works
                    Update mct/mpi-serial version so that serial and pure-Open-MP versions work
                    For testing mkdir timing/checkpoints, and add serial T31 test
                    Fix datasets that had domain checking problems T42_gx1v5, T42_gx3v5, T31_gx3v5
                    Fix T62 datasets (still doesn't run though)
                    Fix so cols1d_lat on history files is latitudes instead of outputing longitudes
                    Deleted do loop that was replicated in Biogeophysics1Mod.F90
                    In build-namelist have forganic files at land_resolution
                    Actually make use of CLM_BLDNML_OPTS in clm.cpl7.template.csh
                    Have pftdyn mode ensure that maxpft=numpft+1
                    Add some changes from casafire branch for checking if doalb done and CN #ifdefs
                    Add more matches for finidat=null namelist defaults so that it will choose it rather than other ones
                   

Bugs fixed (include bugzilla ID): 887 (doesn't compile for serial mode), 885 (domain checking)
                                  900 (histFile output lats instead of lon), 899 (mask in mkdatadomain)
                                  896 (T62 partial), 895 (do loop replicated), 894 (forganic at lnd_res)
                                  893 (CLM_BLDNML_OPTS not queried), 888 (pftdyn mode ensures maxpft=numpft+1)
                                  878 (inconsistencies of datasets)

Known bugs (include bugzilla ID):  883 (aerosol deposition not from atm), 877 (CN restart problem)
                                   903 (problems in driver with open-MP on PGI)
                                   672 (3.5.4-3.5.14 diffs)
                                   851 (abort when files non-exist on jaguar)
                                   821 (mksurfdata for qtr deg), 789 (1pt sims 2.5X slow)
                                  794 (hist avg strange), 722 (threading slow) 
                                  701 (svn keyword), 698 (cprnc bug gives false difference)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 546(interpinic for DGVM),
                                          652 (threads different answers with older PGI versions)

Describe any changes made to build system: Remove now unneccessary CPPDEF's for timing (HAVE_MPI and HAVE_GETTIMEOFDAY), on
                                           Linux use THREADED_OMP for PGI and THREADED_PTHREADS otherwise, on lahey change CFLAGS
                                           (These changes agree with latest CAM Makefile)

Describe any changes made to the namelist: Add urban_hac and urban_traffic namelist items

        urban_hac = OFF, ON or ON_WASTEHEAT   (default OFF)     Flag for urban Heating and Air-Conditioning
                                                       OFF          = Building internal temperature is un-regulated.
                                                       ON           = Building internal temperature is bounded to reasonable range.
                                                       ON_WASTEHEAT = Building internal temperature is bounded and resultant waste
                                                                      heat is given off.
        urban_traffic = .true. or .false.     (default .false.) Flag to include additional multiplicative factor of urban traffic
                                                                to sensible heat flux.

List any changes to the defaults for the boundary datasets: Fix T62 datasets, change T31_gx3v5, T42_gx3v5, T42_gx1v5 
      domain datasets, fix some surface and organic datasets

Describe any substantial timing or memory changes: None

Code reviewed by: oleson, dlawren, and self 
         (Urban changes are from Keith, glacier elev.  classes from Dave).

List any svn externals directories updated (csm_share, mct, etc.): scripts, drv, and mct

+scripts to scripts4_090126/
+drv     to drvseq3_0_08/
+mct     to i8br02_MCT2_5_1_080912

List all files eliminated: None

List all files added and what they do:

A      models/lnd/clm/tools/mksurfdata/mkglcmec.F90 ------------ Makes topo, thck, pctglc for multiple elevation 
                                                                 classes for use with ice sheet model
A      models/lnd/clm/test/system/config_files/4p_vodsrsc_ds --- Add serial configuration
A      models/lnd/clm/test/system/config_files/ext_ccsm_seq_0.9x1.25_dh - Add resolution
for bluefire
A      models/lnd/clm/bld/namelist_files/checklatsfiles.ncl ---- Check latitudes/longitudes on input files
A      models/lnd/clm/bld/namelist_files/checkdatmfiles.ncl ---- Check lat/lon/area on domain file vs. clm frac input files
A      models/lnd/clm/bld/namelist_files/checktopofiles.ncl ---- Check latitudes/longitudes on topo input files

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>>>>>>>>>>> Make the timing/checkpoints directory, and add a T31 serial test case
>>>>>>>>>>>>>>>>>>>>>>>> Work on getting tests to fit in batch time-limit
>>>>>>>>>>>>>>>>>>>>>>>> Add 1.9x2.5 with 0.9x1.25 finemesh test, T62 and 0.9x1.25 tests
M      models/lnd/clm/test/system/README.testnames
M      models/lnd/clm/test/system/input_tests_master -- add new tests
M      models/lnd/clm/test/system/test_driver.sh --- increase proc on bluefire, update to
                                                     beta09, remove old NCEP data dir
M      models/lnd/clm/test/system/TSMext_ccsmseq_cam.sh
M      models/lnd/clm/test/system/TSMpergro.sh
M      models/lnd/clm/test/system/TSMcnspinup.sh
M      models/lnd/clm/test/system/TSMruncase.sh
M      models/lnd/clm/test/system/TSM.sh
M      models/lnd/clm/test/system/tests_pretag_bluefire --- Change tests/resolutions so
                                                            may fit in 6-hour wallclock
M      models/lnd/clm/test/system/tests_pretag_jaguar
M      models/lnd/clm/test/system/tests_posttag_kraken
M      models/lnd/clm/test/system/tests_posttag_lightning
>>>>>>>>>>>>>>>>>>>>>>>> Fix so handles multiple files correctly, remembering previous
>>>>>>>>>>>>>>>>>>>>>>>> data already set.
M      models/lnd/clm/tools/mkgriddata/ncdio.F90 ------ Copy from mksurfdata
M      models/lnd/clm/tools/mkgriddata/areaMod.F90 ---- Copy from mksurfdata
M      models/lnd/clm/tools/mkgriddata/mkgriddata.F90 - Pass ldomain down
M      models/lnd/clm/tools/mkgriddata/domainMod.F90 -- Add ability to get area/mask/fracset 
                                                        from domainIsSet method. Fix so
                                                        area/mask/frac set is correct
M      models/lnd/clm/tools/mkgriddata/creategridMod.F90 - Pass ldomain down, use setptrs,
                                                           be careful with details of when
                                                           and how to set data. Use domainIsSet method 
M      models/lnd/clm/tools/mkgriddata/Makefile ------ Update Makefile on AIX for debugging, add ifort
M      models/lnd/clm/tools/mkgriddata/Srcfiles ------ Remove mkvarsur and add mkvarpar
M      models/lnd/clm/tools/mkgriddata/Filepath ------ Add mksurfdata to Filepath
>>>>>>>>>>>>>>>>>>>>>>>> Fix area and mask
M      models/lnd/clm/tools/mkdatadomain/create_domain.F90 - Fix area and mask
M      models/lnd/clm/tools/mkdatadomain/Makefile ---- Update Makefile on AIX for debugging, add ifort
M      models/lnd/clm/tools/mkgriddata/ncdio.F90 ------ Add some netCDF interfaces as public, put spval in here
>>>>>>>>>>>>>>>>>>>>>>>>  Add glc elev.-class variables, some bug-fixes, make comptable
>>>>>>>>>>>>>>>>>>>>>>>>  with mkgriddata code that is the same. Change tests to 10x15 res.
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90 ------ Add glc elev.-class variables 
                                                           and more only for use statements
                                                           Set organic3d to zero for glacier, wetland and lake.
                                                           Replace bare-soil preferentially with urban.
M      models/lnd/clm/tools/mksurfdata/creategridMod.F90 - Include netcdf
M      models/lnd/clm/tools/mksurfdata/areaMod.F90 --- Make gridmap_checkmap public
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90 - Add glacier elevation class variables
M      models/lnd/clm/tools/mksurfdata/mkvarctl.F90 -- Add topo and frac files to read
M      models/lnd/clm/tools/mksurfdata/mkvarpar.F90 -- Add nglcec for # of glacier elevation classes
M      models/lnd/clm/tools/mksurfdata/domainMod.F90 - Copy from mkgriddata
M      models/lnd/clm/tools/mksurfdata/Srcfiles ------ Add new file to compile mkglcmec.F90
M      models/lnd/clm/tools/mksurfdata/Makefile ------ Update Makefile on AIX for debugging, add ifort
M      models/lnd/clm/tools/mksurfdata/mksurfdata.namelist - Correct gridfile
M      models/lnd/clm/tools/mksurfdata/mksurfdata.regional
M      models/lnd/clm/tools/mksurfdata/mksurfdata.singlept
>>>>>>>>>>>>>>>>>>>>>>>> Add urban_hac, urban_traffic namelist parameters, create 
>>>>>>>>>>>>>>>>>>>>>>>> timing dirs, new frac/domain datasets, fix T62, some forganic files
M      models/lnd/clm/bld/clm.cpl7.template - Use CLM_BLDNML_OPTS now
M      models/lnd/clm/bld/build-namelist ---- forganic at lnd_res, add new defaults, add
                                              fndepdyn for fsurdat/finidat
M      models/lnd/clm/bld/run-pc.csh
M      models/lnd/clm/bld/run-ibm.csh
M      models/lnd/clm/bld/run-lightning.csh
M      models/lnd/clm/bld/config_files/Makefile.in ---- Remove CPPDEFS no longer required by timing library
M      models/lnd/clm/bld/namelist_files/namelist_definition.xml --- Add urban_hac,
urban_traffic, timing_dir, tchkpt_dir, eps_frac, eps_agrid, eps_amask, eps_aarea, fix T62
grid
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml - Add new defaults,
more settings for finidat, fix T62 datasets, new frac/domain files for T42, T31

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Add notes about removing aerdep file reading in clm
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Fix some bugs
M      models/lnd/clm/src/main/driver.F90 --------- Notes about removing aerdep file
M      models/lnd/clm/src/main/aerdepMod.F90 ------ Remove aerdep file set, split dust/caerdep
M      models/lnd/clm/src/main/iniTimeConst.F90 --- remove call to aerdepini
M      models/lnd/clm/src/main/clm_atmlnd.F90 ----- add notes about removing aerdep file
stuff
M      models/lnd/clm/src/main/clm_varctl.F90 ----- add notes about removing aer

M      models/lnd/clm/src/main/pftdynMod.F90 ------ Add error check for pftdyn
M      models/lnd/clm/src/main/histFileMod.F90 ---- Fix cols1d_lon
M      models/lnd/clm/src/main/lnd_comp_mct.F90 --- Make sure albedo's are calculated 
                                                    some time within a coupling step
                                                    And add lnd_chkSetAerDep_mct to
                                                    check if aersol deposition fields are filled
      models/lnd/clm/src/biogeophys/Biogeophysics1Mod.F90 - Remove extra forcing loop
>>>>>>>>>>>>>>>>>>>>>>>>> Add urban_hac, urban_traffic namelist parameters to code
>>>>>>>>>>>>>>>>>>>>>>>>> Fix so rootfr is zero for bedrock, fix index in SoilTemperature, set organic to zero for urban
M      models/lnd/clm/src/main/clm_varcon.F90 --------------- Add new urban vars
M      models/lnd/clm/src/main/iniTimeConst.F90 ------------- No organic for urban, perv rock at zero
M      models/lnd/clm/src/main/controlMod.F90 --------------- Add notes about removing aerdep file
                                                              add urban_hac and urban_traffic
M      models/lnd/clm/src/main/histFldsMod.F90 -------------- Add new output vars for urban
M      models/lnd/clm/src/biogeophys/BalanceCheckMod.F90 ---- Output snowcap ice
M      models/lnd/clm/src/biogeophys/SoilTemperatureMod.F90 - Fix index bug
M      models/lnd/clm/src/biogeophys/UrbanInitMod.F90 ------- add new urban namelist vars
M      models/lnd/clm/src/biogeophys/SoilHydrologyMod.F90 --- For perv road runoff=snowcapping rather than zero
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 ----------- New urban control vars
>>>>>>>>>>>>>>>>>>>>>>>>>>> Add #ifdef's for CN mode
M      models/lnd/clm/src/main/CNiniTimeVar.F90
M      models/lnd/clm/src/main/CNiniSpecial.F90
M      models/lnd/clm/src/biogeochem/CNCStateUpdate2Mod.F90
M      models/lnd/clm/src/biogeochem/CNGapMortalityMod.F90
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate2Mod.F90
M      models/lnd/clm/src/biogeochem/CNGRespMod.F90
M      models/lnd/clm/src/biogeochem/CNNStateUpdate1Mod.F90
M      models/lnd/clm/src/biogeochem/CNBalanceCheckMod.F90
M      models/lnd/clm/src/biogeochem/CNNStateUpdate3Mod.F90
M      models/lnd/clm/src/biogeochem/CNFireMod.F90
M      models/lnd/clm/src/biogeochem/CNMRespMod.F90
M      models/lnd/clm/src/biogeochem/CNPrecisionControlMod.F90
M      models/lnd/clm/src/biogeochem/CNSummaryMod.F90
M      models/lnd/clm/src/biogeochem/CNPhenologyMod.F90
M      models/lnd/clm/src/biogeochem/CNCStateUpdate1Mod.F90
M      models/lnd/clm/src/biogeochem/CNDecompMod.F90
M      models/lnd/clm/src/biogeochem/CNCStateUpdate3Mod.F90
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate1Mod.F90
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate3Mod.F90
M      models/lnd/clm/src/biogeochem/CNAnnualUpdateMod.F90
M      models/lnd/clm/src/biogeochem/CNNStateUpdate2Mod.F90
M      models/lnd/clm/src/biogeochem/C13SummaryMod.F90
M      models/lnd/clm/src/biogeochem/CNNDynamicsMod.F90
M      models/lnd/clm/src/biogeochem/CNAllocationMod.F90
M      models/lnd/clm/src/biogeochem/CNC13FluxMod.F90
M      models/lnd/clm/src/biogeochem/CNEcosystemDynMod.F90
M      models/lnd/clm/src/biogeochem/CNSetValueMod.F90
M      models/lnd/clm/src/biogeochem/CNVegStructUpdateMod.F90

M      Quickstart.GUIDE --------- Change names of compsets to beta09 names, add more
notes

Summary of testing:

  bluefire: All PASS except
004 blA74 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 5
014 blH74 TBL.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic ......FAIL! rc= 5
028 blF93 TBL.sh 17p_vodsrsc_do clm_std 19981230:NONE:1800 4x5 gx3v5 48 cold ....................FAIL! rc= 5
033 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
034 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
035 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
036 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
041 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
043 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
047 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
051 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 cold .................FAIL! rc= 5
052 smH51 TSM.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..........FAIL! rc= 1
053 erH51 TER.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic .......FAIL! rc= 1
054 brH51 TBR.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic .......FAIL! rc= 1
055 blH51 TBL.sh 17p_cnnsc_dh clm_std std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..........FAIL! rc= 1
057 smLI1 TSM.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
058 erLI1 TER.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
059 brLI1 TBR.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
060 blLI1 TBL.sh _sc_dh clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 4
062 blL78 TBL.sh _sc_s clm_std 19971231:NONE:1800 1x1_brazil navy -10 arb_ic ....................FAIL! rc= 5
068 blL83 TBL.sh _sc_do clm_std 19980115:NONE:3600 5x5_amazon navy -10 arb_ic ...................FAIL! rc= 5
077 blJ74 TBL.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic .........FAIL! rc= 5
  kraken: ALL PASS except
001 smEH2 TSM.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 48 arb_ic .......FAIL! rc= 10
002 erEH2 TER.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 10+38 arb_ic ....FAIL! rc= 5
003 brEH2 TBR.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 1.9x2.5^0.9x1.25 USGS 24+24 arb_ic ....FAIL! rc= 5
005 smG43 TSM.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
006 erG43 TER.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 10+38 arb_ic ................FAIL! rc= 5
007 brG43 TBR.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
009 smJ05 TSM.sh 4p_casasc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5 48 startup ....FAIL! rc= 10
010 smJ74 TSM.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -1100 arb_ic ........FAIL! rc= 10
011 erJ74 TER.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -10+-10 arb_ic ......FAIL! rc= 5
012 brJ74 TBR.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -3+-3 arb_ic ........FAIL! rc= 5
014 smLI2 TSM.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10 arb_ic ........................FAIL! rc= 10
015 erLI2 TER.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -5+-5 arb_ic ......................FAIL! rc= 5
016 brLI2 TBR.sh _sc_dm clm_std 19980101:NONE:1800 94x192 T62 -10+-10 arb_ic ....................FAIL! rc= 5
022 erP95 TSM_ccsmseq.sh ERS f45_g35 ICN ........................................................FAIL! rc= 4
023 erP98 TSM_ccsmseq.sh ERS f45_g35 ICASA ......................................................FAIL! rc= 4
  lightning/pathscale: All PASS except
005 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
006 smOC4 TSM.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 10
007 erOC4 TER.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 115+115 arb_icFAIL! rc= 5
008 brOC4 TBR.sh _vansc_ds clm_urb1pt^nl_urb_br 19920812:NONE:3600 1x1_vancouverCAN navy 72+72 arb_iFAIL! rc= 5
009 blOC4 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 4
010 smA91 TSM.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ..........................FAIL! rc= 10
011 erA91 TER.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 5
012 brA91 TBR.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 5
013 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ..........................FAIL! rc= 4
017 blL74 TBL.sh _sc_s clm_std 19980101:NONE:1800 1x1_brazil navy -10 arb_ic ....................FAIL! rc= 5
018 smG42 TSM.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
019 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
020 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
021 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
024 erJ42 TER.sh 4p_casasc_dm clm_std 19981230:NONE:1800 10x15 USGS 10+38 startup ...............FAIL! rc= 7
025 brJ42 TBR.sh 4p_casasc_dm clm_std 19981230:NONE:1800 10x15 USGS 72+72 startup ...............FAIL! rc= 6
028 erK51 TER.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 7
029 brK51 TBR.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 72+72 arb_ic ...............FAIL! rc= 6
030 blK51 TBL.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 48 arb_ic ..................FAIL! rc= 5
031 smL51 TSM.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 96 arb_ic .........................FAIL! rc= 10
032 erL51 TER.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ......................FAIL! rc= 5
033 brL51 TBR.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ......................FAIL! rc= 5
034 blL51 TBL.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 48 arb_ic .........................FAIL! rc= 4
040 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
041 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
  bangkok/lf95: All PASS except
008 blA74 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 5
009 smD91 TSM.sh _persc_dh clm_per 19981231:NONE:1200 4x5 gx3v5 144 startup .....................FAIL! rc= 10
010 erD91 TER.sh _persc_dh clm_per 19981231:NONE:1200 4x5 gx3v5 72+72 startup ...................FAIL! rc= 5
011 blD91 TBL.sh _persc_dh clm_per 19981231:NONE:1200 4x5 gx3v5 144 startup .....................FAIL! rc= 4
016 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
020 blOC4 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 5
024 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
028 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 7
030 smH52 TSM.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..............FAIL! rc= 10
031 erH52 TER.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic ...........FAIL! rc= 5
032 brH52 TBR.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic ...........FAIL! rc= 5
033 blH52 TBL.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..............FAIL! rc= 4
038 smK51 TSM.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 96 arb_ic ..................FAIL! rc= 10
039 erK51 TER.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 5
040 brK51 TBR.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 72+72 arb_ic ...............FAIL! rc= 5
041 blK51 TBL.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 48 arb_ic ..................FAIL! rc= 4
042 smL51 TSM.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 96 arb_ic .........................FAIL! rc= 10
043 erL51 TER.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ......................FAIL! rc= 5
044 brL51 TBR.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ......................FAIL! rc= 5
045 blL51 TBL.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 48 arb_ic .........................FAIL! rc= 4
046 smL58 TSM.sh _sc_dh clm_std^nl_crcrop 19980115:NONE:1800 10x15 USGS 96 arb_ic ...............FAIL! rc= 10
050 blL74 TBL.sh _sc_s clm_std 19980101:NONE:1800 1x1_brazil navy -10 arb_ic ....................FAIL! rc= 5
052 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
053 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
057 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  breeze/gale/hail/gust/ifort: All PASS

CLM tag used for the baseline comparison tests if applicable: clm3_6_15

Changes answers relative to baseline: bit-for-bit for standard modes
                                      actually now works for mpi-serial mode
                                      Urban answers are different (see above)

===============================================================
===============================================================
Tag name:  clm3_6_15
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Mon Jan 19 22:51:29 MST 2009
One-line Summary: Bring clm36sci branch to the trunk

Purpose of changes: Move the clm36 science branch to the trunk
                    Brings in changes to data atm. so data has correct times, and
                    solar matches solar zenith angle 
                    Deep soil with bedrock at bottom, David Lawrence
                    Organic matter in soils David Lawrence
                    SNICAR brought in for snow radiation Mark Flanner
                    Adjustments to hydrology, Keith Oleson, Sean Swenson
                    Sparse dense aero.
                    Snow cover fraction and snow veg cover
                    CN Changes from Peter Thornton and Sam Levis
                    CLAMP and CASA changes from Forrect Hoffman
                    New surface datasets (old lake/wetlands), new pft etc. from Peter Lawrence
                    New pft-physiology file with changes for grass/crop
                    Forcing height now h_atm+z0+d for each pft
                    Add stub glacier

Bugs fixed (include bugzilla ID): 753 (data off by 1.5 hours)

Known bugs (include bugzilla ID):  885 (domain checking), 883 (aerosol deposition is zero)
                                   877 (CN restart problem), 887 (doesn't compile for serial mode)
                                   672 (3.5.4-3.5.14 diffs)
                                   851 (abort when files non-exist on jaguar), 888 (add check for pftdyn mode)
                                   821 (mksurfdata for qtr deg), 789 (1pt sims 2.5X slow)
                                  794 (hist avg strange), 722 (threading slow) 
                                  701 (svn keyword)
                                  698 (cprnc bug gives false difference)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 546(interpinic for DGVM),
                                          652 (threads different answers with older PGI versions)

Hydrology changes (Guo-Yue Niu water table below soil column, fff=7, 
Qing micropore eqs (hksat and sucsat) and Qing microporosity 
-Simulation clm3_5niu5).

Snow cover fraction (Niu and Yang); snow burial fraction for short vegetation 
(Wang and Zeng); thermal and hydraulic organic soil (Lawrence); 
snow compaction fix (Lawrence); snow T profile during layer splitting 
fix (Lawrence); new FGR12 diagnostic.

Ground emissivity now weighted combination (using fsno) of snow and soil 
emissivity, sparse dense aerodynamic parameters from X. Zeng parameterization, 
Liu (2004) saturated hydraulic conductivity and matric potential,
change saturation excess mechanism to only go to next to lowest layer, change 
forcing height to min. of 40m.

Lower volumetric soil water content to remove drainage spikes from some points
with high sand content. Change volumetric soil water content from 0.4 to 0.3.

Incorporate hydrologically inactive deep soil (15 layers, 11-15
hyrdologically inactive) and add mksoilcarb capability.
Change deep soil (layers 11-15) to dry rock type rather than wet sand
to reduce spinup time and for greater realism.

Improved representation of snow-radiation interaction, including snow aging, 
darkening from black carbon and dust, and vertically-resolved solar heating.

Remove code pertaining to 40m minimum forcing height. Forcing height is now
whatever the atmospheric model provides plus z0+d of each pft.  For offline
simulations this will be 30m+z0+d.

saturation excess back to CLM3.5 parameterization.  Sakaguchi litter resistance
Remove Qing Liu soil micropore functions and return to CLM3.5 formulations, 
change decay factor for drainage to 2.5. remove Niu water table below soil 
column formulation, frozen fraction of soil expression normalized per Zeng,
rsubmax=9.9 for drainage calculation, decay factor=0.5 for surface runoff 
calculation, Zeng/Decker Richards equation mods, modified one-step solution 
for soil moisture and qcharge for compatibility with Zeng/Decker Richards 
mods per Swenson.

Change input datm7 forcing so that Precip is  over 6 hour interval, 
times are corrected for Temp, Pres, Humid, and Wind data and linear 
interpolation is used, and solar data is scaled by the cos(sol-zen angle).

Set litter LAI = 0.5 and incorporate Swenson organic/mineral soil hk 
percolation theory

CASA changes from Forrest Hoffman:

   These changes add SOILPSI to the CASA'
   configuration, correct units on C-LAMP carbon pool type fluxes, and reclassify
   microbial pools as soil type pools.  I believe this includes all modifications
   between bgcmip04_clm3_expa_60 and bgcmip08_clm3_expa_72.

Summary of CN and Btran changes from Sam Levis:

- CanopyFluxes modification in the calculation of btran so that it equals 0 in soil layers with temperature <=-2 C.
- CN mods recommended by Peter Thornton and the BGCWG during the bgc development phase of the last few months.

Grassland AND CROP optical properties changes from Keith Oleson:

New pft physiology file was created:

pft-physiology.c081002

Description of changes to physiology file:

New leaf and stem optical properties (VIS and NIR reflectance and transmittance)
were derived for grasslands and crops (pfts 12-16) from full optical range 
spectra of measured optical properties (Asner et al. (RSE 1998). 

New properties are:

                          Leaf              Stem
                   VIS         NIR       VIS     NIR
Reflectance        0.11        0.35      0.31    0.53
Transmittance      0.05        0.34      0.12    0.25


Describe any changes made to build system: 

   Add SNICAR_FRC and CARBON_AERO ifdef tokens

   DEFINE option SNICAR_FRC: enables second radiative transfer calculation of pure snow for radiative forcing estimation

   in configure use options -carbon_aero and -snicar_frc

Describe any changes made to the namelist:  Add fsnowoptics, fsnowaging, faerdep

Added namelist variables fsnowoptics, fsnowaging, and faerdep, which point to files containing, respectively, snow/aerosol optical properties, snow aging parameters, and global aerosol deposition file. THESE FILES ARE REQUIRED.

List any changes to the defaults for the boundary datasets:

   finidat files developed, all new fsurdat files, new pft-physiology,
   files for T62, new organic files, new files for SNICAR (fsnowoptics, 
   fsnowaging, faerdep), fix some inconsistencies with fraction files, 
   get topo files setup correctly, get all files for 4x5 and 2x2.5 resolution

Describe any substantial timing or memory changes: Yes
     20% slower because of SNICAR and slower because of deep soil

Code reviewed by: Keith Oleson, Mark Flanner, Dave Lawrence, 
                  Peter Thornton, Sam Levis, Sean Swenson

List any svn externals directories updated (csm_share, mct, etc.): scripts, 
                    drv, datm7, socn, sice, sglc, csm_share, timing, pio, cprnc

+scripts                       scripts4_090112
+models/drv/seq_mct            drvseq3_0_04
+models/atm/datm7              datm7_090107
+models/ocn/socn               stubs1_1_01/socn
+models/ice/sice               stubs1_1_01/sice
+models/glc/sglc               stubs1_1_01/sglc
+models/csm_share              share3_090112
+models/utils/timing           timing_081028
+models/utils/pio              pio28_prod/pio
+models/lnd/clm/tools/cprnc    cprnc_081022

List all files eliminated:

D      models/lnd/clm/test/system/tests_pretag_bluevista - remove
D      models/lnd/clm/bld/scpDefaultNamelist.pl ---------- replace with listDefaultNamelist.pl
D      models/lnd/clm/bld/run-frost.csh ------------------ remove as can use cpl7
D      models/lnd/clm/tools/interpinic/clmi_1999-01-02_10x15_c070330.nc -- new file

List all files added and what they do:

A  +   models/lnd/clm/test/system/nl_files/clm_organic ------------ test organic
A  +   models/lnd/clm/tools/mksurfdata/mkorganic.F90 -------------- add organic to surfdat
A  +   models/lnd/clm/tools/mksurfdata/mksurfdata.pl -------------- create all fsurdat files
A  +   models/lnd/clm/tools/ncl_scripts/aerdepregrid.ncl ---------- interpolate aerosol deposition
A  +   models/lnd/clm/tools/ncl_scripts/clmi_increasesoillayer.ncl  interpolate old clmi files to 15 soil levels
A  +   models/lnd/clm/tools/interpinic/clmi.IQ.1953-01-01_10x15_USGS_simyr2000_c081202.nc
                                                   ---------------- new 15 layer file to test interpolation
A  +   models/lnd/clm/tools/interpinic/runinit_ibm.csh ------------ create all finidat files
A  +   models/lnd/clm/bld/listDefaultNamelist.pl ------------------ list inputdata files needed
A  +   models/lnd/clm/src/main/organicFileMod.F90 ----------------- organic soil
A  +   models/lnd/clm/src/main/aerdepMod.F90 ---------------------- read in aerosol deposition
A  +   models/lnd/clm/src/biogeophys/SNICARMod.F90 ---------------- SNICAR model
A  +   Quickstart.GUIDE ------------------------------------------- Quickstart to cpl7 scripts

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>>>>>>>>>>>> Add compile_only option, fix smp/spmd, change most
>>>>>>>>>>>>>>>>>>>>>>>>> tests to 4x5 resolution, update ccsm version, 
>>>>>>>>>>>>>>>>>>>>>>>>> remove bluevista, change to clm_qian inputdata
>>>>>>>>>>>>>>>>>>>>>>>>> add cold start type

M      models/lnd/clm/test/system/TCB.sh
M      models/lnd/clm/test/system/config_files/4p_vodsrsc_dm
M      models/lnd/clm/test/system/config_files/4p_vodsrsc_do
M      models/lnd/clm/test/system/config_files/scam_ds ----- fix defaults for scam
M      models/lnd/clm/test/system/config_files/17p_cnnsc_o
M      models/lnd/clm/test/system/config_files/4p_casasc_dm
M      models/lnd/clm/test/system/config_files/10p_dgvmsc_o
M      models/lnd/clm/test/system/config_files/4p_casasc_do
M      models/lnd/clm/test/system/config_files/4p_casasc_o
M      models/lnd/clm/test/system/config_files/17p_vodsrsc_o
M      models/lnd/clm/test/system/config_files/17p_cnnsc_dm
M      models/lnd/clm/test/system/config_files/17p_cnnsc_do
M      models/lnd/clm/test/system/config_files/10p_dgvmsc_dm
M      models/lnd/clm/test/system/config_files/10p_dgvmsc_do
M      models/lnd/clm/test/system/config_files/17p_vodsrsc_dm
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_64x128_s
M      models/lnd/clm/test/system/config_files/17p_vodsrsc_do
M      models/lnd/clm/test/system/config_files/4p_vodsrsc_o
M      models/lnd/clm/test/system/TSMncl_tools.sh
M      models/lnd/clm/test/system/CLM_compare.sh
M      models/lnd/clm/test/system/TBL.sh
M      models/lnd/clm/test/system/TSM_ccsmseq.sh
M      models/lnd/clm/test/system/TSMext_ccsmseq_cam.sh
M      models/lnd/clm/test/system/tests_pretag_jaguar
M      models/lnd/clm/test/system/tests_posttag_kraken
M      models/lnd/clm/test/system/tests_pretag_bluefire
M      models/lnd/clm/test/system/README.testnames
M      models/lnd/clm/test/system/tests_posttag_breeze
M      models/lnd/clm/test/system/tests_pretag_bangkok
M      models/lnd/clm/test/system/TBR.sh
M      models/lnd/clm/test/system/TCBtools.sh
M      models/lnd/clm/test/system/TER.sh
M      models/lnd/clm/test/system/test_driver.sh
M      models/lnd/clm/test/system/tests_posttag_purempi_regression
M      models/lnd/clm/test/system/mknamelist
M      models/lnd/clm/test/system/tests_posttag_hybrid_regression
M      models/lnd/clm/test/system/TCT_ccsmseq.sh
M      models/lnd/clm/test/system/TCSruncase.sh
M      models/lnd/clm/test/system/TSMpergro.sh
M      models/lnd/clm/test/system/nl_files/clm_per
M      models/lnd/clm/test/system/nl_files/clm_urb
M      models/lnd/clm/test/system/nl_files/clm_std
M      models/lnd/clm/test/system/nl_files/clm_ndepdyn
M      models/lnd/clm/test/system/nl_files/clm_pftdyn
M      models/lnd/clm/test/system/nl_files/clm_per0
M      models/lnd/clm/test/system/TSMcnspinup.sh
M      models/lnd/clm/test/system/input_tests_master
M      models/lnd/clm/test/system/TSMtools.sh
M      models/lnd/clm/test/system/TSMruncase.sh
M      models/lnd/clm/test/system/TCBext_ccsmseq_cam.sh
M      models/lnd/clm/test/system/TSCext_ccsmseq_scam.sh
M      models/lnd/clm/test/system/tests_posttag_lightning
M      models/lnd/clm/test/system/CLM_runcmnd.sh
M      models/lnd/clm/test/system/TBLtools.sh
M      models/lnd/clm/test/system/TSM.sh

>>>>>>>>>>>>>>>>>>>>>>>>> Add organic add option to output as double precision
>>>>>>>>>>>>>>>>>>>>>>>>> be more careful with averging add error checking
M      models/lnd/clm/tools/mksurfdata/mkvarctl.F90
M      models/lnd/clm/tools/mksurfdata/mksurfdata.globalurban
M      models/lnd/clm/tools/mksurfdata/mksurfdata.regional
M      models/lnd/clm/tools/mksurfdata/mkfileMod.F90
M      models/lnd/clm/tools/mksurfdata/Makefile ----------- -Kieee for pgi
M      models/lnd/clm/tools/mksurfdata/mksurfdata.singlept
M      models/lnd/clm/tools/mksurfdata/mksrfdat.F90
M      models/lnd/clm/tools/mksurfdata/Srcfiles
M      models/lnd/clm/tools/mksurfdata/mksurfdata.namelist

>>>>>>>>>>>>>>>>>>>>>>>>> 15 levels for urban
MM     models/lnd/clm/tools/ncl_scripts/generate_ascii_avg_urbanparam_file_p7.ncl
M      models/lnd/clm/tools/ncl_scripts/README

>>>>>>>>>>>>>>>>>>>>>>>>> Change for 15 levels and new variables/dims on dataset
M      models/lnd/clm/tools/interpinic/interpinic.F90
M      models/lnd/clm/tools/interpinic/interpinic.runoptions
M      models/lnd/clm/tools/interpinic/Srcfiles
M      models/lnd/clm/tools/interpinic/Filepath
M      models/lnd/clm/tools/interpinic/Makefile

>>>>>>>>>>>>>>>>>>>>>>>>> 10x15 resolution, start to resolve domain checking bug
M      models/lnd/clm/tools/mkgriddata/mkgriddata.namelist
M      models/lnd/clm/tools/mkgriddata/mkgriddata.F90
M      models/lnd/clm/tools/mkgriddata/domainMod.F90
M      models/lnd/clm/tools/mkgriddata/creategridMod.F90
M      models/lnd/clm/tools/mkgriddata/Makefile

>>>>>>>>>>>>>>>>>>>>>>>>> Get grid data from grid files rather than frac files
M      models/lnd/clm/tools/mkdatadomain/mkdatadomain.namelist
M      models/lnd/clm/tools/mkdatadomain/addglobal.F90
M      models/lnd/clm/tools/mkdatadomain/create_domain.F90
M      models/lnd/clm/tools/mkdatadomain/Makefile

>>>>>>>>>>>>>>>>>>>>>>>>> minor changes to build, new datasets for build-namelist
M      models/lnd/clm/bld/configure --- add -snicar_frc and -carbon_aero, add sglc, remove timing for cpl7
M      models/lnd/clm/bld/queryDefaultNamelist.pl --- minor change
M      models/lnd/clm/bld/config_files/Makefile.in -- add HAVE_GETTIMEOFDAY for new timing, more consistent with cpl7 build
M      models/lnd/clm/bld/config_files/config_definition.xml -- add snicar_frc and carbon_aero
M      models/lnd/clm/bld/clm.cpl7.template -- simplify update for new scripts
M      models/lnd/clm/bld/README ------------- update info.
M      models/lnd/clm/bld/namelist_files/namelist_definition.xml ----- add new namelist items remove irad
M      models/lnd/clm/bld/namelist_files/datm.streams.template.xml --- new Qian datasets
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml --- new defaults
M      models/lnd/clm/bld/build-namelist

>>>>>>>>>>>>>>>>>>>>>>>>> change default resolution to 4x5 remove irad
M      models/lnd/clm/bld/run-pc.csh
M      models/lnd/clm/bld/run-ibm.csh
M      models/lnd/clm/bld/run-lightning.csh

>>>>>>>>>>>>>>>>>>>>>>>>> New 15 layer urban single point datasets
M      models/lnd/clm/bld/urban_input/metropolis_fluxes.txt
M      models/lnd/clm/bld/urban_input/asphaltjungle_fluxes.txt
M      models/lnd/clm/bld/urban_input/mexicocityMEX_fluxes.txt
M      models/lnd/clm/bld/urban_input/vancouverCAN_fluxes.txt

>>>>>>>>>>>>>>>>>>>>>>>>> Code changes documented above
M      models/lnd/clm/src/biogeochem/CASASummaryMod.F90
M      models/lnd/clm/src/biogeochem/CNCStateUpdate2Mod.F90
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate2Mod.F90
M      models/lnd/clm/src/biogeochem/CNNStateUpdate1Mod.F90
M      models/lnd/clm/src/biogeochem/DGVMEcosystemDynMod.F90
M      models/lnd/clm/src/biogeochem/CNBalanceCheckMod.F90
M      models/lnd/clm/src/biogeochem/CNNStateUpdate3Mod.F90
M      models/lnd/clm/src/biogeochem/CNFireMod.F90
M      models/lnd/clm/src/biogeochem/CNMRespMod.F90
M      models/lnd/clm/src/biogeochem/CASAMod.F90
M      models/lnd/clm/src/biogeochem/CNPrecisionControlMod.F90
M      models/lnd/clm/src/biogeochem/CNSummaryMod.F90
M      models/lnd/clm/src/biogeochem/DUSTMod.F90
M      models/lnd/clm/src/biogeochem/CNPhenologyMod.F90
M      models/lnd/clm/src/biogeochem/CNCStateUpdate1Mod.F90
M      models/lnd/clm/src/biogeochem/CNDecompMod.F90
M      models/lnd/clm/src/biogeochem/STATICEcosysDynMod.F90
M      models/lnd/clm/src/biogeochem/CNCStateUpdate3Mod.F90
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate1Mod.F90
M      models/lnd/clm/src/biogeochem/DGVMMod.F90
M      models/lnd/clm/src/biogeochem/CNrestMod.F90
M      models/lnd/clm/src/biogeochem/CNC13StateUpdate3Mod.F90
M      models/lnd/clm/src/biogeochem/CNAnnualUpdateMod.F90
M      models/lnd/clm/src/biogeochem/CNNStateUpdate2Mod.F90
M      models/lnd/clm/src/biogeochem/C13SummaryMod.F90
M      models/lnd/clm/src/biogeochem/CNNDynamicsMod.F90
M      models/lnd/clm/src/biogeochem/CNAllocationMod.F90
M      models/lnd/clm/src/biogeochem/CNC13FluxMod.F90
M      models/lnd/clm/src/biogeochem/CNSetValueMod.F90
M      models/lnd/clm/src/biogeochem/CNVegStructUpdateMod.F90
M      models/lnd/clm/src/main/inicFileMod.F90
M      models/lnd/clm/src/main/clm_varcon.F90
M      models/lnd/clm/src/main/clm_varpar.F90
M      models/lnd/clm/src/main/CNiniTimeVar.F90
M      models/lnd/clm/src/main/clm_comp.F90
M      models/lnd/clm/src/main/driver.F90
M      models/lnd/clm/src/main/ncdio.F90
M      models/lnd/clm/src/main/fileutils.F90
M      models/lnd/clm/src/main/clmtypeInitMod.F90
M      models/lnd/clm/src/main/pftdynMod.F90
M      models/lnd/clm/src/main/iniTimeConst.F90
M      models/lnd/clm/src/main/histFileMod.F90
M      models/lnd/clm/src/main/clm_atmlnd.F90
M      models/lnd/clm/src/main/restFileMod.F90
M      models/lnd/clm/src/main/controlMod.F90
M      models/lnd/clm/src/main/initSurfAlbMod.F90
M      models/lnd/clm/src/main/clm_time_manager.F90
M      models/lnd/clm/src/main/filterMod.F90
M      models/lnd/clm/src/main/clm_varctl.F90
M      models/lnd/clm/src/main/lnd_comp_mct.F90
M      models/lnd/clm/src/main/CASAiniTimeVarMod.F90
M      models/lnd/clm/src/main/areaMod.F90
M      models/lnd/clm/src/main/clmtype.F90
M      models/lnd/clm/src/main/histFldsMod.F90
M      models/lnd/clm/src/main/mkarbinitMod.F90
M      models/lnd/clm/src/riverroute/RtmMod.F90
M      models/lnd/clm/src/biogeophys/SurfaceRadiationMod.F90
M      models/lnd/clm/src/biogeophys/BalanceCheckMod.F90
M      models/lnd/clm/src/biogeophys/SoilTemperatureMod.F90
M      models/lnd/clm/src/biogeophys/UrbanInputMod.F90
M      models/lnd/clm/src/biogeophys/SnowHydrologyMod.F90
M      models/lnd/clm/src/biogeophys/Biogeophysics1Mod.F90
M      models/lnd/clm/src/biogeophys/Biogeophysics2Mod.F90
M      models/lnd/clm/src/biogeophys/FrictionVelocityMod.F90
M      models/lnd/clm/src/biogeophys/SurfaceAlbedoMod.F90
M      models/lnd/clm/src/biogeophys/Hydrology1Mod.F90
M      models/lnd/clm/src/biogeophys/Hydrology2Mod.F90
M      models/lnd/clm/src/biogeophys/BiogeophysicsLakeMod.F90
M      models/lnd/clm/src/biogeophys/BiogeophysRestMod.F90
M      models/lnd/clm/src/biogeophys/SoilHydrologyMod.F90
M      models/lnd/clm/src/biogeophys/UrbanMod.F90
M      models/lnd/clm/src/biogeophys/DriverInitMod.F90
M      models/lnd/clm/src/biogeophys/BareGroundFluxesMod.F90
M      models/lnd/clm/src/biogeophys/CanopyFluxesMod.F90

>>>>>>>>>>>>>>>>>>>>>>>>> update documentation
M      README -------------- update information
M      KnownBugs ----------- add info on new known bugs

Summary of testing:

  bluefire: All PASS except TBL and ...

031 smF96 TSM.sh 17p_vodsrsc_m clm_std 19981231:NONE:1800 4x5 gx3v5 48 arb_ic ...................FAIL! rc= 10
036 smF96 TSM.sh 17p_vodsrsc_m clm_std 19981231:NONE:1800 4x5 gx3v5 48 arb_ic ...................FAIL! rc= 2
013 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
015 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
019 blNB4 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
020 smC61 TSM.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 -6 arb_ic ...............FAIL! rc= 10
021 erC61 TER.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 10+38 arb_ic ............FAIL! rc= 5
022 brC61 TBR.sh _sc_dh clm_urb^nl_urb_br 19981001:NONE:1800 1.9x2.5 gx1v5 -3+-3 arb_ic .........FAIL! rc= 5
023 blC61 TBL.sh _sc_dh clm_urb^nl_urb 19981001:NONE:1800 1.9x2.5 gx1v5 48 arb_ic ...............FAIL! rc= 4
024 smH91 TSM.sh 17p_cnnsc_dh clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 96 startup ..........FAIL! rc= 10
025 erH91 TER.sh 17p_cnnsc_dh clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 10+38 startup .......FAIL! rc= 5
026 brH91 TBR.sh 17p_cnnsc_dh clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 72+72 startup .......FAIL! rc= 5
027 blH91 TBL.sh 17p_cnnsc_dh clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 48 startup ..........FAIL! rc= 4
029 erH52 TER.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic ...........FAIL! rc= 13
030 brH52 TBR.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic ...........FAIL! rc= 11
031 blH52 TBL.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..............FAIL! rc= 7

  lightning/pathscale: all PASS except TBL and ...

009 blCA4 TBL.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
013 blCA8 TBL.sh _sc_ds clm_urb^nl_urb 19971230:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
017 blOC4 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 5
019 erA91 TER.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 7
020 brA91 TBR.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -3+-3 arb_ic .......................FAIL! rc= 6
021 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -6 arb_ic ..........................FAIL! rc= 5
027 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 7
028 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 6
029 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 5
031 smH52 TSM.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..............FAIL! rc= 10
032 erH52 TER.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic ...........FAIL! rc= 5
033 brH52 TBR.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic ...........FAIL! rc= 5
034 blH52 TBL.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 48 arb_ic ..............FAIL! rc= 4
036 erK51 TER.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 7
037 brK51 TBR.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 72+72 arb_ic ...............FAIL! rc= 6
001 smL51 TSM.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 96 arb_ic .........................FAIL! rc= 10
002 erL51 TER.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ......................FAIL! rc= 5
003 brL51 TBR.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ......................FAIL! rc= 5
004 blL51 TBL.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 48 arb_ic .........................FAIL! rc= 4
005 sm674 TSMtools.sh mkgriddata tools__ds singlept .............................................FAIL! rc= 6
006 sm774 TSMtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 6
007 bl774 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 4
010 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
011 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
012 erP91 TSM_ccsmseq.sh ERS f45_g35 ICN4804Q ...................................................FAIL! rc= 4

  jaguar: ALL PASS except TBL and ....

001 smA74 TSM.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 10
002 erA74 TER.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -5+-5 arb_ic .................FAIL! rc= 5
003 brA74 TBR.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -5+-5 arb_ic .................FAIL! rc= 5
013 smE32 TSM.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 64x128^360x720 USGS 48 arb_ic .........FAIL! rc= 10
014 erE32 TER.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 64x128^360x720 USGS 10+38 arb_ic ......FAIL! rc= 5
015 brE32 TBR.sh 4p_vodsrsc_dm clm_std 19981231:NONE:3600 64x128^360x720 USGS 24+24 arb_ic ......FAIL! rc= 5
017 smG43 TSM.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
018 erG43 TER.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 10+38 arb_ic ................FAIL! rc= 5
019 brG43 TBR.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
021 smH92 TSM.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 96 startup ..........FAIL! rc= 10
022 erH92 TER.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 10+38 startup .......FAIL! rc= 5
023 brH92 TBR.sh 17p_cnnsc_dm clm_ndepdyn 19980101:NONE:1800 4x5 gx3v5@1890 72+72 startup .......FAIL! rc= 5
029 smJ05 TSM.sh 4p_casasc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5 48 startup ....FAIL! rc= 10
030 smJ74 TSM.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -1100 arb_ic ........FAIL! rc= 10
031 erJ74 TER.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -10+-10 arb_ic ......FAIL! rc= 5
032 brJ74 TBR.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -3+-3 arb_ic ........FAIL! rc= 5
038 smL62 TSM.sh _sc_m clm_std 19980101:NONE:1800 1.9x2.5 gx1v5 -10 startup .....................FAIL! rc= 10
039 erL62 TER.sh _sc_m clm_std 19980101:NONE:1800 1.9x2.5 gx1v5 -5+-5 startup ...................FAIL! rc= 5
040 brL62 TBR.sh _sc_m clm_std 19980101:NONE:1800 1.9x2.5 gx1v5 -10+-10 startup .................FAIL! rc= 5

  breeze/gale/hail/gust/ifort: All PASS except TBL and...

  bangkok: All PASS except TBL and..

005 smA74 TSM.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 10
006 erA74 TER.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -5+-5 arb_ic .................FAIL! rc= 5
007 brA74 TBR.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -5+-5 arb_ic .................FAIL! rc= 5
009 smD91 TSM.sh _persc_dh clm_per 19981231:NONE:1200 4x5 gx3v5 144 startup .....................FAIL! rc= 10
010 erD91 TER.sh _persc_dh clm_per 19981231:NONE:1200 4x5 gx3v5 72+72 startup ...................FAIL! rc= 5
013 smCA4 TSM.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 10
014 erCA4 TER.sh _sc_ds clm_urb^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -45+-45 arb_ic ......FAIL! rc= 5
015 brCA4 TBR.sh _sc_ds clm_urb^nl_urb_br 19981001:NONE:3600 1x1_camdenNJ navy -10+-10 arb_ic ...FAIL! rc= 5
017 smOC4 TSM.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 10
018 erOC4 TER.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 115+115 arb_icFAIL! rc= 5
019 brOC4 TBR.sh _vansc_ds clm_urb1pt^nl_urb_br 19920812:NONE:3600 1x1_vancouverCAN navy 72+72 arb_iFAIL! rc= 5
021 smNB4 TSM.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 10
022 erNB4 TER.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 59+100 arb_icFAIL! rc= 5
023 brNB4 TBR.sh _mexsc_ds clm_urb1pt^nl_urb_br 19931201:NONE:3600 1x1_mexicocityMEX navy 72+72 arb_FAIL! rc= 5
025 smG42 TSM.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
026 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
027 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
029 smG46 TSM.sh 17p_sc_m clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
030 smH52 TSM.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 96 arb_ic ..............FAIL! rc= 10
031 erH52 TER.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 10+38 arb_ic ...........FAIL! rc= 5
032 brH52 TBR.sh 17p_cnnsc_dm clm_std 19980115:NONE:1800 10x15 USGS@1890 72+72 arb_ic ...........FAIL! rc= 5
038 smK51 TSM.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 96 arb_ic ..................FAIL! rc= 10
039 erK51 TER.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 10+38 arb_ic ...............FAIL! rc= 5
040 brK51 TBR.sh 10p_dgvmsc_dh clm_std 19981230:NONE:1800 10x15 USGS 72+72 arb_ic ...............FAIL! rc= 5
042 smL51 TSM.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 96 arb_ic .........................FAIL! rc= 10
043 erL51 TER.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 10+38 arb_ic ......................FAIL! rc= 5
044 brL51 TBR.sh _sc_dh clm_std 19980115:NONE:1800 10x15 USGS 72+72 arb_ic ......................FAIL! rc= 5
046 smL58 TSM.sh _sc_dh clm_std^nl_crcrop 19980115:NONE:1800 10x15 USGS 96 arb_ic ...............FAIL! rc= 10
047 smL74 TSM.sh _sc_s clm_std 19980101:NONE:1800 1x1_brazil navy -10 arb_ic ....................FAIL! rc= 10
048 erL74 TER.sh _sc_s clm_std 19980101:NONE:1800 1x1_brazil navy -5+-5 arb_ic ..................FAIL! rc= 5
049 brL74 TBR.sh _sc_s clm_std 19980101:NONE:1800 1x1_brazil navy -10+-10 arb_ic ................FAIL! rc= 5
051 sm654 TSMtools.sh mkgriddata tools__ds namelist .............................................FAIL! rc= 6
052 sm853 TSMtools.sh interpinic tools__o runoptions ............................................FAIL! rc= 6
053 sm854 TSMtools.sh interpinic tools__ds runoptions ...........................................FAIL! rc= 6
057 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
Changes answers relative to baseline: Yes! Changes climate

  Summarize any changes to answers:
    - what code configurations: All
    - what platforms/compilers: All
    - nature of change (new climate)
   - configuration (CPP ifdefs): All
   - build-namelist command (or complete namelist):

   MSS location of control simulations used to validate new climate: 

      Grass optical properties: /OLESON/csm/clm36sci16_clm3_6_11shklit0_5sfc_goa

      ccsm4_0_beta05:   /CCSM/csm/b40.018
   
   URL for LMWG diagnostics output used to validate new climate: 

ccsm4_0_beta05 (with clm36sci27_clm3_6_14)

http://www.cgd.ucar.edu/cdp/mai/ccsmweb/b40.018-b40.017/setsIndex.html

http://www.cgd.ucar.edu/tss/clm/diagnostics/clm4.0_dev/clm36sci16_clm3_6_11shklit0_5sfc_goa-clm36sci16_clm3_6_11shklit0_5sfca/setsIndex.html

===============================================================
===============================================================
Tag name:  clm3_6_14
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Fri Oct 10 11:32:57 MDT 2008
One-line Summary: Fix some global urban issues, fix pftdyn, really get compile-only option working in testing

Purpose of changes: Fix column and pft averaging for urban (crtical for coupling to cam) (from Keith)
                    Fix Qanth (was wasteheat previously) (from Keith)
                    Fix so that pftdyn works (fix from Sam)
                    Really get the compile-only option working in test-suite 
                       (so that doesn't re-compile, but does re-run, when sent again)

Bugs fixed (include bugzilla ID): 826 (pftdyn)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 830 (missing C-LAMP mods)
                                  680 (t0 precip diff for seq-ccsm), 789 (pt sims slower than offline)
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  833 (bug with cam in ccsm4_0_alpha37), 722 (threading slow)
                                  832 (problem with cice bn in ccsm4_0_alpha37)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self, oleson, slevis (Sam provided pftdyn fix, and Keith provided urban fixes)

List any svn externals directories updated (csm_share, mct, etc.): scripts and drv

  scripts to scripts4_081009
  drv     to drvseq2_0_33

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>> Change so that pftdyn will work, do urban averaging, and fix Qanth
   M   models/lnd/clm/src/main/clm_atmlnd.F90 -------------- Make averaging take into account urban (critical for global urban modeling)
   M   models/lnd/clm/src/main/histFldsMod.F90 ------------- Add urban scaling, fix Qanth
   M   models/lnd/clm/src/main/filterMod.F90 --------------- Change urban filter to include pftwgt>0
   M   models/lnd/clm/src/biogeophys/SurfaceAlbedoMod.F90 -- Change filter_vegsol to include pftwgt>0
>>>>>>>>>>> Fix so that compile-only option leaves compiled program there, doesn't recompile, but does rerun
   M   models/lnd/clm/test/system/TCB.sh
   M   models/lnd/clm/test/system/TSMncl_tools.sh
   M   models/lnd/clm/test/system/TBL.sh
   M   models/lnd/clm/test/system/TSM_ccsmseq.sh
   M   models/lnd/clm/test/system/TSMext_ccsmseq_cam.sh
   M   models/lnd/clm/test/system/TBR.sh
   M   models/lnd/clm/test/system/TCBtools.sh
   M   models/lnd/clm/test/system/test_driver.sh
   M   models/lnd/clm/test/system/TER.sh
   M   models/lnd/clm/test/system/TCT_ccsmseq.sh
   M   models/lnd/clm/test/system/TSMpergro.sh
   M   models/lnd/clm/test/system/TSMcnspinup.sh
   M   models/lnd/clm/test/system/TSMtools.sh
   M   models/lnd/clm/test/system/TSMruncase.sh
   M   models/lnd/clm/test/system/TCBext_ccsmseq_cam.sh
   M   models/lnd/clm/test/system/CLM_runcmnd.sh
   M   models/lnd/clm/test/system/TSM.sh

Summary of testing:

  bluefire: All PASS except
071 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  jaguar: All PASS
  bangkok/lf95: All PASS except
028 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 5
054 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dh ext_ccsm_seq_cam 48 .......................FAIL! rc= 6
055 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  breeze/gale/hail/gust/ifort: All PASS

pftdyn TBL test fails, because pftdyn did not work in previous tag. 
cam and scam tests fail because of bugs 832 and 833 in ccsm4_0_alpha37

CLM tag used for the baseline comparison tests if applicable: clm3_6_13

Changes answers relative to baseline: No -- bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_13
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Wed Oct  1 13:33:36 MDT 2008
One-line Summary: Update to new version of cpl7 scripts and build, update externals for versions needed for clm36sci branch, add new CASA tests

Purpose of changes:  Update to new version of cpl7 scripts and build. 
                     Update externals for versions needed on clm36sci branch.
                     Add new CASA tests.
                     Add $CLM_ACCOUNT as option to test_driver.sh
                     Add single point capability to cpl7 scripts.
                     Add CLM_DEMAND, CLM_BLD_NL_OPTIONS as options to cpl7 scripts.
                     Some code changes from Keith Oleson to fix a CASA startup problem.

Code changes from Keith Oleson

1. Volumetric soil water check in BiogeophysRestMod changed so that it accounts for ponded ice/water
that may be present in surface layer. If volumetric soil water is above saturation, h2osoi_liq
and h2osoi_ice are reduced according to their proportion of total water/ice.  Both h2osoi_liq
and h2osoi_ice are limited to be no lower than watmin (currently 0.01_r8 mm).  All this done for
soil points only.

2. In SoilHydrologyMod, variable su changed to:

    su        = max(0._r8,(s1-fcov(c)) / max(0.01_r8,1._r8-fcov(c))

to account for the fact that fcov could be one and hence divide by zero could have occurred.
Also, the factor "1._r8" multiplying fcov in the numerator was removed.

3. watmin made a global parameter available from clm_varcon

Bugs fixed (include bugzilla ID): 805 (too much output in build-streams), 801 (G95 in csm_Share),
                                  786 (dshr_map bug), 834 (CASA startup bug), 

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 
                                  680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  826 (pftdyn), 833 (bug with cam in ccsm4_0_alpha37)
                                  832 (problem with cice bn in ccsm4_0_alpha37)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: Update to new ccsm4_0_alpha37 scripts

	New options in cpl7 scripts: CLM_DEMAND, CLM_BLD_NL_OPTIONS

              CLM_DEMAND: List of output variables to require be set in namelist
                          For example, set to "furbinp" to use urban grid.
              CLM_BLD_NL_OPTIONS: List of options to pass to clm build-namelist.

        New grid in cpl7 scripts: pt1_pt1 (also set CLM_PT1_NAME) for single point sims

        Add ability to set "none" in clm build-namelist -clm_dmand option.

Quickstart to new cpl7 scripts...

     New cpl7 namelists now do two things for you.
         - Add a ton of error checking at each step -- so it won't let you do something you  aren't allowed to
         - Only show you the variables that you could actually set in your case.

     To accomplish this we use XML files rather than cshell env files. But, the
     operation sequence is similar with options only changed slightly.

         cd scripts
         ./create_newcase -help      # get help on how to run create_newcase
         ./create_newcase -case testI -mach bluefire -res f19_g15 -compset I    # create new "I" case for bluefire at 1.9x2.5_gx1v5 res
                                     # "I" case is clm active, datm7, and inactive ice/ocn
         cd testI
         ./xmlchange -help           # Get help on editor for XML files 
         ./xmlchange <options> env_conf.xml env_mach_pes  # Edit configure files if needed
         configure -case             # create scripts
         ./xmlchange <options> env_build.xml              # Edit build files if needed
         testI.build                 # build model and create namelists
         ./xmlchange <options> env_run.xml                # Edit run files if needed
         bsub < testI.run            # submit script  
                                     # (NOTE: edit env_run.xml to set RESUBMIT to number of times to automatically resubmit)

     Note that the -skip_rundb option to create_newcase no longer needs the argument of "NONE".
     Syntax of create_tests changed to only one form.

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: erik, oleson and dlawren (source code changes)

List any svn externals directories updated (csm_share, mct, etc.): drv, csm_share, datm7, and scripts

  csm_share, datm7 and scripts include changes required for the clm36sci branch.

     scripts   to scripts4_080930
     drv       to drvseq2_0_32
     datm7     to datm7_080926
     csm_share to share3_080929

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

>>>>>>>>> Add $CLM_ACCOUNT env var, change tests around, update to ccsm4_0_alpha37
          add some more CASA tests.
M  models/lnd/clm/test/system/README
M  models/lnd/clm/test/system/tests_pretag_bluefire
M  models/lnd/clm/test/system/tests_pretag_jaguar
M  models/lnd/clm/test/system/tests_posttag_kraken
M  models/lnd/clm/test/system/tests_posttag_hybrid_regression
M  models/lnd/clm/test/system/tests_posttag_purempi_regression
M  models/lnd/clm/test/system/test_driver.sh ------------------ Add $CLM_ACCOUNT env var
                                                                update to ccsm4_0_alpha37
M  models/lnd/clm/test/system/input_tests_master -------------- Add CASA 1.9x2.5 tests
M  models/lnd/clm/test/system/TSMext_ccsmseq_cam.sh ----------- Separate call to cice bn
M  models/lnd/clm/test/system/TCT_ccsmseq.sh
M  models/lnd/clm/test/system/TCBext_ccsmseq_cam.sh ----------- Need to set threads/tasks
M  models/lnd/clm/test/system/TSM.sh -------------------------- Remove old namelist name

>>>>>>>>>>>>>> Update for new scripts
M  models/lnd/clm/bld/clm.cpl7.template ----------------------- Straighten out clm_demand
                               Add new env vars. Remove prestaging.
M  models/lnd/clm/bld/namelist_files/namelist_definition.xml -- Update to alpha37
M  models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml- Add file for clm36sci branch
M  models/lnd/clm/bld/build-namelist -------------------------- Allow clm_demand to include none.

>>>>>>>>>>>>>> These are Keith's changes to fix bug 834. They do make it possible for
               answers to change, but in most cases they don't. It allows code to
               startup correctly for situations it might fail in, and sets a mininum
               value in SoilHydrologyMod to guard against divide by zero. This would
               change answers when amount of ice -- fcov > 0.99 -- which would be rare.
M  models/lnd/clm/src/main/clm_varcon.F90
M  models/lnd/clm/src/biogeophys/BiogeophysRestMod.F90
M  models/lnd/clm/src/biogeophys/SoilHydrologyMod.F90

Summary of testing:

  bluefire: All PASS except
042 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
043 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
044 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
045 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
P
046 smG45 TSM.sh 17p_sc_h clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
079 blL61 TBL.sh _sc_h clm_std 19980101:NONE:1800 1.9x2.5 gx1v5 -10 startup .....................FAIL! rc= 7
083 blL62 TBL.sh _sc_m clm_std 19980101:NONE:1800 1.9x2.5 gx1v5 -10 startup .....................FAIL! rc= 7
107 brJ74 TBR.sh 4p_casasc_ds clm_std 10001230:NONE:3600 1x1_tropicAtl test -3+-3 arb_ic ........FAIL! rc= 11
127 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  kraken: All PASS except all TER and TBR tests fail, because of a script problem and ends early
  lightning/pathscale: All PASS except
022 smG42 TSM.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
023 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
024 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
025 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
026 smG46 TSM.sh 17p_sc_m clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
050 erP11 TSM_ccsmseq.sh ERS T31_g35 ICN4804 ....................................................FAIL! rc= 5
  bangkok/lf95: All PASS except
025 smG42 TSM.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
026 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
027 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
028 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 4
029 smG46 TSM.sh 17p_sc_m clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
054 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dh ext_ccsm_seq_cam 48 .......................FAIL! rc= 6
055 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  breeze/gale/hail/gust/ifort: All PASS

pftdyn tests fail because of previous problem (bug 826). ext_ccsmseq_ tests fail 
because of problem with ccsm4_0_alpha37 (bug 833).

CLM tag used for the baseline comparison tests if applicable: clm3_6_12

Changes answers relative to baseline: Only for some cases, see tests 079 and 083 on
bluefire above

===============================================================
===============================================================
Tag name:  clm3_6_12
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Sun Sep 21 10:04:22 MDT 2008
One-line Summary: Fix restarts for urban, add capability to do global urban experiments, add new forcing height changes, remove cpl6

Purpose of changes: Fix restarts for urban model as well as adding capability to do global urban experiments.
                    It also adds the new forcing height changes into the trunk.
                    And we remove all the cpl6 #ifdef's, source codes, and associated scripts and script options.
                    Also fix some memory leaks found in MCT.
                    Add testing for kraken.
                    Fix branch tests so they change the start_ymd.
                    Add some more tests for CASA.
                    Set minimum urban percentage to use from 5% to 1%.
                    Completely remove COUP_CAM #ifdef as NOT needed anymore.

Bugs fixed (include bugzilla ID):  Fix urban model restarts, remove cpl6 (755), MCT memory leak (825)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 
                                  680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  805 (too much output in build-streams), 826 (pftdyn)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: Add nofire option to configure, remove cpl6 option

Describe any changes made to the namelist: Add new urban oriented output history variables:

   _U, and _R (Urban and Rural) for:
        QRUNOFF, TREFMXAV, TREFMNAV, TSA, SoilAlpha, TG, Q2M, TREFAV
   URBAN_AC, and URBAN_HEAT, Qanth, SWup, LWup, QTau, HWR, Wind, Qair
   and  ZBOT_PFT for forcing height

   Change build-namelist so that to use a dataset with urban points on it you 
   need to use "-clm_demand furbinp". This way it will not only select the appropriate
   furbinp dataset -- but it will select the correct surface dataset that includes
   urban data on it.  Such as for 10x15 and 1.9x2.5 surface datasets where there is
   now an urban version as well as the standard version.
  

List any changes to the defaults for the boundary datasets: Add urbanc point dataset, 
     and 1.9x2.5 and 10x15 urban datasets

Describe any substantial timing or memory changes: None

Code reviewed by: self (some changes by Keith Oleson)

List any svn externals directories updated (csm_share, mct, etc.): drv, datm7, mct

  drv   to drvseq3_0_26
  datm7 to datm7_080907
  mct   to MCT2_5_1_080522

List all files eliminated: Remove cpl6 files

R      models/lnd/clm/test/system/TCText_ccsmcon.sh
R      models/lnd/clm/test/system/TSMext_ccsmcon.sh
R      models/lnd/clm/bld/clm.cpl6.template
R      models/lnd/clm/src/main/program_csm.F90
R      models/lnd/clm/src/main/clm_csmMod.F90

List all files added and what they do:

A      models/lnd/clm/test/system/config_files/4p_casasc_ds ----- Add serial test for CASA
A      models/lnd/clm/test/system/nl_files/clm_urb -------------- For standard urban tests.
A      models/lnd/clm/test/system/nl_files/nl_urb_br ------------ Urban namelist for branch tests.
A      models/lnd/clm/test/system/tests_posttag_kraken ---------- Add tests for kraken
A      models/lnd/clm/tools/ncl_scripts/generate_ascii_avg_fv1_9x2_5_urbanparam_file_p7.ncl -- script to create furbinp dataset
A      models/lnd/clm/tools/mksurfdata/mksurfdata.globalurban --- Example namelist to make a global urban surface dataset
A      models/lnd/clm/bld/urban_input/urbanc_alpha_fluxes.txt --- Add urban intercomparison test case

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>> Remove cpl6 option, add nofire, make urban point datasets consistent with global Feddema datasets
M      models/lnd/clm/bld/configure -------------------------------- Remove cpl6 option, add nofire option
M      models/lnd/clm/bld/queryDefaultNamelist.pl ------------------ Add -filenameonly option
M      models/lnd/clm/bld/urban_input/metropolis_fluxes.txt
M      models/lnd/clm/bld/urban_input/urbanc_alpha_fluxes.txt
M      models/lnd/clm/bld/urban_input/asphaltjungle_fluxes.txt
M      models/lnd/clm/bld/urban_input/mexicocityMEX_fluxes.txt
M      models/lnd/clm/bld/urban_input/vancouverCAN_fluxes.txt
M      models/lnd/clm/bld/config_files/config_definition.xml
M      models/lnd/clm/bld/namelist_files/namelist_definition.xml
M      models/lnd/clm/bld/namelist_files/datm.streams.template.xml
M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml
M      models/lnd/clm/bld/build-namelist --------------------------- Have urban surface datasets dependent on furbinp

M      models/lnd/clm/test/system/README.testnames
M      models/lnd/clm/test/system/tests_posttag_urban
M      models/lnd/clm/test/system/tests_pretag_jaguar
M      models/lnd/clm/test/system/tests_pretag_bluefire
M      models/lnd/clm/test/system/tests_posttag_purempi_regression
M      models/lnd/clm/test/system/tests_posttag_hybrid_regression
M      models/lnd/clm/test/system/tests_pretag_bluevista
M      models/lnd/clm/test/system/tests_posttag_lightning
M      models/lnd/clm/test/system/nl_files/clm_urb1pt
M      models/lnd/clm/test/system/input_tests_master
M      models/lnd/clm/test/system/README
M      models/lnd/clm/test/system/CLM_runcmnd.sh
M      models/lnd/clm/test/system/TBR.sh ---------------------- Change so start_ymd of branch runs is initial-length after original start-date
M      models/lnd/clm/test/system/test_driver.sh -------------- Reduce from premium to regular, add kraken
M      models/lnd/clm/test/system/mknamelist ------------------ Set hist_* values for second file
M      models/lnd/clm/test/system/nl_files/nl_crcrop ---------- Set hist_dens for second file
M      models/lnd/clm/test/system/nl_files/nl_urb ------------- Set hist_dens for second file, add more fields to list
M      models/lnd/clm/test/system/nl_files/nl_std ------------- Set hist_dens for second file
M      models/lnd/clm/test/system/nl_files/nl_lfiles ---------- Set hist_dens for second file
M      models/lnd/clm/test/system/input_tests_master ---------- Change TBR tests, add more CASA tests

M      models/lnd/clm/tools/mksurfdata/mkurban.F90 ------------ Change threshold to ignore urban from 5% to 1%

M      models/lnd/clm/src/biogeophys/FrictionVelocityMod.F90 -- For DUST fix forcing height appropriately
M      models/lnd/clm/src/biogeophys/UrbanMod.F90 ------------- Don't set pointers if no urban points

>>>>>>>>>>>>>>>> Remove COUP_CSM #ifdefs

M      models/lnd/clm/src/main/driver.F90 --------- Also make sure urban calls have urban points
M      models/lnd/clm/src/main/accFldsMod.F90
M      models/lnd/clm/src/main/clmtypeInitMod.F90
M      models/lnd/clm/src/main/initializeMod.F90
M      models/lnd/clm/src/main/iniTimeConst.F90
M      models/lnd/clm/src/main/histFileMod.F90
M      models/lnd/clm/src/main/restFileMod.F90
M      models/lnd/clm/src/main/controlMod.F90
M      models/lnd/clm/src/main/initSurfAlbMod.F90
M      models/lnd/clm/src/main/clm_time_manager.F90
M      models/lnd/clm/src/main/clm_varctl.F90
M      models/lnd/clm/src/main/subgridAveMod.F90
M      models/lnd/clm/src/main/initGridCellsMod.F90
M      models/lnd/clm/src/main/spmdMod.F90
M      models/lnd/clm/src/main/surfrdMod.F90 ------------- Also remove COUP_CAM #ifdef
M      models/lnd/clm/src/main/do_close_dispose.F90
M      models/lnd/clm/src/main/clmtype.F90 --------------- Also forcing height changes
M      models/lnd/clm/src/main/histFldsMod.F90
M      models/lnd/clm/src/main/mkarbinitMod.F90
M      models/lnd/clm/src/biogeophys/BalanceCheckMod.F90
M      models/lnd/clm/src/biogeophys/SoilTemperatureMod.F90
M      models/lnd/clm/src/biogeophys/UrbanInputMod.F90
M      models/lnd/clm/src/biogeophys/Biogeophysics1Mod.F90 ------ Also forcing height changes
M      models/lnd/clm/src/biogeophys/Biogeophysics2Mod.F90
M      models/lnd/clm/src/biogeophys/UrbanInitMod.F90
M      models/lnd/clm/src/biogeophys/Hydrology2Mod.F90
M      models/lnd/clm/src/biogeophys/BiogeophysicsLakeMod.F90 ------ Also forcing height changes
M      models/lnd/clm/src/biogeophys/BiogeophysRestMod.F90 --------- Fix restarts for urban
M      models/lnd/clm/src/biogeophys/HydrologyLakeMod.F90
M      models/lnd/clm/src/biogeophys/BareGroundFluxesMod.F90
M      models/lnd/clm/src/biogeophys/CanopyFluxesMod.F90

Summary of testing:

  bluefire: All PASS except TBL and
042 smG41 TSM.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
043 erG41 TER.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
044 brG41 TBR.sh 17p_sc_dh clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
046 smG45 TSM.sh 17p_sc_h clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
  jaguar: All PASS except TBL and
019 brG43 TBR.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
  kraken: All PASS except TBL and TER and TBR (this may be a setup problem) and
017 smG43 TSM.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
  lightning/pathscale: All PASS except TBL and
  bangkok/lf95: All PASS except TBL and
025 smG42 TSM.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ..................FAIL! rc= 10
026 erG42 TER.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
027 brG42 TBR.sh 17p_sc_dm clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic ................FAIL! rc= 5
029 smG46 TSM.sh 17p_sc_m clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...................FAIL! rc= 10
  kraken: All PASS except TBL and
017 smG43 TSM.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 144 arb_ic ...........
.......FAIL! rc= 10
018 erG43 TER.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 10+38 arb_ic .........
.......FAIL! rc= 13
019 brG43 TBR.sh 17p_sc_do clm_pftdyn 10001230:NONE:1800 10x15 USGS 72+72 arb_ic .........
.......FAIL! rc= 5
  breeze/gale/hail/gust/ifort: All PASS

   pftdyn tests fail on all platforms -- due to a previous problem that was not 
detected because of a bug in the test.
   TER and TBR tests fail on kraken -- this may be a setup problem. Possibily a problem
with newcprnc? I'm not sure but since it passes elsewhere, I don't think it's a problem
in the code.

CLM tag used for the baseline comparison tests if applicable: clm3_6_11

Changes answers relative to baseline: Forcing height changes cause answers to change

===============================================================
===============================================================
Tag name:  clm3_6_11
Originator(s):  dlawren (Lawrence David 1384 CGD)
Date: Tue Aug 26 21:53:22 MDT 2008
One-line Summary: Ice stream for snow capped regions

Purpose of changes: Split liquid and ice runoff streams in snow capped situations

Bugs fixed (include bugzilla ID):  None

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 
                                  680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  805 (too much output in build-streams)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: Update version of pft-physiology file used

Describe any substantial timing or memory changes: None

Code reviewed by: erik

List any svn externals directories updated (csm_share, mct, etc.): scripts and csm_share

   scripts    to scripts4_080731
   csm_share  to share3_080801

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml --- Use the same pft-phisiology file for every option
M      models/lnd/clm/src/main/clmtypeInitMod.F90
M      models/lnd/clm/src/main/pft2colMod.F90
M      models/lnd/clm/src/main/clmtype.F90
M      models/lnd/clm/src/main/histFldsMod.F90
M      models/lnd/clm/src/main/models/lnd/clm/src/main/clm_time_manager.F90 -- Hack for fake Gregorian calendar
M      models/lnd/clm/src/riverroute/RtmMod.F90 --------------- two runoff sreams, liq and ice (qflx_snwcp_ice)
M      models/lnd/clm/src/biogeophys/Biogeophysics2Mod.F90 ---- dew snwcp
M      models/lnd/clm/src/biogeophys/Hydrology1Mod.F90 -------- snow and rain split for snwcp
M      models/lnd/clm/src/biogeophys/SoilHydrologyMod.F90 ----- liq snwcp 
M      models/lnd/clm/src/biogeophys/Hydrology2Mod.F90 -------- qrgwl minus snwcp_ice
M      models/lnd/clm/src/biogeophys/HydrologyLakeMod.F90 ----- lake snwcp
M      models/lnd/clm/src/biogeophys/BiogeophysicsLakeMod.F90 - initialize snwcp fields to zero for lakes
M      models/lnd/clm/src/biogeophys/BalanceCheckMod.F90 ------ revised balance check
      >>>>>>>>>> Get scam test working
M      models/lnd/clm/test/system/TSMext_ccsmseq_cam.sh
M      models/lnd/clm/test/system/nl_files/scam
M      models/lnd/clm/test/system/TSCext_ccsmseq_scam.sh
M      models/lnd/clm/test/system/config_files/scam_ds
M      models/lnd/clm/test/system/config_files/ext_ccsm_seq_64x128_s
M      models/lnd/clm/test/system/nl_files/scam
M      models/lnd/clm/test/system/nl_files/scam_prep

Summary of testing:

  bluefire: All PASS except TBL tests
  lightning/pathscale: All PASS except TBL tests
  bangkok/lf95: All PASS except TBL tests
  breeze/gale/hail/gust/ifort: All PASS

  Didn't test on jaguar -- since it was down.

CLM tag used for the baseline comparison tests if applicable: clm3_6_10

Changes answers relative to baseline: Yes -- pft-physiology file, RTM changes

===============================================================
===============================================================
Tag name:  clm3_6_10
Originator(s):  tcraig
Date: Fri Aug 15 09:05:50 MDT 2008
One-line Summary: extend rtm tracer, ascale for tri-grids, AIX O3 to O2

Purpose of changes: extend rtm to handle multiple tracers.  added
  second tracer to rtm associated with frozen water.  first tracer
  is now liquid water.  both are passed to cpl7 now via the roff and
  ioff fields.

  add ascale field to land model in support of model running on it's
  own grid.  ascale is a field provided by the coupler to the land model 
  via the driver "domain" datatype.  it is needed to correct fluxes
  in the land model for conservation.  it is being applied to the
  land to rtm fluxes and will need to be fully validated in a ccsm4
  tri-grid configuration which is still under development.

  change AIX optimization from -O3 to -O2 at request of LMWG.  not
  needed for these changes in particular.  see bug #812.

Bugs fixed (include bugzilla ID): 812

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 
                                  680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  805 (too much output in build-streams)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system:
  change AIX -O3 to -O2 at request of LMWG, incorporated
  into tag for convenience.

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:  
  added extra rtm tracer, should have no noticable impact on timing
  or memory.

Code reviewed by: tcraig

List any svn externals directories updated (csm_share, mct, etc.):

List all files eliminated: none

List all files added and what they do: none

List all existing files that have been modified, and describe the changes:

M      bld/config_files/Makefile.in
M      src/main/clmtypeInitMod.F90
M      src/main/pft2colMod.F90
M      src/main/clm_atmlnd.F90
M      src/main/clm_csmMod.F90
M      src/main/lnd_comp_mct.F90
M      src/main/domainMod.F90
M      src/main/clmtype.F90
M      src/main/histFldsMod.F90
M      src/riverroute/RtmMod.F90
M      src/riverroute/RunoffMod.F90
M      src/biogeophys/Biogeophysics2Mod.F90
M      src/biogeophys/Hydrology1Mod.F90
M      src/biogeophys/SoilHydrologyMod.F90

- change AIX -O3 to -O2
- add ascale implementation.  add asca field to domain datatype, set
  for atm and lnd domains.  default is 1.0.  received from coupler
  in first run call.  reset in lnd only if atm and lnd domain are same.
- split qflx_snowcap term into qflx_snowcap_rain and qflx_snowcap_snow.
  snowcap_rain term is same implementation as old snowcap term.
  snowcap_snow is set to zero now.  potential future mods are noted
  and commented out, search for tcx_snowcap_new in src code.
- implement multiple tracers extensibility in rtm.  add frozen
  runoff tracer in addition to liquid runoff tracer.
- set roff and ioff runoff terms in lnd_comp_mct to send back to coupler
- update rtm restart file, support backward compatability by setting
  runoff tracers to zero if the new fields are not on the restart file.
- update history file for new rtm tracers.  requires individual fields
  to be copied from tracer arrays to single field arrays for history
  interface.  
	
Summary of testing:

  bluefire: all PASS except
     073 blL61 TBL.sh _sc_h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup
     077 blL62 TBL.sh _sc_m clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup
     085 blL74 TBL.sh _sc_s clm_std 19980101:6-HOURLY:1800 1x1_brazil navy -10 arb_ic
     087 blL78 TBL.sh _sc_s clm_std 19971231:NONE:1800 1x1_brazil navy -10 arb_ic
       the above 4 bl cases FAIL due to -O3 to -O2 optimzation change
     113 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3
       sm984 fails due to inconsistent driver in test
  jaguar: all PASS except
     038 erP65 TSM_ccsmseq.sh ERS f19_g13 I
     039 erP15 TSM_ccsmseq.sh ERS T31_g35 ICN
     040 erP66 TSM_ccsmseq.sh ERH f19_g13 I
     041 erP16 TSM_ccsmseq.sh ERH T31_g35 ICN
     042 erP67 TSM_ccsmseq.sh ERB f19_g13 I
     043 erP17 TSM_ccsmseq.sh ERB T31_g35 ICN
       erP* tests fail due to script error
  bangkok/lf95: all PASS except
     046 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dh ext_ccsm_seq_cam 48
     047 sm984 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3
       sm952 and sm984 fail due to inconsistent driver in test
  breeze/gale/hail/gust/ifort: all PASS

  bluefire cam pretag: all PASS except previously documented failures
  bluefire ccsm4 pretag: all PASS except previously documented failures
    compare with alpha33 FAILS since rtm not bit-for-bit in some tests.

CLM tag used for the baseline comparison tests if applicable: clm3_6_09

Changes answers relative to baseline: 
  change of AIX -O3 to -O2 changes some results by what appears to be roundoff.
  change of rtm tracers introduces a roundoff change in some grid cells on bluefire,
     this might be caused by changes in compiler optimization associated with the
     extra rtm tracer dimension and extra rtm loop.  this can be seen only in 
     fully coupled ccsm4 tests with an active ocean model.

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: active rtm and ocean
    - what platforms/compilers: AIX + ? 
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	 roundoff

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?
         examination of differences in a CCSM4 f45_g35 B case.

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
===============================================================
Tag name:  clm3_6_09
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Mon Aug 11 10:55:23 MDT 2008
One-line Summary: Fix clm.cpl7.template to run hybrid and branch cases

Purpose of changes: Fix so cpl7 tests will work for hybrid and branch cases 
                    (needed for ccsm4 tag)

Bugs fixed (include bugzilla ID): 808 (bug for hybrid/branch)
                                  partially 805 (too much output in build-streams)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  805 (too much output in build-streams)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: cpl7.template fixed to work with branch/hybrid

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

  M models/lnd/clm/test/system/tests_pretag_bluefire --- Add branch/hybrid cpl7 tests
  M models/lnd/clm/test/system/TSM_ccsmseq.sh ---------- Include path in scripts call
  M models/lnd/clm/test/system/tests_pretag_jaguar ----- Add branch/hybrid cpl7 tests
  M models/lnd/clm/test/system/TSMext_ccsmcon.sh ------- Include path in scripts call
  M models/lnd/clm/test/system/test_driver.sh ---------- Add more tasks for jaguar
  M models/lnd/clm/test/system/input_tests_master ------ Add branch/hybrid cpl7 tests
  M models/lnd/clm/bld/clm.cpl7.template --------------- Fix so branch/hybrid works
  M models/lnd/clm/bld/build-namelist ------------------ Fix so branch/hybrid for cpl7 works

Summary of testing:

  bluefire: All PASS
  jaguar: All PASS
  lightning/pathscale: All PASS
  bangkok/lf95: All PASS
  breeze/gale/hail/gust/ifort: All PASS

CLM tag used for the baseline comparison tests if applicable: clm3_6_08

Changes answers relative to baseline: No bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_08
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Wed Aug  6 15:49:39 MDT 2008
One-line Summary: Fix bugs, and build changes for inputdata repo

Purpose of changes: Add in the changes needed for inputdata repo for ccsm, and add a couple small bug-fixes.

Bugs fixed (include bugzilla ID): 708 (xlf bug on bluevista), 781 (bluefire tests, iyear_ad and hourly change),
                                  780 (-defaults option in build-namelist)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  805 (too much output in build-streams), 808 (bug for hybrid/branch)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: Change iyear_ad to 1990, and correct inithist=6-HOURLY

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): scripts, drv, datm7, csm_share, esmf_wrf_timemgr

    +scripts          to scripts4_080731
    +drv              to drvseq2_0_25
    +datm7            to datm7_080731
    +csm_share        to share3_080801
    +esmf_wrf_timemgr to esmf_timemgr_080717

List all files eliminated: None

List all files added and what they do:

   A  models/lnd/clm/test/system/tests_pretag_bluefire ---- test list for bluefire
   A  models/lnd/clm/test/system/config_files/_persc_do --- pure OpenMP pergro test

List all existing files that have been modified, and describe the changes:

   M  models/lnd/clm/test/system/TBL.sh --------------------------- Add note about RMS changes to test log file
   M  models/lnd/clm/test/system/input_tests_master --------------- Fix 6-HOURLY in tests
   M  models/lnd/clm/bld/configure -------------------------------- Fix -defaults option
   M  models/lnd/clm/bld/config_files/Makefile.in ----------------- Start switching Darwin over to g95
   M  models/lnd/clm/bld/clm.cpl7.template ------------------------ Add inputdata_repo stuff
   M  models/lnd/clm/bld/namelist_files/namelist_definition.xml --- Correct inithist=6-HOURLY
   M  models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml - Change iyear_ad to 1990
   M  models/lnd/clm/bld/build-namelist --------------------------- Add inputdata_repo stuff

Summary of testing:

  bluefire: all PASS except TBL and...
015 blD91 TBL.sh _persc_dh clm_per 19981231:YEARLY:1200 4x5 gx3v5 144 arb_ic ....................FAIL! rc= 7
  bluevista: not ran
  jaguar: all PASS except TBL and
038 erP65 TSM_ccsmseq.sh ERS f19_g13 I ..........................................................FAIL! rc= 5
039 erP15 TSM_ccsmseq.sh ERS T31_g35 ICN ........................................................FAIL! rc= 5
  lightning/pathscale: all PASS except TBL
  bangkok/lf95: all PASS except TBL
  breeze/gale/hail/gust/ifort: all PASS except TBL

all PASS except for TBL changes because of the change in iyear_ad to 1990 (as in ccsm)

The test blD91 on bluefire failure is not clear to me -- it shows answers as changing when really shouldn't (this 
comparision didn't include the iyear_ad change).
erP65 and erP15 fail on jaguar because of a scripting issue. It may be because I ran "-c" first to compile everything first
before running. But, it couldn't find the *.build script which is strange. But, I was able to run it by hand fine.

CLM tag used for the baseline comparison tests if applicable: clm3_6_07

Changes answers relative to baseline: Bit-for-Bit (except for iyear_ad change to 1990)

===============================================================
===============================================================
Tag name:  clm3_6_07
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Tue Jul  8 21:50:34 MDT 2008
One-line Summary: Implement new build namelist system from Vertenstein/Eaton, add bluefire, and BGP support

Purpose of changes: Rework build-namelist system to use perl5lib/Build/namelist*.pm objects. This is from
                    Mariana V. and Brian E.
                    Provide namelist description and documentation.
                    Add support for testing and running on bluefire
                    Add support for building on BGP
                    Add -c option to test_driver.sh and add ability to test on breeze. Tweak tests a bit.
                    Change default orbital year in clm scripts from 2000 to 1990 (so same as for cpl6/cpl7)
                    Fix 6_HOURLY bug

Bugs fixed (include bugzilla ID): 769 (6_HOURLY to 6-HOURLY), 721 (add -c option to test_driver.sh)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time)
                                  805 (too much output in build-streams), 808 (bug for hybrid/branch)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: build-namelist and configure completely reworked with new underlying perl5lib objects

Describe any changes made to the namelist:  Just to the build-namelist creation

	NOTE: build-namelist now checks the validity of your namelist you generate by looking at data in the namelist_definition.xml
              file. In order to add new namelist items you need to change the code and also edit this file. To view information
              on the namelist view the file:

              models/lnd/clm/bld/namelist_files/namelist_definition.xml

              in your browser and you'll see the names, type, description and valid_values for all namelist variables.

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self (mvertens looked at original version)

List any svn externals directories updated (csm_share, mct, etc.): scripts and drv

   scripts4_080703 --- with bluefire support
   drvseq2_0_23

List all files eliminated: Remove old build system files. Many of these are renamed to files in new subdirectories

   R models/lnd/clm/bld/Makefile.in ------------------------ move to config_files/.
   R models/lnd/clm/bld/datm_in.pm
   R models/lnd/clm/bld/config_clm_defaults.xml ------------ move to config_files/config_defaults.xml
   R models/lnd/clm/bld/namelist.pm ------------------------ now in perl5lib/Build/namelist.pm
   R models/lnd/clm/bld/ExtSeqCCSMDrvInNamelistsDescriptions.xml
   R models/lnd/clm/bld/streams.txt.readme ----------------- move to namelist_files/.
   R models/lnd/clm/bld/DefaultDATM_NML_Namelist.xml ------- move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/bld/clm_inparm.pm
   R models/lnd/clm/bld/DefaultSettings.xml ---------------- move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/bld/datm_dshr_in.pm
   R models/lnd/clm/bld/datm_nml.pm
   R models/lnd/clm/bld/DefaultTIMEMGR_INPARM_Namelist.xml - move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/bld/system_defaults.xml ---------------- move to config_files/config_sys_defaults.xml
   R models/lnd/clm/bld/DefaultPROF_INPARM_Namelist.xml ---- move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/bld/sample.seqccsm.namelists ----------- Browsing on namelist_files/namelist_defaults_clm.xml does better job
   R models/lnd/clm/bld/timemgr_inparm.pm
   R models/lnd/clm/bld/prof_inparm.pm
   R models/lnd/clm/bld/DefaultCLM_INPARM_Namelist.xml ----- move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/bld/DefaultCCSM_INPARM_Namelist.xml ---- move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/bld/drv_in.pm
   R models/lnd/clm/bld/CCSMDrvInNamelistsDescriptions.xml
   R models/lnd/clm/bld/compnl.pm
   R models/lnd/clm/bld/SeqCCSM_namelist.pm
   R models/lnd/clm/bld/ccsm_inparm.pm
   R models/lnd/clm/bld/SeqCCSMDrvInNamelistsDescriptions.xml
   R models/lnd/clm/bld/datm.streams.template.xml ---------- move to namelist_files/.
   R models/lnd/clm/bld/DefaultDATM_DSHR_NML_Namelist.xml -- move to relevent part of namelist_files/namelist_defaults_clm.xml
   R models/lnd/clm/test/system/config_files/ext_ccsm_seq_10x15_dm - move from pure-mpi
                                                                     to hybrid (MPI/OpenMP)

List all files added and what they do:

   A models/lnd/clm/bld/config_files/Makefile.in
   A models/lnd/clm/bld/config_files/config_definition.xsl ------- how to view it's XML file nicely
   A models/lnd/clm/bld/config_files/config_sys_defaults.xml
   A models/lnd/clm/bld/config_files/config_defaults.xml
   A models/lnd/clm/bld/config_files/config_definition.xml ------- definition of configuration items
   A models/lnd/clm/bld/namelist_files/namelist_definition.xml
   A models/lnd/clm/bld/namelist_files/streams.txt.readme
   A models/lnd/clm/bld/namelist_files/namelist_definition.xsl --- how to view it's XML file nicely
   A models/lnd/clm/bld/namelist_files/use_cases/pergro.xml ------ pergro use case
   A models/lnd/clm/bld/namelist_files/use_cases/pergro0.xml ----- pergro0 use case
   A models/lnd/clm/bld/namelist_files/datm.streams.template.xml
   A models/lnd/clm/bld/namelist_files/namelist_defaults_clm.xml - definition of name, group, data-type, and valid values for namelists
   A models/lnd/clm/test/system/config_files/ext_ccsm_seq_10x15_dh -- change to hybrid

List all existing files that have been modified, and describe the changes:

           >>>>>>>>>>>>>>>>> Rework using perl5lib/Build/namelist*.pm objects
   M models/lnd/clm/bld/queryDefaultNamelist.pl
   M models/lnd/clm/bld/clm.cpl7.template
   M models/lnd/clm/bld/scpDefaultNamelist.pl
   M models/lnd/clm/bld/queryDefaultXML.pm
   M models/lnd/clm/bld/build-namelist
   M models/lnd/clm/bld/configure
   M models/lnd/clm/bld/run-ibm.csh -------------------- Add bluefire support to bind processors
            >>>>>>>>>>>>>>> Changes to get working on bluefire and use new configure/build-namelist
   M models/lnd/clm/test/system/TCText_ccsmcon.sh
   M models/lnd/clm/test/system/README.testnames
   M models/lnd/clm/test/system/test_driver.sh
   M models/lnd/clm/test/system/mknamelist
   M models/lnd/clm/test/system/TCSruncase.sh
   M models/lnd/clm/test/system/README
   M models/lnd/clm/test/system/CLM_runcmnd.sh

   M models/lnd/clm/tools/ncl_scripts/ndepregrid.ncl --- Adjust to use with updated queryDefaultNamelist.pl
   M models/lnd/clm/src/main/abortutils.F90 ------------ Add BGP #ifdef

Summary of testing:

  bluevista: All PASS except
052 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
053 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5
054 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5
055 blJ11 TBL.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
  bluefire: All PASS except TBL tests as bluefire not available in previous tag
  jaguar: All PASS except
  lightning/pathscale: All PASS except
  bangkok/lf95: All PASS except TBL tests because they had mpirun

CLM tag used for the baseline comparison tests if applicable: clm3_6_06

Changes answers relative to baseline: Default Orbital year in clm/bld scripts changed from 2000 to 1990

===============================================================
===============================================================
Tag name:  clm3_6_06
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Fri May 30 11:01:28 MDT 2008
One-line Summary: Small fix needed for ccsm4_alpha30

Purpose of changes: Fix bug 766 so use gx1v5 for some resolutions when OCN_GRID==ATM_GRID -- needed for ccsm4_alpha30

Bugs fixed (include bugzilla ID): 766 (bug when OCN_GRID==ATM_GRID), 767 (2.65x3.33 bug for seq-ccsm)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time), 768 (cpl6 tests on blueice)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                      652 (threads different answers with older PGI versions)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: Add 2.65x3.33 datm7 domain dataset

Describe any substantial timing or memory changes: none

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): scripts

   Update to scripts4_080529

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

M models/lnd/clm/test/system/tests_pretag_jaguar ------------ Do cpl7 I and ICN tests rather than I4804/ICN4804 tests
M models/lnd/clm/test/system/test_driver.sh ----------------- Make ptiles=32 for blueice
M models/lnd/clm/test/system/input_tests_master ------------- Add I and ICN tests for seq-ccsm with cpl7 scripts
M models/lnd/clm/tools/mkdatadomain/mkdatadomain.namelist --- Make datm the default output type
M models/lnd/clm/bld/DefaultDATM_DSHR_NML_Namelist.xml ------ Add domain dataset for 2.65x3.33 resolution
M models/lnd/clm/bld/clm.cpl7.template ---------------------- Change so if OCN_GRID==ATM_GRID, use gx1v5 for soem resolutions

Summary of testing:

  blueice: All PASS except
023 erA92 TER.sh _sc_dm clm_std 19990101:NONE:3600 4x5 gx3v5 -5+-5 arb_ic .......................FAIL! rc= 7 >>> Random machine bug?
062 sm952 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dm ext_ccsm_seq_cam 48 .......................FAIL! rc= 8 >>> bug 768
063 sm061 TSMext_ccsmcon.sh ERS f19_g13 .........................................................FAIL! rc= 7 >>> bug 768
>>>>> 62 and 63 fail because tests are setup for 32 TASKS rather than 8 being used on blueice (bug 768)
  jaguar: All PASS (A38 and 39 failed, because was using 1948-2004 data range, changed this but did not retest)
  lightning/ifort: All PASS
  bangkok/lf95: All PASS (43 and 44 because of missing file -- moved file over)

CLM tag used for the baseline comparison tests if applicable: clm3_6_05

Changes answers relative to baseline: No -- bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_05
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Tue May 27 13:23:21 MDT 2008
One-line Summary: Fix to compile with PGI-6, update scripts, fix cpl7.template for new scripts LND_GRID, fix 2.65x3.33 frac dataset.

Purpose of changes: A tag for cam and ccsm4_beta31.

Bugs fixed (include bugzilla ID): 762 (PGI-6 bug), 759 (2.65 res)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time), 766 (bug when OCN_GRID==ATM_GRID), 
                                  767 (2.65x3.33 bug for seq-ccsm), 768 (cpl6 tests on blueice)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          652 (threads different answers with older PGI versions)

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: Update 2.65x3.33 fractional dataset

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): csm_share, scripts and mct
+scripts                       to scripts4_080519
+models/csm_share              to share3_080514
+models/utils/mct              to MCT2_5_0_080415

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>>>>>>> Add in some new tests for 2.65x3.33 grid
M models/lnd/clm/test/system/README.testnames
M models/lnd/clm/test/system/tests_pretag_bangkok
M models/lnd/clm/test/system/tests_posttag_hybrid_regression
M models/lnd/clm/test/system/input_tests_master
M models/lnd/clm/test/system/tests_posttag_lightning
M models/lnd/clm/bld/clm.cpl7.template ------------------------ Remove logic for determining "T*" grid names
M models/lnd/clm/src/main/lnd_comp_mct.F90 -------------------- Put shr_kind_mod to top of module

Summary of testing:

  bluevista: All PASS except
052 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 (bug 708)
053 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5 (bug 708)
054 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5 (bug 708)
055 blJ11 TBL.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 (bug 708)
096 smM14 TSMncl_tools.sh ndepregrid ............................................................FAIL! rc= 6 
>>>>>>>>>>>>> Error loading libX11.a so couldn't load ncl
  lightning/pathf90: ALL PASS up to 028
  jaguarcnl: All PASS except
038 erP61 TSM_ccsmseq.sh ERS f19_g13 I4804 ......................................................FAIL! rc= 4
039 erP11 TSM_ccsmseq.sh ERS T31_g35 ICN4804 ....................................................FAIL! rc= 4
>>>>>>>>>>>>>>> Error in scripts for CLMNCEP data directory name
  bangkok/lf95: All PASS

CLM tag used for the baseline comparison tests if applicable: clm3_6_04

Changes answers relative to baseline: No -- bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_04
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Tue May 20 10:04:51 MDT 2008
One-line Summary: Remove all MCT permutes, fix cpl7 script issues, remove offline mode, add ability to run over a range of years

Purpose of changes:

Update scripts/datm version to fix cpl7 script issues. Remove all mct permutes. Change scripts/datm to allow 
various number of years. Remove offline mode! Fix stop time bug. Move use statements in clm_comp_mct to 
individual subroutines. Remove phoenix,tempest unsupported platforms. Update perl5lib. Remove source 
statements in clm.cpl7.template.csh file.

In cpl7 scripts add the following options to env_conf, which can be set at create_newcase or edit env_conf before running configure

env_conf:setenv DATM_CLMNCEP_YR_ALIGN  "1"      # integer; year align (what simulation year corresponds to starting year below)
env_conf:setenv DATM_CLMNCEP_YR_START  "1948"   # integer; starting year to loop data over
env_conf:setenv DATM_CLMNCEP_YR_END    "1948"   # integer; ending year to loop data over

The default "I" case is 1948 to 1948, but new compsets set these to the data range of 1948 to 2004.

* I_1948-2004    (shortname I4804)
* I_CN_1948-2004 (shortname ICN4804)

Bugs fixed (include bugzilla ID): 759 (mkgriddata incompatibility between MASK and FRAC, 744 (ability to set year range)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          652 (threads different answers with older PGI versions)

Describe any changes made to build system: Remove the offline mode.

Describe any changes made to the namelist: Remove offline specific namelist items: offline_atmdir, cycle_begyr, cycle_nyr

List any changes to the defaults for the boundary datasets: Just remove offline_atmdir

Describe any substantial timing or memory changes: Not tested

Code reviewed by: self, mvertens, slevis, oleson and kauff (for script changes)

List any svn externals directories updated (csm_share, mct, etc.): scripts, drv, datm7, csm_share

Move to new ccsm4 trunk versions. Get versions with new cpl7 capabilities to set year range for CLMNCEP option in datm7

+scripts                       scripts4_080519
+models/drv/seq_mct            drvseq2_0_22
+models/atm/datm7              datm7_080519
+models/csm_share              share3_080514

List all files eliminated:

>>>>>>>>>>>>>>>>> Remove offline test configurations
D      models/lnd/clm/test/system/config_files/_per_dh
D      models/lnd/clm/test/system/config_files/_per_dm
D      models/lnd/clm/test/system/config_files/_per_ds
D      models/lnd/clm/test/system/config_files/_h
D      models/lnd/clm/test/system/config_files/_m
D      models/lnd/clm/test/system/config_files/_o
D      models/lnd/clm/test/system/config_files/17p_vodsr_dh
D      models/lnd/clm/test/system/config_files/_s
D      models/lnd/clm/test/system/config_files/17p_cn_dh
D      models/lnd/clm/test/system/config_files/17p_vodsr_dm
D      models/lnd/clm/test/system/config_files/17p_vodsr_do
D      models/lnd/clm/test/system/config_files/17p__h
D      models/lnd/clm/test/system/config_files/4p_casa_h
D      models/lnd/clm/test/system/config_files/17p__m
D      models/lnd/clm/test/system/config_files/17p__o
D      models/lnd/clm/test/system/config_files/4p_casa_m
D      models/lnd/clm/test/system/config_files/4p_casa_o
D      models/lnd/clm/test/system/config_files/17p_vodsr_h
D      models/lnd/clm/test/system/config_files/17p_cnexitspinup_dh
D      models/lnd/clm/test/system/config_files/17p_vodsr_m
D      models/lnd/clm/test/system/config_files/17p_vodsr_o
D      models/lnd/clm/test/system/config_files/17p_cnadspinup_dh
D      models/lnd/clm/test/system/config_files/4p_vodsr_dh
D      models/lnd/clm/test/system/config_files/17p_cnn_h
D      models/lnd/clm/test/system/config_files/17p_cnn_dh
D      models/lnd/clm/test/system/config_files/4p_vodsr_dm
D      models/lnd/clm/test/system/config_files/17p__dh
D      models/lnd/clm/test/system/config_files/17p_cnn_m
D      models/lnd/clm/test/system/config_files/4p_vodsr_do
D      models/lnd/clm/test/system/config_files/17p_cnn_o
D      models/lnd/clm/test/system/config_files/10p_dgvm_h
D      models/lnd/clm/test/system/config_files/4p_casa_dh
D      models/lnd/clm/test/system/config_files/17p_cnn_dm
D      models/lnd/clm/test/system/config_files/17p__dm
D      models/lnd/clm/test/system/config_files/17p_cnn_do
D      models/lnd/clm/test/system/config_files/10p_dgvm_dh
D      models/lnd/clm/test/system/config_files/17p__do
D      models/lnd/clm/test/system/config_files/10p_dgvm_m
D      models/lnd/clm/test/system/config_files/4p_casa_dm
D      models/lnd/clm/test/system/config_files/_dh
D      models/lnd/clm/test/system/config_files/10p_dgvm_o
D      models/lnd/clm/test/system/config_files/17p_cnn_ds
D      models/lnd/clm/test/system/config_files/4p_casa_do
D      models/lnd/clm/test/system/config_files/17p__ds
D      models/lnd/clm/test/system/config_files/10p_dgvm_dm
D      models/lnd/clm/test/system/config_files/10p_dgvm_s
D      models/lnd/clm/test/system/config_files/10p_dgvm_do
D      models/lnd/clm/test/system/config_files/_dm
D      models/lnd/clm/test/system/config_files/_do
D      models/lnd/clm/test/system/config_files/_ds
D      models/lnd/clm/test/system/config_files/4p_vodsr_h
D      models/lnd/clm/test/system/config_files/4p_vodsr_m
D      models/lnd/clm/test/system/config_files/4p_vodsr_o
D      models/lnd/clm/bld/CLMDrvInNamelistsDescriptions.xml ------- Remove offline build namelist description
>>>>>>>>>>>>>>>>>>>> Remove offline specific modules
D      models/lnd/clm/src/main/atmdrvMod.F90
D      models/lnd/clm/src/main/program_off.F90
D      models/lnd/clm/test/system/tests_pretag_tempest ------------ Remove tempest testing

List all files added and what they do:

>>>>>>>>>>>>>>>> Add tests for running cpl7 with scripts in the scripts directory
A      models/lnd/clm/test/system/TSM_ccsmseq.sh
A      models/lnd/clm/test/system/TCT_ccsmseq.sh

List all existing files that have been modified, and describe the changes:

>>>>>>>>>>>>>>>>>>> Remove phoenix, tempest, offline tests, add cpl7 script testing
M      models/lnd/clm/test/system/TCText_ccsmcon.sh
M      models/lnd/clm/test/system/tests_pretag_jaguar
M      models/lnd/clm/test/system/tests_pretag_bangkok
M      models/lnd/clm/test/system/test_driver.sh ------------------------- Remove phoenix and tempest, change jaguarcnl to jaguar
M      models/lnd/clm/test/system/tests_posttag_purempi_regression
M      models/lnd/clm/test/system/tests_posttag_hybrid_regression
M      models/lnd/clm/test/system/tests_pretag_bluevista
M      models/lnd/clm/test/system/tests_posttag_blueice
M      models/lnd/clm/test/system/input_tests_master
M      models/lnd/clm/test/system/tests_posttag_lightning
M      models/lnd/clm/test/system/CLM_runcmnd.sh
>>>>>>>>>>>>>>>>>>>  Remove SGI, get Linux to work with various compilers
M      models/lnd/clm/tools/mksurfdata/Makefile
M      models/lnd/clm/tools/interpinic/Makefile
M      models/lnd/clm/tools/mkgriddata/creategridMod.F90 ----- Make MASK and FRAC compatable when running with camfile
M      models/lnd/clm/tools/mkgriddata/Makefile
M      models/lnd/clm/tools/mkdatadomain/Makefile
>>>>>>>>>>>>>>>>>>>  Remove offline mode
M      models/lnd/clm/bld/configure
M      models/lnd/clm/bld/DefaultCLM_INPARM_Namelist.xml
M      models/lnd/clm/bld/run-ibm.csh
M      models/lnd/clm/bld/config_clm_defaults.xml
M      models/lnd/clm/bld/clm_inparm.pm
M      models/lnd/clm/bld/DefaultSettings.xml
M      models/lnd/clm/bld/queryDefaultXML.pm
M      models/lnd/clm/bld/run-frost.csh
M      models/lnd/clm/bld/run-pc.csh
M      models/lnd/clm/bld/clm.cpl7.template ------------ Remove source statements as unneeded
M      models/lnd/clm/bld/drv_in.pm
M      models/lnd/clm/bld/run-lightning.csh
>>>>>>>>>>>>>>>>>>>  Remove all MCT permutes, remove OFFLINE #ifdefs
M      models/lnd/clm/src/biogeochem/STATICEcosysDynMod.F90
M      models/lnd/clm/src/main/spmdGathScatMod.F90
M      models/lnd/clm/src/main/driver.F90
M      models/lnd/clm/src/main/decompInitMod.F90
M      models/lnd/clm/src/main/ncdio.F90
M      models/lnd/clm/src/main/accFldsMod.F90
M      models/lnd/clm/src/main/initializeMod.F90
M      models/lnd/clm/src/main/gen_spmdgs_subs.csh
M      models/lnd/clm/src/main/pftdynMod.F90
M      models/lnd/clm/src/main/iniTimeConst.F90
M      models/lnd/clm/src/main/histFileMod.F90
M      models/lnd/clm/src/main/clm_atmlnd.F90
M      models/lnd/clm/src/main/controlMod.F90
M      models/lnd/clm/src/main/clm_time_manager.F90 ---------- Fix stop time bug, remove stop_final_ymd
M      models/lnd/clm/src/main/clm_varctl.F90
M      models/lnd/clm/src/main/lnd_comp_mct.F90 -------------- Move use statements from top to individual subroutines, remove permutes
M      models/lnd/clm/src/main/spmdMod.F90
M      models/lnd/clm/src/main/surfrdMod.F90
M      models/lnd/clm/src/main/decompMod.F90
M      models/lnd/clm/src/main/do_close_dispose.F90
M      models/lnd/clm/src/main/clm_mct_mod.F90
M      models/lnd/clm/src/main/histFldsMod.F90
M      models/lnd/clm/src/riverroute/RtmMod.F90
M      models/lnd/clm/src/riverroute/RunoffMod.F90
M      models/lnd/clm/src/biogeophys/Hydrology1Mod.F90

Summary of testing:

  bluevista: All PASS except
052 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 (bug 708)
053 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5 (bug 708)
054 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5 (bug 708)
055 blJ11 TBL.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 (bug 708)

Also tested on lightning with pathscale and ifort compilers, but testing did not complete as ran out of disk quota.

CLM tag used for the baseline comparison tests if applicable: clm3_6_02

Changes answers relative to baseline: No bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_03
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Thu May  8 12:55:58 MDT 2008
One-line Summary: Fix so listen to next_swcday to calculate albedo rather than using irad

Purpose of changes: Fix do-albedo logic needed to couple with CAM

Bugs fixed (include bugzilla ID): 724 (cprnc), 750 (doalb bug)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          694 (restarts for offline) , 
                                          652 (threads different answers with older PGI versions)
                                          725 (bug in offline mode for lightning with ifort compiler)

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): Update externals to ccsm4_0_alpha29

+scripts                       scripts4_080430b
+models/drv/seq_mct            drvseq2_0_19
+models/csm_share              loga27_share3_071107
+models/utils/mct              MCT2_5_0_080415
+models/lnd/clm/tools/cprnc    cprnc_080324

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/test/system/TBL.sh ------------- Set directory wildcard in a way that will work on bangkok
M      models/lnd/clm/test/system/test_driver.sh ----- Update to use ccsm4_0_alpha29
M      models/lnd/clm/bld/configure ------------------ Don't add timing to Filepath for ccsm case
M      models/lnd/clm/bld/clm.cpl6.template ---------- Use "r" files instead of "i" files
M      models/lnd/clm/bld/clm.cpl7.template ---------- Use "r" files instead of "i" files, allow ability to read "T*" lnd grid name
M      models/lnd/clm/src/main/clm_comp.F90 ---------- Don't calculate doalb receive it from above.
M      models/lnd/clm/src/main/program_csm.F90 ------- Calculate doalb and pass down.
M      models/lnd/clm/src/main/lnd_comp_mct.F90 ------ Calculate doalb and pass down.
M      models/lnd/clm/src/main/program_off.F90 ------- Calculate doalb and pass down.
M      UpDateChangeLog.pl ---------------------------- Also copy ChangeLog to models/lnd/clm/doc for use in ccsm4

Summary of testing:

  bluevista: All PASS except
052 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
053 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5
054 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5
  blueice:   All PASS except (up to 41)
026 sm111 TSM.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 4
027 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 5
028 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 5
029 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 4
030 sm115 TSM.sh 4p_vodsr_h clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
  lightning: All PASS except (up to 22)
019 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
  bangkok:   All PASS except (up to 19)
018 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
019 br113 TBR.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 13

The FAILS are all bug 694 -- restarts for offline.

CLM tag used for the baseline comparison tests if applicable: clm3_6_02

Changes answers relative to baseline: No -- bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_02
Originator(s):  erik (Erik Kluzek)
Date:  Tue Mar 25 17:29:15 MDT 2008
One-line Summary: Minor fix in configure remove perl5lib version under models/lnd/clm/bld

Purpose of changes: Fix configure for ext_ccsm_seq mode and remove extra perl5lib version
   under models/lnd/clm/bld

Bugs fixed (include bugzilla ID): 727 (fix configure for ext_ccsm_seq)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time), 724 (cprnc core dumps)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          694 (restarts for offline) , 
                                          652 (threads different answers with older PGI versions)
                                          725 (bug in offline mode for lightning with ifort compiler)

Describe any changes made to build system: Fix configure bug

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self, tcraig

List any svn externals directories updated (csm_share, mct, etc.): None

 Just remove perl5lib under models/lnd/clm/bld

List all files eliminated: None
 
List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

  M models/lnd/clm/bld/build-namelist -- Change how check of SeqCCSM_Namelist.pm is done.
  M model/lnd/clm/bld/configure -------- Fix bug 727. Comparision checks both ext_ccsm_con
                                         and ext_ccsm_seq.

Summary of testing:

  bangkok/lf95: Just made sure build-namelist worked

CLM tag used for the baseline comparison tests if applicable: clm3_6_02

Changes answers relative to baseline: Bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_6_01
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Thu Mar 20 13:42:22 MDT 2008
One-line Summary: 40 m forcing height changes for clm

Purpose of changes: Use minimum of a 40 m forcing height in clm so that CAM can have a finer vertical resolution
                    This completes the move of the changes in the ccsm4a branch to the CLM trunk.

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time), 724 (cprnc core dumps)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          694 (restarts for offline) , 
                                          652 (threads different answers with older PGI versions)
                                          725 (bug in offline mode for lightning with ifort compiler)

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): None

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/src/main/clm_varcon.F90 ----- Set forc_hgt_min = 40 m
M      models/lnd/clm/src/main/clm_csmMod.F90 ----- Set forc_hgt to max of input and forc_hgt_min
M      models/lnd/clm/src/main/lnd_comp_mct.F90 --- Set forc_hgt to max of input and forc_hgt_min

Summary of testing:

   tempest: testing completes

CLM tag used for the baseline comparison tests if applicable:

Changes answers relative to baseline: offline mode -- running with 26 level CAM gives same answers
Simulations with CAM3.5.38 or ccsm4_0_alpha25 have these same changes in them.

===============================================================
===============================================================
Tag name:  clm3_6_00
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Thu Mar 20 13:32:07 MDT 2008
One-line Summary: Fully implement sequential-ccsm mode, upgrade configure, 
         build-namelist and testing, upgrade interpolation tool, 
         add mkdatadomain, write to iulog rather than 6 explicitly, SCAM update, 
         Update datasets, add archiving, and build-streams, add in point version 
         of Urban model, change directory structure to mimic CCSM

Software engineering changes:

   Fully implement sequential-ccsm mode.
   Upgrade configure, build-namelist and testing, and build-streams.
   Upgrade interpolation tool, 
   Add mkdatadomain to convert CLM input datasets to CCSM datm7 format.
   Write to iulog rather than 6 explicitly.
   SCAM update.
   Update datasets used.
   Add archiving as a script run after model completes.
   Change directory structure to mimic CCSM.

    QUICKSTART: using the new CPL7 scripts:

         cd scripts
         ./create_newcase            # get help on how to run create_newcase
         ./create_newcase -case testI -mach blueice -res f19_g15 -compset I    # create new "I" case for blueice at 1.9x2.5_gx1v5 res
                                     # "I" case is clm active, datm7, and inactive ice/ocn
         cd testI
         configure -mach blueice     # create scripts
         testI.build                 # build model and create namelists
         bsub < testI.run            # submit script  
                                     # (NOTE: edit env_run to set RESUBMIT to number of times to automatically resubmit)

Science changes:

   Interpinic:

   Get it to work with OMP to run faster and optimized. Validate that different numbers of threads gives the same answers.
   Correct problem to find nearest points for PFT data. Get interpinic to work on a half-degree dataset. Change interpinic 
   so it doesn't work on a given set of variables -- but does all applicable variables based on a set of rules of what the
   variables dimensions are. This allows interpinic to work for CN cases.

   Urban model:

   Urban code was started by Gordon Bonan, and taken up by Mariana Vertenstein and Keith Oleson.
   This represents work that has been ongoing for several years. Revision dates go back to
   before 2003.

   Some papers on the work are available from:

   Oleson et.-al. Journal of Applied Meteorology and Climatology, in-Press as of Jan/2008

   http://www.cgd.ucar.edu/tss/staff/oleson/publications/JAMC1597_rev_jul27_2007.pdf
   http://www.cgd.ucar.edu/tss/staff/oleson/publications/JAMC1598_rev_jul27_2007.pdf

   Newcn06:

   Move newcn06-02_clm3_5_00 branch tag to trunk. Add ability for CN to do pftdyn mode. Add new options to configure
   and namelist.

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  698 (cprnc bug gives false difference), 701 (svn keyword), 708, (xlf bug on bluevista)
                                  717 (archiving bug -- only archive 1000 files at a time), 724 (cprnc core dumps)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          694 (restarts for offline) , 
                                          652 (threads different answers with older PGI versions)
                                          725 (bug in offline mode for lightning with ifort compiler)

Describe any changes made to build system:

   Add new options to configure

     -ad_spinup    Turn on AD_SPINUP mode for bgc setting of CN [on | off]
     -exit_spinup  Turn on EXIT_SPINUP mode for bgc setting of CN [on | off]
     -pergro       Switch enables building CLM for perturbation growth tests.

   Add BUILDPIO CPP variable

   Implement a build-namelist script to create namelists for you:

build-namelist -help
SYNOPSIS
     build-namelist [options]
OPTIONS
     -cam_config "file"      Read the CAM config cache file (rather than the CLM version) to get
                             build-time configuration information.
                             (Default -- not used.)
     -cam_hist_case "caseid" Use the input CAM simulation caseid to build a streams file with that case id.
                             (Default -- not used).
     -case "name"            Case identifier up to 32 characters
     -clm_cfg "dir"          Directory containing CLM configuration scripts.
     -clm_demand "list"      List of variables to require on clm namelist besides the usuals.
     -config "file"          Read the given config cache file to get the configuration
                             of the CLM executable.  Default: config_cache.xml.
     -csmdata "dir"          Head directory location of CCSM input data.
                             Can also be set by using the CSMDATA environment variable.
     -cycle_beg_year "year"  The begining year to cycle input datasets over.
     -cycle_end_year "year"  The ending year to cycle input datasets over.
     -cycle_init_year "year" The simulation year that will correspond to the data
                             for cycle_beg_year.
     -d "directory"          Output directory name of resulant namelists.
                             Default: ./
     -datm_data_dir "path"   Directory path to the datm data
                             (only used when mode=ccsm_seq)
     -datm_domain "file"     File name of domain file for datm data matching resolution data resolution.
                             (only used when mode=ccsm_seq)
     -datm_dom_dir "path"    Directory path to the datm_domain file.
                             (only used when mode=ccsm_seq)
     -help [or -h]           Print usage to STDOUT.
     -ignore_ic_date         Ignore the date on the initial condition files (ic_ymd and ic_tod)
                             when determining what input initial condition file to use.
     -ignore_ic_year         Ignore just the year part of the date on the initial condition files (ic_ymd and ic_tod)
                             when determining what input initial condition file to use.
     -infile "file"          Specify a namelist file to read values from.
     -lnd_res "Resolution"   Horizontal resolution of fine mesh for land
                             (if different than resolution coupling to atmosphere)
     -mask "land-mask"       Type of land-mask (default, navy, gx3v5, gx1v5 etc.)
     -namelist "namelist"    Specify namelist settings using FORTRAN namelist syntax, e.g.,
                              -namelist "&clm_inparm hist_dov2xy=.true. /"
     -res "Resolution"       Horizontal resolution (default, 64x128, 1.9x2.5, 1x1_brazil etc.)
     -runlength "length"     Length of simulation (e.g. default, 10d, 5s, 2y)
                             (Corresponding to: default, 10 days, 5 steps, or 2 years)
                             classifiers (d=days, s=steps, y=years)
     -s                      Turns on silent mode - only fatal messages issued.
     -sim_year year          Year to simulate for input datasets (i.e. 1890, 2000, etc.)
     -source "source"        Source data to use for datm (for ccsm_seq mode)
     -start_type "type"      Type of simulation (arb_ic, startup, continue, or branch)
     -test                   Enable checking that initial and boundary datasets exist on local filesystem.
     -use_case "case"        Specify a use case which will provide default values.
     -v n                    Set verbosity to level n.  1 (default), 2 or 3.

Note: The precedence for setting the values of namelist variables is (highest to lowest):
      1. interactive prompting,
      2. namelist values set by specific command-line options, e.g., -case -start_type and -ignore_ic_date,
      3. values set on the command-line using the -namelist option,
      4. values read from the file specified by -infile,
      5. values specified by the -use_case option,
      6. values from defaults files in the CLM configuration
         script directory.

      Use the "drv_in" 'virtual namelist' to have build-namelist decide which namelist
      to put driver control information in.
 Use build-streams for sequential-CCSM
  Builds the streams files on the fly. This allows running data over any period.
  Add usecase option to build-namelist to set multiple things (currently only implementing pergro and pergro0)
  Add notes to namelist files generated with build-namelist so can reconstruct.
  See details of new build-namelist options in documentation on build-namelist below.


Describe any changes made to the namelist:

   Remove mss options (mss_irt, mss_wpass and archive_dir)
   Remove ability to change restart pointer filename (rpntpath)
   Actually use pertlim for arbitrary initial conditions if > 0

     o co2_ppmv               = real for CO2 parts per million by volume                         [MUST be set on namelist]
     o model_version          = character for model version running with
     o hostname               = character for model version running with
     o username               = character for model version running with
     o stop_final_ymd         = integer if want to stop early (only offline mode -- use stop_ymd in drv_in for seq_ccsm)
     o furbinp                = character if want to turn urban datasets on                      (default " ")
     o outnc_large_files      = logical true if want to use NetCDF 64-bit large file format      [.FALSE., .TRUE.]
                                for output files (history and restart files)

   History experimental options (mostly for PIO which isn't fully implemented yet):

     o hist_pioflag           = logical true if want to turn on hist with pio                    [.FALSE., .TRUE.]
     o ncd_lowmem2d           = logical true if want to turn on low memory 2d writes in clm hist [.TRUE., .FALSE.]
     o ncd_pio_def            = logical true if want default pio use setting                     [.FALSE., .TRUE.]
     o ncd_pio_UseRearranger  = logical true if want to use MCT as Rearranger                    [.TRUE., .FALSE.]
     o ncd_pio_UseBoxRearr    = logical true if want to use box as Rearranger                    [.FALSE., .TRUE.]
     o ncd_pio_SerialCDF      = logical true if want to write with pio serial netcdf mode        [.FALSE., .TRUE.]
     o ncd_pio_IODOF_rootonly = logical true if want to write history in pio from root only      [.FALSE., .TRUE.]
     o ncd_pio_DebugLevel     = integer pio debug level                                          ( default 2)
     o ncd_pio_num_iotasks    = integer number of iotasks to use for PIO                         (default all PEs)

   New output variables added:

        BUILDHEAT     heat flux from urban building interior to walls and roof            W/m^2  active
        LWdown        atmospheric longwave radiation                                      W/m^2
        PSurf         surface pressure                                                    Pa
        Qh            sensible heat                                                       W/m^2
        Qle           total evaporation                                                   W/m^2
        Qstor         storage heat flux (includes snowmelt)                               W/m^2
        RH            atmospheric relative humidity                                       %
        Rainf         atmospheric rain                                                    mm/s
        Rnet          net radiation                                                       W/m^2
        SWdown        atmospheric incident solar radiation                                W/m^2
        TBUILD        internal urban building temperature                                 K      active
        TRAFFICFLUX   sensible heat flux from urban traffic                               W/m^2  active
        Tair          atmospheric air temperature                                         K
        WASTEHEAT     sensible heat flux from heating/cooling sources of urban waste heat W/m^2  active
        HCSOI         soil heat content                                                   MJ     active
        HCSOISNO      soil plus snow heat content                                         MJ     active

   (Fields not mentioned above as active are set to inactive unless asked for. They are "ALMA" variables needed for
    an urban model intercomparision project.)

Describe timing and memory performance:

   On blueice

       128 Tasks, nosmp   = 1.9x2.5_gx1v5 resolution:  115 sim-years/Wall-Day 
                                                        61 sim-years/Wall-Day (CN mode) 3.9 GBytes memory
	64 Tasks, nosmp   = 1.9x2.5_gx1v5 resolution:  143 sim-years/Wall-Day
                                                        73 sim-years/Wall-Day (CN mode) 2.1 GBytes memory
	32 Tasks, nosmp   = 1.9x2.5_gx1v5 resolution:  131 sim-years/Wall-Day 
                                                        60 sim-years/Wall-Day (CN mode) 2.2 GBytes memory
	32 threads, nospmd= 1.9x2.5_gx1v5 resolution:   98 sim-years/Wall-Day 
                                                        49 sim-years/Wall-Day (CN mode) 1.7 GBytes memory
         8 Tasks, nosmp   = 1.9x2.5_gx1v5 resolution:   88 sim-years/Wall-Day 
                                                        38 sim-years/Wall-Day (CN mode) 774 MBytes memory
       Note: With 64 Tasks CLM is spending roughly 40% of it's time on I/O. Hence, increasing the processor
             count doesn't increase the throughput -- since I/O is only on one task.

   Depending on the configuration -- offline mode is about the same to 168% slower (in CN mode)

Versions of any externally defined libraries:

   doc                           doc_060127
   scripts                       scripts4_080311
   models/drv/seq_mct            drvseq2_0_12
   models/atm/datm7              drva07_datm7_071129
   models/ocn//socn              stubs1_0_7
   models/ice//sice              stubs1_0_7
   models/csm_share              loga26_share3_071107
   models/utils/esmf_wrf_timemgr esmf_wrf_timemgr_060616
   models/utils/timing           timing_070525
   models/utils/mct              seqa07_MCT2_4_2_071026
   models/utils/pio              pio11_prod
   models/lnd/clm/tools/cprnc    cprnc_070817
   models/lnd/clm/bld/perl5lib   perl5lib_071204

Summary of testing:

  bluevista:
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
070 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 <<<<< Bug 708
071 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5 <<<<< Bug 708
072 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5 <<<<< Bug 708
073 blJ11 TBL.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 <<<<< Bug 708
074 smJ15 TSM.sh 4p_casasc_h clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ...................FAIL! rc= 4 <<<<< Bug 708
  blueice: All PASS except...
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
022 br113 TBR.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<<< Bug 694
032 brE12 TBR.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ............FAIL! rc= 6 <<<< MPI error...
  jaguarcnl: All PASS except...
009 smB11 TSMruncase.sh .........................................................................FAIL! rc= 4 <<<< bad hostname
013 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 5
018 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 5
023 bl113 TBL.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7
028 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 5
033 blE12 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 5
035 smE13 TSM.sh 4p_vodsrsc_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 10
038 blE13 TBL.sh 4p_vodsrsc_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 4
  lightning/pathf90: All PASS except...
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<<< Bug 694
013 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<<< Bug 694
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
018 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<<< Bug 694
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
022 br113 TBR.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<<< Bug 694
023 bl113 TBL.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<<< Bug 694
028 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 7
  lightning/ifort: All PASS except...
004 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 7 <<<< Answers different
008 blA74 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 7 <<<< Answers different
010 sm111 TSM.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 10 <<<< Bug 725
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 5 <<<< Bug 725
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 5 <<<< Bug 725
013 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 4 <<<< Bug 725
014 sm115 TSM.sh 4p_vodsr_h clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 10 <<<< Bug 725
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 725
018 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<<< Bug 725
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 725
022 br113 TBR.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<<< Bug 725
023 bl113 TBL.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<<< Bug 725
026 erE11 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ............FAIL! rc= 13 <<<< Answers different
027 brE11 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ............FAIL! rc= 11 <<<< Answers different
ifort tests abort early here...
  bangkok/lf95:  All PASS except...
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
135 sm061 TSMext_ccsmcon.sh ERS f19_g13 .........................................................FAIL! rc= 4 <<<< Bad hostname
      >>>>>>>>>>>>>>>>>>>> Random MPI errors????
029 smE15 TSM.sh 4p_vodsrsc_h clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ................FAIL! rc= 10
044 smF25 TSM.sh 17p_vodsrsc_h clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 10
045 smE31 TSM.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 10
046 erE31 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 10+38 arb_ic ....FAIL! rc= 5
047 brE31 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 24+24 arb_ic ....FAIL! rc= 5
049 smE35 TSM.sh 4p_vodsrsc_h clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic ........FAIL! rc= 10
054 smG45 TSM.sh 17p_sc_h clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic .................FAIL! rc= 10
063 smH06 TSM.sh 17p_cnnsc_m clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5@2000 48 startup FAIL! rc= 10
074 smJ15 TSM.sh 4p_casasc_h clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ...................FAIL! rc= 10
079 smK15 TSM.sh 10p_dgvmsc_h clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 10
080 smK18 TSM.sh 10p_dgvmsc_h clm_std 19981231:NONE:1800 48x96 gx3v5 -213 arb_ic ................FAIL! rc= 10
081 erK18 TER.sh 10p_dgvmsc_h clm_std 19981231:NONE:1800 48x96 gx3v5 -90+-121 arb_ic ............FAIL! rc= 5
093 smL61 TSM.sh _sc_h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup ..................FAIL! rc= 10
094 erL61 TER.sh _sc_h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -5+-5 startup ................FAIL! rc= 5
095 brL61 TBR.sh _sc_h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10+-10 startup ..............FAIL! rc= 5
  bangkok/pgi: All PASS except...
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<<< Bug 694
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< Bug 694
022 br113 TBR.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<<< Bug 694
135 sm061 TSMext_ccsmcon.sh ERS f19_g13 .........................................................FAIL! rc= 4 <<<< Bad hostname
045 smE31 TSM.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 10 <<<< Bug 464
046 erE31 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 10+38 arb_ic ....FAIL! rc= 5 <<<< Bug 464
047 brE31 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 24+24 arb_ic ....FAIL! rc= 5 <<<< Bug 464
049 smE35 TSM.sh 4p_vodsrsc_h clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic ........FAIL! rc= 10 <<<< Bug 464
      >>>>>>>>>>>>>>>>>>>> Random MPI errors???? (seems to randoming have trouble finding files -- but they are there later...)
040 smF21 TSM.sh 17p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..............FAIL! rc= 10
041 erF21 TER.sh 17p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ...........FAIL! rc= 5
042 brF21 TBR.sh 17p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ...........FAIL! rc= 5
055 smG74 TSM.sh 17p_sc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -1100 arb_ic ........FAIL! rc= 10
063 smH06 TSM.sh 17p_cnnsc_m clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5@2000 48 startup FAIL! rc= 10
069 smI58 TSMcnspinup.sh 17p_cnadspinupsc_dh 17p_cnexitspinupsc_dh 17p_cnsc_dh clm_std 19980115:NONEFAIL! rc= 5
080 smK18 TSM.sh 10p_dgvmsc_h clm_std 19981231:NONE:1800 48x96 gx3v5 -213 arb_ic ................FAIL! rc= 10
081 erK18 TER.sh 10p_dgvmsc_h clm_std 19981231:NONE:1800 48x96 gx3v5 -90+-121 arb_ic ............FAIL! rc= 5
083 erK74 TER.sh 10p_dgvmsc_s clm_std 19971231:NONE:1800 1x1_brazil navy -334+-336 arb_ic .......FAIL! rc= 6
  tempest: All PASS except..
009 smB11 TSMruncase.sh .........................................................................FAIL! rc= 4 <<<< No tempest run script
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<< Bug 694
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<< Bug 694
013 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<< Bug 694
016 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<< Bug 694
021 er113 TER.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<< Bug 694
022 br113 TBR.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11 <<< Bug 694
023 bl113 TBL.sh 4p_vodsr_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7 <<< Bug 694
046 erE31 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 10+38 arb_ic ....FAIL! rc= 7 <<<< Stack memory problem
047 brE31 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 24+24 arb_ic ....FAIL! rc= 6 <<<< Stack memory problem
063 smH06 TSM.sh 17p_cnnsc_m clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5@2000 48 startup FAIL! rc= 10 <<<< Memory limit
123 sm921 TSMext_ccsmseq_cam.sh ext_ccsm_seq_4x5_dh ext_ccsm_seq_cam 48 .........................FAIL! rc= 8 <<<<< MPI_GROUP_MAX limit
124 bl921 TSMext_ccsmseq_cam.sh ext_ccsm_seq_4x5_dh ext_ccsm_seq_cam 48 .........................FAIL! rc= 2 <<<<< MPI_GROUP_MAX limit
135 sm061 TSMext_ccsmcon.sh ERS f19_g13 .........................................................FAIL! rc= 4 <<<<< Bad hostname

===============================================================
===============================================================
Tag name:  clm3_5_20
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Mon Mar 17 10:37:41 MDT 2008
One-line Summary: Bug fixes before spinning off clm3_6_00, put in changes from ccsm4a01_clm3_5_18 to ccsm4a04_clm3_5_18

Purpose of changes:

Bugs fixed (include bugzilla ID): 697 (add model_version, username, hostname to seq_infodata namelist to document on output history files)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  694 (restarts for offline) , 698 (cprnc bug), 701 (svn keyword), 
                                  708, (xlf bug on bluevista)
    http://bugs.cgd.ucar.edu/

    Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          652 (threads different answers with older PGI versions)

Describe any changes made to build system: None

Describe any changes made to the namelist: Add model_version, username, hostname to seq_infodata namelist

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self (run scripts by oleson, and slevis)

List any svn externals directories updated (csm_share, mct, etc.): scripts, drv, csm_share

   scripts (scripts4_080311), drv (drvseq2_0_12), csm_share (loga26_share3_071107)

List all files eliminated: None

List all files added and what they do: Configuration for mpi-only tests

A      models/lnd/clm/test/system/config_files/17p_cnexitspinupsc_dm
A      models/lnd/clm/test/system/config_files/17p_cnsc_dm
A      models/lnd/clm/test/system/config_files/17p_cnadspinupsc_dm

List all existing files that have been modified, and describe the changes:

M      models/lnd/clm/test/system/tests_posttag_spot1
M      models/lnd/clm/test/system/tests_posttag_urban
M      models/lnd/clm/test/system/tests_pretag_jaguar
M      models/lnd/clm/test/system/README.testnames
M      models/lnd/clm/test/system/tests_pretag_bangkok
M      models/lnd/clm/test/system/test_driver.sh
M      models/lnd/clm/test/system/tests_posttag_purempi_regression
M      models/lnd/clm/test/system/tests_posttag_hybrid_regression
M      models/lnd/clm/test/system/tests_pretag_tempest
M      models/lnd/clm/test/system/tests_pretag_bluevista
M      models/lnd/clm/test/system/tests_posttag_blueice
M      models/lnd/clm/test/system/input_tests_master
M      models/lnd/clm/test/system/README
M      models/lnd/clm/test/system/tests_posttag_lightning
M      models/lnd/clm/test/system/CLM_runcmnd.sh
M      models/lnd/clm/tools/mksurfdata/README
M      models/lnd/clm/tools/mksurfdata/Makefile
M      models/lnd/clm/tools/ncl_scripts/README
M      models/lnd/clm/tools/interpinic/Makefile
M      models/lnd/clm/tools/interpinic/README
M      models/lnd/clm/tools/mkgriddata/README
M      models/lnd/clm/tools/mkgriddata/Makefile
M      models/lnd/clm/tools/mkdatadomain/Makefile
M      models/lnd/clm/tools/mkdatadomain/README
M      models/lnd/clm/tools/README
M      models/lnd/clm/bld/run-ibm.csh
M      models/lnd/clm/bld/run-pc.csh
M      models/lnd/clm/bld/run-lightning.csh
M      models/lnd/clm/bld/DefaultSettings.xml
M      models/lnd/clm/bld/queryDefaultXML.pm
M      models/lnd/clm/bld/sample.seqccsm.namelists
M      models/lnd/clm/bld/CLMDrvInNamelistsDescriptions.xml
MM     models/lnd/clm/bld/DefaultCCSM_INPARM_Namelist.xml
M      models/lnd/clm/bld/README
M      models/lnd/clm/bld/CCSMDrvInNamelistsDescriptions.xml
M      models/lnd/clm/bld/ccsm_inparm.pm
M      models/lnd/clm/bld/SeqCCSMDrvInNamelistsDescriptions.xml
M      models/lnd/clm/src/main/ncdio.F90
M      models/lnd/clm/src/main/initializeMod.F90
M      models/lnd/clm/src/main/controlMod.F90
M      models/lnd/clm/src/main/clm_varctl.F90
M      models/lnd/clm/src/main/lnd_comp_mct.F90
M      models/lnd/clm/src/biogeophys/SurfaceRadiationMod.F90
M      README
M      KnownBugs

Summary of testing:

  blueice: All PASS except
------>>>>>>> Bug 694
027 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
  bluevista: All PASS except
------>>>>>>> Bug 694
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
------>>>>>>> Bug 708
051 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
052 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5
053 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5
055 smJ14 TSM.sh 4p_casasc_h clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ...................FAIL! rc= 4
  jaguarcnl: All PASS except
  bangkok/lf95: All PASS except
------>>>>>>> Bug 694
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11
013 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7
------>>>>>>> Seem to be random MPI failure
033 blF27 TBL.sh 17p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..............FAIL! rc= 7
035 smE31 TSM.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 10
036 erE31 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 10+38 arb_ic ....FAIL! rc= 5
037 brE31 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 24+24 arb_ic ....FAIL! rc= 5
038 blE31 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 4
043 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic ................FAIL! rc= 7
045 smH01 TSM.sh 17p_cnnsc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5@2000 48 startup FAIL! rc= 10
049 blH11 TBL.sh 17p_cnnsc_dh clm_std 19980101:MONTHLY:1800 48x96 gx3v5@1890 48 arb_ic ..........FAIL! rc= 7
054 blJ11 TBL.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 7
059 blK11 TBL.sh 10p_dgvmsc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7
061 smK17 TSM.sh 10p_dgvmsc_h clm_std 19981231:NONE:1800 48x96 gx3v5 -213 arb_ic ................FAIL! rc= 10
065 blK71 TBL.sh 10p_dgvmsc_s clm_std 19971231:NONE:1800 1x1_brazil navy -670 arb_ic ............FAIL! rc= 5
088 smL83 TSM.sh _sc_dh clm_std 19980115:DAILY:3600 5x5_amazon navy -10 arb_ic ..................FAIL! rc= 10
089 erL83 TER.sh _sc_dh clm_std 19980115:DAILY:3600 5x5_amazon navy -5+-5 arb_ic ................FAIL! rc= 5
090 brL83 TBR.sh _sc_dh clm_std 19980115:DAILY:3600 5x5_amazon navy -10+-10 arb_ic ..............FAIL! rc= 6
091 blL83 TBL.sh _sc_dh clm_std 19980115:DAILY:3600 5x5_amazon navy -10 arb_ic ..................FAIL! rc= 4
095 bl711 TBLtools.sh mksurfdata tools__ds namelist .............................................FAIL! rc= 7
097 bl771 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 7
  lightning/pathscale:
------>>>>>>> Bug 694
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11
025 smE13 TSM.sh 4p_vodsrsc_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 10
026 erE13 TER.sh 4p_vodsrsc_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ............FAIL! rc= 5
027 brE13 TBR.sh 4p_vodsrsc_do clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ............FAIL! rc= 5
029 smE16 TSM.sh 4p_vodsrsc_o clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ................FAIL! rc= 10
  lightning/ifort:
004 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 5
008 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 5
------>>>>>>> Bug 694
010 sm111 TSM.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 10
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 5
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 5
013 bl111 TBL.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 4
014 sm114 TSM.sh 4p_vodsr_h clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 10
016 erE11 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ............FAIL! rc= 13
017 brE11 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ............FAIL! rc= 11
018 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 5
  tempest:
009 smB11 TSMruncase.sh .........................................................................FAIL! rc= 4
------>>>>>>> Bug 694
011 er111 TER.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
012 br111 TBR.sh 4p_vodsr_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 24+24 arb_ic ..............FAIL! rc= 11
036 erE31 TER.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 10+38 arb_ic ....FAIL! rc= 7
037 brE31 TBR.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 24+24 arb_ic ....FAIL! rc= 6
045 smH01 TSM.sh 17p_cnnsc_h clm_std^nl_lfiles 19800101:NONE:1800 0.47x0.63 gx1v5@2000 48 startup FAIL! rc= 10

CLM tag used for the baseline comparison tests if applicable: clm3_5_19

Changes answers relative to baseline: Bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_5_19
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Thu Mar  6 14:52:17 MST 2008
One-line Summary: Change directory structure to mimic CCSM, fix so no NaNS on BGC interpinic output, new half degree CN clmi dataset

Purpose of changes: move cdir1_clm3_5_18 to trunk.  Get directory structure to look like CCSM.

    models ------------------------------ Model source code for each component
    models/lnd 
    models/lnd/clm ---------------------- CLM source code, build-scripts, tools, and testing
    models/lnd/clm/test/system ---------- CLM test scripts
    models/lnd/clm/tools ---------------- CLM tools
    models/lnd/clm/tools/mksurfdata
    models/lnd/clm/tools/ncl_scripts
    models/lnd/clm/tools/interpinic
    models/lnd/clm/tools/mkgriddata
    models/lnd/clm/tools/mkdatadomain
    models/lnd/clm/tools/cprnc
    models/lnd/clm/bld ------------------ CLM build scripts
    models/lnd/clm/bld/run-ibm.csh ------    sample CLM run script for the IBM
    models/lnd/clm/bld/urban_input
    models/lnd/clm/bld/usr.src
    models/lnd/clm/bld/perl5lib
    models/lnd/clm/doc ------------------ CLM documentation
    models/lnd/clm/doc/UsersGuide
    models/lnd/clm/doc/CodeReference
    models/lnd/clm/doc/Dev
    models/lnd/clm/src ------------------ CLM specific source code directories
    models/lnd/clm/src/biogeochem
    models/lnd/clm/src/main
    models/lnd/clm/src/riverroute
    models/lnd/clm/src/biogeophys
    models/ocn/socn --------------------- stub ocean model
    models/ice
    models/ice/sice --------------------- stub sea-ice model
    models/atm
    models/atm/datm7 -------------------- data atmosphere model
    models/atm/datm7/bld
    models/utils ------------------------ Utiltiies
    models/utils/esmf_wrf_timemgr -------    ESMF WRF time-manager API
    models/utils/timing -----------------    timing utiltities
    models/utils/mct --------------------    Model Coupling Toolkit
    models/utils/pio --------------------    Parallel I/O
    models/drv -------------------------- Sequential CCSM source code
    models/drv/seq_mct
    models/drv/seq_mct/driver
    models/csm_share -------------------- CCSM share code (shared between CCSM component models)
    scripts ----------------------------- CCSM build, run and testing scripts
    scripts/README ----------------------    ReadMe file on CCSM scripts
    doc --------------------------------- CCSM documentation (currently out of date)

    Changes so that interpinic doesn't output NaNS on AIX compiler for CN configuration.

    QUICKSTART: using the new CPL7 scripts:

         cd scripts
         ./create_newcase            # get help on how to run create_newcase
         ./create_newcase -case testI -mach blueice -res f19_g15 -compset I    # create new "I" case for blueice at 1.9x2.5_gx1v5 res
                                     # "I" case is clm active, datm7, and inactive ice/ocn
         cd testI
         configure -mach blueice     # create scripts
         testI.build                 # build model and create namelists
         bsub < testI.run            # submit script  
                                     # (NOTE: edit env_run to set RESUBMIT to number of times to automatically resubmit)

Bugs fixed (include bugzilla ID): 681 (archiving/resub), 696 (save datm7 files) , 707 (xlf90 bug with CAM)

Known bugs (include bugzilla ID): 251 (TwoStream), 672 (3.5.4-3.5.14 diffs), 680 (t0 precip diff for seq-ccsm), 
                                  694 (restarts for offline) , 697 (version etc.), 698 (cprnc bug), 701 (svn keyword), 
                                  708, (xlf bug on bluevista)
    http://bugs.cgd.ucar.edu/

    New bugs found: 708 -- bug with new xlf90 compiler on bluevista for CASA
                    710 -- Some variables are NaNS on clm.i output from CN configuration

    Known bugs that will NOT be resolved: 512 (mksurf on PGI), 546(interpinic for DGVM), 
                                          652 (threads different answers with older PGI versions)

Describe any changes made to build system: Changed to work with new directory structure
   (also works with any wildcard in clm "models/lnd/clm*" directory name)

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: Update half degree CN clmi file

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): drv (also add in CCSM doc and scripts directories as externals)
    doc_060127, seqmct45_scripts_080108, drvseq2_0_10

List all files eliminated: Files moved around extensively

List all files added and what they do: Files moved around extensively

List all existing files that have been modified, and describe the changes: Files moved around extensively

   models/lnd/clm/bld/DefaultCLM_INPARM_Namelist.xml --- change CN half degree clmi file 
   models/lnd/clm/bld/clm.cpl6.template ---------------- change assumed paths (use wildcard for models/lnd/clm*)
   models/lnd/clm/bld/clm.cpl7.template ---------------- change assumed paths (use wildcard for models/lnd/clm*)
   models/lnd/clm/bld/configure ------------------------ get to work in new directory structure
   models/lnd/clm/bld/run-ibm.csh ---------------------- fix archiving, and resubmit
   models/lnd/clm/bld/run-lightning.csh ---------------- fix archiving, and resubmit
   models/lnd/clm/bld/run-pc.csh ----------------------- fix archiving, and resubmit
   models/lnd/clm/src/main/clm_time_manager.F90 -------- make save statements explicit
   models/lnd/clm/tools/*/Makefile --------------------- change so CLM_ROOT is top of directory structure with 
                                                         models/lnd/clm* assumed below
   models/lnd/clm/tools/interpinic/interpinic.F90 ------ get numrad dimsize, on AIX check for NaNS and convert to spval,
                                                         if weights == 0 set values to spval
   models/lnd/clm/test/system/test_driver.sh ----------- new directory structure, update to ccsm3_9_beta03 and ccsm4_0_alpha25
   models/lnd/clm/test/system/TBL.sh ------------------- new directory structure
   models/lnd/clm/test/system/TBLtools.sh -------------- new directory structure
   models/lnd/clm/test/system/TSMncl_tools.sh ---------- new directory structure
   models/lnd/clm/test/system/TBR.sh ------------------- new directory structure
   models/lnd/clm/test/system/TER.sh ------------------- new directory structure
   models/lnd/clm/test/system/TSM.sh ------------------- new directory structure
   models/lnd/clm/test/system/TSMpergro.sh ------------- new directory structure
   models/lnd/clm/test/system/TSMtools.sh -------------- new directory structure
   models/lnd/clm/test/system/TSMcnspinup.sh ----------- new directory structure
   models/lnd/clm/test/system/TCBext_ccsmseq_cam.sh ---- new directory structure
   models/lnd/clm/test/system/TCBtools.sh -------------- new directory structure
   models/lnd/clm/test/system/TCText_ccsmcon.sh -------- new directory structure, add blueice

Summary of testing:

  bluevista: All PASS except
052 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
053 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5
054 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5
102 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
      CAM tests: All PASS except:
060 sm711 TSM.sh h5x8adm adia 9s ..................................FAIL! rc= 6
  blueice: 
     CPL7 test_scripts: ERS.f19_g15.I.blueice, ERB.f19_g15.I.blueice, ERS.f45_g35.I.blueice 
FAIL  ERB.f19_g15.I.blueice
     CPL6 test_scripts: PASS ERT_OS.f19_g15.I.blueice PASS  ERH_OS.T31_g35.ICN.blueice
  jaguarcnl: All PASS
  lightning: All PASS except
019 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
  bangkok/lf95: All PASS except
18 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
052 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  tempest: All PASS

CLM tag used for the baseline comparison tests if applicable: ccsm4_alpha25 with clm3_5_18 in place of default clm

Changes answers relative to baseline: No bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_5_18
Originator(s):  erik (Erik Kluzek)
Date: Thu Feb 21 22:57:39 MST 2008
One-line Summary: Update to latest seq-ccsm4.alpha tag

Purpose of changes: Get clm trunk to work with latest ccsm4.alpha24 tag

Bugs fixed (include bugzilla ID): 678 (get clm to work with latest cpl7)

Known bugs (include bugzilla ID): 251, 512, 546, 652, 672, 675, 676, 680, 
        681, 694, 696, 697, 698, 701, 702, 707, 708
    http://bugs.cgd.ucar.edu/

  New bugs: 697-- username,version,hostname NOT in seq-driver namelists
            707-- bug on new xlf90 compiler on bluevista for running with CAM
            708-- bug on new xlf90 compiler on bluevista for running with CASA

Describe any changes made to build system: minor change in configure script
  name of mode ext_cam changed to ext_ccsm_seq in configure script

Describe any changes made to the namelist: Sequential driver namelists change

ccsm_inparm namelist changes to seq_infodata_inparm 
   (remove restart_override, username, version, hostname)
timemgr_inparm namelist changes to seq_timemgr_inparm
   (remove restart_overrideTMG, stop_final_ymd [use stop_ymd instead] )

List any changes to the defaults for the boundary datasets: 
    Add 2.65x3.33 datasets, newer 1x1_brazil domain file

Describe any substantial timing or memory changes: None

Code reviewed by: mvertens (original version on seq branch)

List any svn externals directories updated (csm_share, mct, etc.): 

drv, datm7, sice, socn, csm_share_, and mct

src/drv	      drvseq2_0_07
src/datm7     drva_datm7_070824_tags/drva07_datm7_071129
src/sice      stubs1_0_7
src/socn      stubs1_0_7
src/csm_share drva_share3_070903_tags/loga25_share3_071107
src/utils/mct seqa_MCT2 _3_0_070524_tags/seqa07_MCT2_4_2_071026

List all files eliminated: None

List all files added and what they do:

A  +   bld/ExtSeqCCSMDrvInNamelistsDescriptions.xml -- for moving drv_in namelist items
A  +   bld/clm.cpl7.template ------------------------- for running with cpl7

List all existing files that have been modified, and describe the changes:

------------- Get external CAM tests working, and with changes to seq-ccsm
M      test/system/TSMext_ccsmseq_cam.sh
M      test/system/test_driver.sh
M      test/system/tests_posttag_hybrid_regression
M      test/system/tests_posttag_purempi_regression
M      test/system/nl_files/scam
M      test/system/nl_files/scam_prep
M      test/system/nl_files/ext_ccsm_seq_cam
M      test/system/TSM.sh

------------- Now need clm_varpar.F90 in tools
M      tools/mksurfdata/Srcfiles
M      tools/mkgriddata/Srcfiles

------------- Add ext_ccsm_seq, add 2.65x3.33 datasets, change for new seq-ccsm namelists
              switch 1x1_brazil domain file
M      bld/configure
M      bld/DefaultCLM_INPARM_Namelist.xml
M      bld/run-ibm.csh
M      bld/clm_inparm.pm
M      bld/DefaultTIMEMGR_INPARM_Namelist.xml
M      bld/sample.seqccsm.namelists
M      bld/run-pc.csh
M      bld/timemgr_inparm.pm
M      bld/DefaultCCSM_INPARM_Namelist.xml
M      bld/drv_in.pm
M      bld/run-lightning.csh
M      bld/mkSrcfiles
M      bld/SeqCCSM_namelist.pm
M      bld/ccsm_inparm.pm
M      bld/SeqCCSMDrvInNamelistsDescriptions.xml
M      bld/DefaultDATM_DSHR_NML_Namelist.xml

------------- Don't allow seq_ccsm datatypes to go below lnd_comp_mct, fix scam
M      src/main/clm_comp.F90 ------------- Remove SyncClock, CCSMInit
M      src/main/driver.F90 --------------- Remove SyncClock, CCSMInit
M      src/main/decompInitMod.F90 -------- Use endrun rather than shr_sys_abort
M      src/main/ncdio.F90 ---------------- fixes for scam
M      src/main/atmdrvMod.F90 ------------ remove unneeded printing
M      src/main/clmtypeInitMod.F90 ------- explicit use only's
M      src/main/initializeMod.F90 -------- remove CCSMInit and EClock
M      src/main/controlMod.F90 ----------- move initialization to timemgr/clm_varctl 
                                           set methods
M      src/main/clm_time_manager.F90 ----- Make namelist input private, add set method
M      src/main/clm_varctl.F90 ----------- Add set and initialization methods
M      src/main/clm_varorb.F90 ----------- Remove values not needed
M      src/main/lnd_comp_mct.F90 --------- Update to new structures/logic
                                           On time-step 0 also advance to time-step 1
M      src/main/program_off.F90 ---------- Move orbital info/dtime to this level
M      src/main/spmdMod.F90 -------------- Change print format
M      src/biogeophys/UrbanInputMod.F90 -- Initialize filename

Summary of testing:

  bluevista:
004 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 5
008 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 5
011 blD91 TBL.sh _persc_ds clm_per 19981231:YEARLY:1200 4x5 gx3v5 144 arb_ic ....................FAIL! rc= 5
014 blG71 TBL.sh 17p_sc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic .........FAIL! rc= 5
016 blH71 TBL.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic ......FAIL! rc= 5
021 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 5
026 blF27 TBL.sh 17p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..............FAIL! rc= 5 
031 blE31 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic
.......FAIL! rc= 5 
034 blCA1 TBL.sh _sc_ds clm_std^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
036 blNB1 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
040 blG41 TBL.sh 17p_sc_dh clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic ................FAIL! rc= 5
046 blH11 TBL.sh 17p_cnnsc_dh clm_std 19980101:MONTHLY:1800 48x96 gx3v5@1890 48 arb_ic ..........FAIL! rc= 5
050 blH52 TBL.sh 17p_cnnsc_dm clm_std 19980115:MONTHLY:1800 10x15 USGS@1890 48 arb_ic ...........FAIL! rc= 5
052 smJ11 TSM.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4 <<<< bug 708
053 erJ11 TER.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 10+38 arb_ic ...............FAIL! rc= 5 <<<< bug 708
054 brJ11 TBR.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 24+24 arb_ic ...............FAIL! rc= 5 <<<< bug 708
055 blJ11 TBL.sh 4p_casasc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 4
059 blK11 TBL.sh 10p_dgvmsc_dh clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 5
064 blK71 TBL.sh 10p_dgvmsc_s clm_std 19971231:NONE:1800 1x1_brazil navy -670 arb_ic ............FAIL! rc= 5
068 blL53 TBL.sh _sc_dh clm_std^nl_crcrop 19980115:MONTHLY:1800 10x15 USGS 24 arb_ic ............FAIL! rc= 5
072 blL63 TBL.sh _sc_h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup ..................FAIL! rc= 5
076 bl563 TBL.sh _h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup .....................FAIL! rc= 5
080 blL52 TBL.sh _sc_ds clm_std 19980115:MONTHLY:1800 10x15 USGS 24 arb_ic ......................FAIL! rc= 5
084 blL73 TBL.sh _sc_s clm_std 19980101:6_HOURLY:1800 1x1_brazil navy -10 arb_ic ................FAIL! rc= 5
089 blL83 TBL.sh _sc_dh clm_std 19980115:DAILY:3600 5x5_amazon navy -10 arb_ic ..................FAIL! rc= 5
101 sm921 TSMext_ccsmseq_cam.sh ext_ccsm_seq_4x5_dh ext_ccsm_seq_cam 48 .........................FAIL! rc= 4 <<<<< bug 707
102 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4 <<<<<< bug 707
  CAM tests all PASS except
060 sm711 TSM.sh h5x8adm adia 9s ..................................FAIL! rc= 6
062 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 5

First was a Build-namelist error, next was core-dump.

  tempest:
004 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 5
007 blD91 TBL.sh _persc_ds clm_per 19981231:YEARLY:1200 4x5 gx3v5 144 arb_ic ....................FAIL! rc= 5
010 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 5
014 blA92 TBL.sh _sc_dm clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 5
016 blG71 TBL.sh 17p_sc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic .........FAIL! rc= 5
018 blH71 TBL.sh 17p_cnnsc_ds clm_pftdyn 10001230:NONE:3600 1x1_tropicAtl test -100 arb_ic ......FAIL! rc= 5
  lightning/pathscale:
004 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 5
008 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 5
011 blCA1 TBL.sh _sc_ds clm_std^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
013 blCA2 TBL.sh _sc_ds clm_std^nl_urb 19971231:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
015 blNB1 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
017 blOC1 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 5
019 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<< bug 694
026 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic ................FAIL! rc= 5
031 blH52 TBL.sh 17p_cnnsc_dm clm_std 19980115:MONTHLY:1800 10x15 USGS@1890 48 arb_ic ...........FAIL! rc= 5
035 blK51 TBL.sh 10p_dgvmsc_dm clm_std 19981231:NONE:1800 10x15 USGS 48 arb_ic ..................FAIL! rc= 5
039 blL51 TBL.sh _sc_dh clm_std 19980115:MONTHLY:1800 10x15 USGS 48 arb_ic ......................FAIL! rc= 5
043 blL53 TBL.sh _sc_dh clm_std^nl_crcrop 19980115:MONTHLY:1800 10x15 USGS 24 arb_ic ............FAIL! rc= 5
047 blL73 TBL.sh _sc_s clm_std 19980101:6_HOURLY:1800 1x1_brazil navy -10 arb_ic ................FAIL! rc= 5
  jaguarcnl:
008 blA92 TBL.sh _sc_dm clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 7
012 blE12 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 7
016 blE32 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 7
020 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic ................FAIL! rc= 7
024 blH12 TBL.sh 17p_cnnsc_dm clm_std 19980101:MONTHLY:1800 48x96 gx3v5@1890 48 arb_ic ..........FAIL! rc= 7
028 blJ12 TBL.sh 4p_casasc_dm clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 7
  bangkok/lf95:
004 blA92 TBL.sh _sc_dm clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 7
008 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 7
011 blD91 TBL.sh _persc_ds clm_per 19981231:YEARLY:1200 4x5 gx3v5 144 arb_ic ....................FAIL! rc= 7
014 blCA2 TBL.sh _sc_ds clm_std^nl_urb 19971231:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 7
016 blOC1 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 7
018 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<<<< 694
025 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic ................FAIL! rc= 7
030 blH52 TBL.sh 17p_cnnsc_dm clm_std 19980115:MONTHLY:1800 10x15 USGS@1890 48 arb_ic ...........FAIL! rc= 7
034 blJ12 TBL.sh 4p_casasc_dm clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 7
038 blK51 TBL.sh 10p_dgvmsc_dm clm_std 19981231:NONE:1800 10x15 USGS 48 arb_ic ..................FAIL! rc= 7
042 blL51 TBL.sh _sc_dh clm_std 19980115:MONTHLY:1800 10x15 USGS 48 arb_ic ......................FAIL! rc= 7
047 blL73 TBL.sh _sc_s clm_std 19980101:6_HOURLY:1800 1x1_brazil navy -10 arb_ic ................FAIL! rc= 7
052 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4

TBL _sc tests fail because of addition of area-corrected fluxes and addition of running
  time-step 1 when time-step 0 is done on initialization.
er111/112 tests fail due to previous bug 694
sm921/982 test fail on bluevista due to new bug 707 on (compiler bug on bluevista)

CLM tag used for the baseline comparison tests if applicable: clm3_5_17

Changes answers relative to baseline: Yes -- greater than roundoff

  Summarize any changes to answers, i.e.,
    - what code configurations: Any mode with sequential-CCSM
    - what platforms/compilers: ALL
    - nature of change: larger than roundoff

Fluxes in driver are corrected by ratio's of area's from different components.
Also at time-step 0 you also run time-step 1 -- rather than just time-step 0.

===============================================================
===============================================================
Tag name:  clm3_5_17
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Wed Feb  6 10:10:17 MST 2008
One-line Summary: Merge Tony Craig's FMI branch fmi12_clm3_5_16 to the clm trunk

Purpose of changes: Reducing the debug level in some initialization routines, fixing a few diagnostics, 
        updating timers, improve the write_diagnostic performance, update of rtm init to improve scaling and performance.

Bugs fixed (include bugzilla ID): 597

Known bugs (include bugzilla ID): 251, 512, 546, 652, 672, 675, 676, 680, 681, 694, 696, 698, 701, 702
    http://bugs.cgd.ucar.edu/

    New bugs found: datm7 restart files NOT being archived (696), cprnc found to have problems (698),
    version autoinsertion in tools (701), test_driver times out on jaguar (702)

Describe any changes made to build system: Add BUILDPIO CPP variable

Describe any changes made to the namelist: Add new namelist variables dealing with PIO (see below)

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: erik,tcraig

List any svn externals directories updated (csm_share, mct, etc.): pio to pio11_prod

List all files eliminated: None

List all files added and what they do: None

List all existing files that have been modified, and describe the changes:

M      doc/UpDateChangeLog.pl ----------------- Tweak update of date to work correctly for both files
M      bld/run-frost.csh ---------------------- Tony gets working, add PIO build as commented out, turn querys off, put files
                                                in explicitly, tests new ncd_ options
M      src/biogeochem/STATICEcosysDynMod.F90 -- Add timers
M      src/main/clm_comp.F90 ------------------ Add timers
M      src/main/driver.F90 -------------------- Add timers, add barrier for diagnostics write, change send/recv into reduce (leave option for old code)
M      src/main/decompInitMod.F90 ------------- Reduce debug level for initialization
M      src/main/initializeMod.F90 ------------- Add timers
M      src/main/histFileMod.F90 --------------- PIO option
M      src/main/ncdio.F90 --------------------- Work for PIO, new options
M      src/main/gen_ncdio_global_subs.csh ----- Work for PIO, new options
M      src/main/gen_ncdio_local_subs.csh ------ Work for PIO, new options
M      src/main/controlMod.F90 ---------------- Add new namelist items

History experimental options (mostly for PIO which isn't fully implemented yet)

     o hist_pioflag           = logical true if want to turn on hist with pio                    [.FALSE., .TRUE.]
     o ncd_lowmem2d           = logical true if want to turn on low memory 2d writes in clm hist [.TRUE., .FALSE.]
     o ncd_pio_def            = logical true if want default pio use setting                     [.FALSE., .TRUE.]
     o ncd_pio_UseRearranger  = logical true if want to use MCT as Rearranger                    [.TRUE., .FALSE.]
     o ncd_pio_UseBoxRearr    = logical true if want to use box as Rearranger                    [.FALSE., .TRUE.]
     o ncd_pio_SerialCDF      = logical true if want to write with pio serial netcdf mode        [.FALSE., .TRUE.]
     o ncd_pio_IODOF_rootonly = logical true if want to write history in pio from root only      [.FALSE., .TRUE.]
     o ncd_pio_DebugLevel     = integer pio debug level                                          ( default 2)
     o ncd_pio_num_iotasks    = integer number of iotasks to use for PIO                         (default all PEs)

M      src/main/clm_varctl.F90 ----------------- New ncd and PIO history options
M      src/main/program_off.F90 ---------------- Add mpi barrier
M      src/main/areaMod.F90 -------------------- Improve performance/robustness
M      src/main/clm_mct_mod.F90 ---------------- Use pelocs
M      src/riverroute/RtmMod.F90 --------------- Add timers, update of rtm init to improve scaling and performance
M      test/system/test_driver.sh -------------- Fix for new account names on jaguar/phoenix

Summary of testing:

  bluevista: All PASS except
021 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 7
026 blF27 TBL.sh 17p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ..............FAIL! rc= 7
031 blE31 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 7
101 sm921 TSMext_ccsmseq_cam.sh ext_ccsm_seq_4x5_dh ext_ccsm_seq_cam 48 .........................FAIL! rc= 4
102 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  jaguarcnl: All PASS except
012 blE12 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 7
016 blE32 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 7
  bangkok/lf95: All PASS except
018 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
020 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7
051 sm951 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dm ext_ccsm_seq_cam 48 .......................FAIL! rc= 4
052 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  lightning/pathscale: All PASS except
019 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13
021 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7
  tempest:  All PASS except
010 blE11 TBL.sh 4p_vodsrsc_dh clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 7

er112, bl112, sm921, sm951, sm982 tests failed previously
other bl tests fail because of the changes in RTM

CLM tag used for the baseline comparison tests if applicable: clm3_5_16

Changes answers relative to baseline: Only RTM

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers:
    - what code configurations: RTM
    - what platforms/compilers: All
    - nature of change: Roundoff change

   If bitwise differences were observed, how did you show they were no worse
   than roundoff? Only fields with RTM show differences and only to roundoff level

 RMS DVOLRDT_ 8.8031E-22
 RMS DVOLRDT_ 3.4573E-23
 RMS QCHANR   3.6282E-16
 RMS QCHOCNR  5.4893E-17

The above is on bluevista after running for a day (other fields show RMS difference of zero)

===============================================================
===============================================================
Tag name:  clm3_5_16
Originator(s):  erik (Erik Kluzek)
Date: Mon Jan 28 15:00:53 MST 2008
One-line Summary: Get point version of Urban code onto trunk (urban code can not restart)

Purpose of changes: Move urban branch onto trunk. Fix bug so hv files are saved. Add
   high resolution datasets from Art Mirin.

   Urban code was started by Gordon Bonan, and taken up by Mariana Vertenstein and Keith Oleson.
   This represents work that has been ongoing for several years. Revision dates go back to
   before 2003.

   Some papers on the work are available from:

   Oleson et.-al. Journal of Applied Meteorology and Climatology, in-Press as of Jan/2008

   http://www.cgd.ucar.edu/tss/staff/oleson/publications/JAMC1597_rev_jul27_2007.pdf
   http://www.cgd.ucar.edu/tss/staff/oleson/publications/JAMC1598_rev_jul27_2007.pdf

Bugs fixed (include bugzilla ID): 644 (save hv files)

Known bugs (include bugzilla ID): 251, 512, 546, 652, 672, 675, 676, 680, 681, 694
    http://bugs.cgd.ucar.edu/

    New bug found from clm3_5_15 (694) -- restarts are NOT bit-for-bit on lightning and bangkok/lf95 for offline

Describe any changes made to build system: None

Describe any changes made to the namelist: Added furbinp -- for urban datasets

List any changes to the defaults for the boundary datasets: Added more urban datasets.
      Add 0.23x0.31 datasets from Art Mirin.

Describe any substantial timing or memory changes: Approx 1% slower, memory should be very close

Code reviewed by: oleson

List any svn externals directories updated (csm_share, mct, etc.): bld/archiving
    bld/archiving to scripts_080108

List all files eliminated: None

List all files added and what they do:

------ Urban point input datasets (ASCII)
A bld/urban_input/asphaltjungle_fluxes.txt
A bld/urban_input/metropolis_fluxes.txt
A bld/urban_input/mexicocityMEX_fluxes.txt
A bld/urban_input/vancouverCAN_fluxes.txt
----- Main urban source codes
A src/biogeophys/UrbanInitMod.F90
A src/biogeophys/UrbanInputMod.F90
A src/biogeophys/UrbanMod.F90
----- Add testing for urban code
A test/system/tests_posttag_urban ------ List of urban point tests
A test/system/nl_files/clm_urb1pt ------ Namelist options for CLM1PT datasets
A test/system/nl_files/nl_urb ---------- Urban namelist
A test/system/config_files/_mexsc_ds --- Mexicocity, MEX
A test/system/config_files/_vansc_ds --- Vancouver, CAN
----- Add tool to convert Urban point datasets to sequential-CCSM mode for datm7
A tools/ncl_scripts/convertUrbanOffline2Seq.ncl

List all existing files that have been modified, and describe the changes:

-------- Add in urban datasets to build-namelist
M bld/configure ---------------------------- Move subroutine definition to before first reference
M bld/datm_dshr_in.pm
M bld/clm_inparm.pm
M bld/datm.streams.template.xml ------------ Add in CLM1PT datasets for Urban
M bld/DefaultTIMEMGR_INPARM_Namelist.xml
M bld/DefaultSettings.xml
M bld/DefaultDATM_DSHR_NML_Namelist.xml
M bld/DefaultCLM_INPARM_Namelist.xml
M bld/timemgr_inparm.pm
M bld/run-pc.pm ---------------------------- Remove extra line, set mode in configure, add note about step=coupling step
M bld/run-ibm.pm --------------------------- Add note about step=coupling step
M bld/run-lightning.pm --------------------- Add note about step=coupling step
-------- source code changes to add in urban code
-------- mostly adding urban and non-urban filters
M src/biogeochem/DGVMMod.F90 --------------- Add urban filters
M src/main/atmdrvMod.F90 ------------------- Add RH and rainf, zero out solar if coszen<0, Urban pt CPPs 
M src/main/clm_varcon.F90 ------------------ Add PI, RGAS, SECSPDAY, urban PFT types, urban ponding depth
M src/main/clm_varpar.F90 ------------------ Add maxpatch_urb for 5 PFT's
M src/main/clm_atmlnd.F90 ------------------ Fill RH and rainf
M src/main/clmtype.F90 --------------------- Add urban state data
M src/main/clmtypeInitMod.F90 -------------- Initialize urban state data
M src/main/controlMod.F90 ------------------ Add furbinp namelist item for urban input data
M src/main/driver.F90 ---------------------- Pass urban filters, call urban modules
M src/main/filterMod.F90 ------------------- Add urban filters
M src/main/histFileMod.F90 ----------------- Add scale types needed for urban which needs to calculate area-averages based on urban input
M src/main/histFldsMod.F90 ----------------- Add new output fields: 

        BUILDHEAT     heat flux from urban building interior to walls and roof            W/m^2  active
        LWdown        atmospheric longwave radiation                                      W/m^2
        PSurf         surface pressure                                                    Pa
        Qh            sensible heat                                                       W/m^2
        Qle           total evaporation                                                   W/m^2
        Qstor         storage heat flux (includes snowmelt)                               W/m^2
        RH            atmospheric relative humidity                                       %
        Rainf         atmospheric rain                                                    mm/s
        Rnet          net radiation                                                       W/m^2
        SWdown        atmospheric incident solar radiation                                W/m^2
        TBUILD        internal urban building temperature                                 K      active
        TRAFFICFLUX   sensible heat flux from urban traffic                               W/m^2  active
        Tair          atmospheric air temperature                                         K
        WASTEHEAT     sensible heat flux from heating/cooling sources of urban waste heat W/m^2  active

(Fields not mentioned above as active are set to inactive unless asked for. They are "ALMA" variables needed for
 an urban model intercomparision project.)

M src/main/iniTimeConst.F90 ---------------- Initialize urban data
M src/main/initGridCellsMod.F90 ------------ Add initialization of urban landunits
M src/main/initSurfAlbMod.F90 -------------- Call urban albedo calc
M src/main/initializeMod.F90 --------------- Urban initialization
M src/main/lnd_comp_mct.F90 ---------------- Add saturation vapor calc to compute RH
M src/main/mkarbinitMod.F90 ---------------- Initialize urban state
M src/main/pftvarcon.F90 ------------------- Fix typo
M src/main/program_off.F90 ----------------- Pass declination angle from orbit to atmdrv (so solar can be nullified for coszen<0)
M src/main/subgridAveMod.F90 --------------- Setup grid info for urban
M src/main/subgridMod.F90 ------------------ Set urban landunit
M src/main/surfrdMod.F90 ------------------- Initialize urban weights -- remove old code that aborted if urban fraction>0
M src/biogeophys/BalanceCheckMod.F90 ------- Incoming rain does NOT include sun or shade wall, some checks only non-urban
M src/biogeophys/Biogeophysics1Mod.F90 ----- Take into account type of urban column
M src/biogeophys/Biogeophysics2Mod.F90 ----- Take into account type of urban column
M src/biogeophys/FrictionVelocityMod.F90 --- Change index and filters
M src/biogeophys/Hydrology1Mod.F90 --------- Take into account no water flow through urban buildings and impervious road
M src/biogeophys/Hydrology2Mod.F90 --------- Send urban filters down, and no water flow in certain urban column types
M src/biogeophys/SnowHydrologyMod.F90 ------ Urban similar to bare-soil landunit
M src/biogeophys/SoilHydrologyMod.F90 ------ Determine ponding limits for urban roof and impervious road, no runoff for sun/shade wall
M src/biogeophys/SoilTemperatureMod.F90 ---- Take into account that urban columns interact
M src/biogeophys/SurfaceAlbedoMod.F90 ------ Filter urban columns appropriately
M src/biogeophys/SurfaceRadiationMod.F90 --- Filter urban columns out
---------- Make MPI and OpenMP settings explicit in configuration files
M test/system/config_files/17p_vodsr_dm
M test/system/config_files/17p_vodsr_do
M test/system/config_files/4p_casa_m
M test/system/config_files/4p_casa_o
M test/system/config_files/17p_vodsr_m
M test/system/config_files/17p_vodsr_o
M test/system/config_files/4p_vodsr_dm
M test/system/config_files/17p_cnn_m
M test/system/config_files/4p_vodsr_do
M test/system/config_files/17p_cnn_o
M test/system/config_files/17p_cnn_dm
M test/system/config_files/17p_cnn_do
M test/system/config_files/10p_dgvm_m
M test/system/config_files/4p_casa_dm
M test/system/config_files/10p_dgvm_o
M test/system/config_files/4p_casa_do
M test/system/config_files/10p_dgvm_dm
M test/system/config_files/README
M test/system/config_files/10p_dgvm_do
M test/system/config_files/4p_vodsr_m
M test/system/config_files/4p_vodsr_o
---------- Add urban tests to testing system
M test/system/input_tests_master
M test/system/README.testnames
M test/system/mknamelist
M test/system/test_driver.sh
M test/system/tests_posttag_bangkok
M test/system/tests_posttag_blueice
M test/system/tests_posttag_lightning
M test/system/tests_posttag_hybrid_regression
M test/system/tests_posttag_purempi_regression
M test/system/tests_pretag_bangkok
M test/system/tests_pretag_bluevista
---------- Put options on separate lines, explicitly set source
M test/system/nl_files/clm_pftdyn
M test/system/nl_files/clm_per
M test/system/nl_files/clm_per0
M test/system/nl_files/clm_std
---------- Add note about need of other directories to build
M tools/ncl_scripts/README ---------------------- Also add note about new script
M tools/mksurfdata/README
M tools/ncl_scripts/README
M tools/interpinic/README
M tools/mkgriddata/README
M tools/mkdatadomain/README


Summary of testing:

  bluevista: All PASS except
034 blCA1 TBL.sh _sc_ds clm_std^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
036 blNB1 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
076 bl563 TBL.sh _h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup .....................FAIL! rc= 7
101 sm921 TSMext_ccsmseq_cam.sh ext_ccsm_seq_4x5_dh ext_ccsm_seq_cam 48 .........................FAIL! rc= 4
102 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  tempest:   ALL PASS
  jaguarcnl: All PASS except TBL tests which fail because of a problem with the previous version on jaguar.
004 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...................FAIL! rc= 4
008 blA92 TBL.sh _sc_dm clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .........................FAIL! rc= 5
012 blE12 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic ...............FAIL! rc= 5
016 blE32 TBL.sh 4p_vodsrsc_dm clm_std 19981231:YEARLY:1800 64x128^360x720 USGS 48 arb_ic .......FAIL! rc= 5
020 blG42 TBL.sh 17p_sc_dm clm_pftdyn 10001230:MONTHLY:1800 10x15 USGS 48 arb_ic ................FAIL! rc= 5
024 blH12 TBL.sh 17p_cnnsc_dm clm_std 19980101:MONTHLY:1800 48x96 gx3v5@1890 48 arb_ic ..........FAIL! rc= 5
028 blJ12 TBL.sh 4p_casasc_dm clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic ..................FAIL! rc= 5
032 blK12 TBL.sh 10p_dgvmsc_dm clm_std 19981231:NONE:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 5
  bangkok/lf95: All PASS except
014 blCA2 TBL.sh _sc_ds clm_std^nl_urb 19971231:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
016 blOC1 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 5
018 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<<
020 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7
051 sm951 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dm ext_ccsm_seq_cam 48 .......................FAIL! rc= 4
052 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4

  lightning/pathf90: All PASS except
011 blCA1 TBL.sh _sc_ds clm_std^nl_urb 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic ..........FAIL! rc= 5
013 blCA2 TBL.sh _sc_ds clm_std^nl_urb 19971231:NONE:3600 1x1_asphaltjungleNJ navy -90 arb_ic ...FAIL! rc= 5
015 blNB1 TBL.sh _mexsc_ds clm_urb1pt^nl_urb 19931201:NONE:3600 1x1_mexicocityMEX navy 159 arb_ic FAIL! rc= 5
017 blOC1 TBL.sh _vansc_ds clm_urb1pt^nl_urb 19920812:NONE:3600 1x1_vancouverCAN navy 330 arb_ic FAIL! rc= 5
019 er112 TER.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 10+38 arb_ic ..............FAIL! rc= 13 <<<<
021 bl112 TBL.sh 4p_vodsr_dm clm_std 19981231:YEARLY:1800 48x96 gx3v5 48 arb_ic .................FAIL! rc= 7


Urban TBL point tests do NOT pass because previous model version didn't have urban enabled.
cam standalone tests require the ccsm4_alpha series version of clm.
<<<<< Tests are the 694 bug found in clm3_5_15.


CLM tag used for the baseline comparison tests if applicable: clm3_5_15

Changes answers relative to baseline: None  bit-for-bit
   (except albedo's will be different when running in offline mode see below)

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: All mode=offline
    - what platforms/compilers: All
    - nature of change: Solar now set to zero when coszen<0, which influences
        some non-common instances near twilight when the dataset shows solar>0
        but coszen<0. It doesn't change the model results -- because everything is
        reflected anyway, but it will change how albedo is averaged over those periods.

===============================================================
===============================================================
Tag name:  clm3_5_15
Originator(s):  erik (Erik Kluzek)
Date: Fri Dec 21 20:33:01 MST 2007
One-line Summary: Fix interpinic for half degree grid, add in large-file support, allow configure to work with ccsm directory structure

Purpose of changes:

Change configure so it will work with the ccsm4_alpha directory structure (especially for
the test suite). Add in large-file support for main code as well as tools (mksurfdata). 
Add in tests for create_croplandunit and large-file support. Get interpinic to work for 
half degree, and optimize and verify it's use of Open-MP. Add tool to interpolate
Nitrogen deposition files (ndepregrid.ncl). Update run scripts with suggestions from Sam
(and fix a couple of minor bugs).

interpinic problem: Previous version may have incorrectly found nearest points for PFT data.
  Data would have been valid -- but possibly NOT from the nearest point.
  There was also a potential Open-MP problem where answers could change depending on the 
  number of threads used. The new version corrects both of these problems. The new version
  should be used to interpolate critical datasets.

Bugs fixed (include bugzilla ID): 656 (interpinic), 660 (large-file), 674 (diff -q in run script), 679 (testing task/thread change)

Known bugs (include bugzilla ID): 251, 512, 546, 652, 664, 672, 675, 676
    http://bugs.cgd.ucar.edu/

Describe any changes made to build system: Remove mpi include/lib for jaguarcnl
 (as already included with the ftn command)

  Make ccsm_seq	-- the default way to run.

Describe any changes made to the namelist: Add outnc_large_files option

 outnc_large_files --- TRUE => use NetCDF 64-bit large file format for output files
                       (history and restart files)

 The NetCDF 64-bit large file format became available in NetCDF3.6.0 and allows larger dimensions as well as allowing
 output files > 2 GBytes. For more info. on Large File Support (LFS) for NetCDF see...

	http://www.unidata.ucar.edu/software/netcdf/docs/faq.html#lfs

 Since, file offsets are stored with 64-bit words rather than 32-bit words -- file sizes may change slightly with LFS.

List any changes to the defaults for the boundary datasets:

	Added in new clmi files:

+<finidat RESOLUTION="0.47x0.63"  mask="gx1v5" BGC="cn" ic_ymd="19800101"
+ic_tod="0">lnd/clm2/initdata/clmi.BCN.1980-01-01-00000.071207.nc
+<finidat RESOLUTION="1.9x2.5"   mask="gx1v5" BGC="none" ic_ymd=     "101" ic_tod="0">lnd/clm2/initdata/clmi.F_0000-01-01_1.9x2.5_gx1v5_c071203.nc
+<finidat RESOLUTION="1.9x2.5"   mask="gx1v5" BGC="none" ic_ymd=     "901" ic_tod="0">lnd/clm2/initdata/clmi.F_0000-09-01_1.9x2.5_gx1v5_c071203.nc

	Added in ndep files at half degree

+<fndepdat RESOLUTION="0.47x0.63" BGC="cn" sim_year="2100" >lnd/clm2/ndepdata/ndep_clm_2100_0.47x0.63_c071213.nc</fndepdat>
+<fndepdat RESOLUTION="0.47x0.63" BGC="cn" sim_year="2000" >lnd/clm2/ndepdata/ndep_clm_2000_0.47x0.63_c071213.nc</fndepdat>
+<fndepdat RESOLUTION="0.47x0.63" BGC="cn" sim_year="1890" >lnd/clm2/ndepdata/ndep_clm_1890_0.47x0.63_c071213.nc</fndepdat>
+<fndepdyn RESOLUTION="0.47x0.63" BGC="cn" >lnd/clm2/ndepdata/fndep_clm_1890-2100_0.47x0.63_c071213.nc</fndepdyn>

        Add documentation and delete extra variables from T42 base ndep datasets

+<fndepdat RESOLUTION="64x128"    BGC="cn" sim_year="2100" >lnd/clm2/ndepdata/ndep_clm_2100_64x128_c071221.nc</fndepdat>
+<fndepdat RESOLUTION="64x128"    BGC="cn" sim_year="2000" >lnd/clm2/ndepdata/ndep_clm_2000_64x128_c071221.nc</fndepdat>
+<fndepdat RESOLUTION="64x128"    BGC="cn" sim_year="1890" >lnd/clm2/ndepdata/ndep_clm_1890_64x128_c071221.nc</fndepdat>

	Added in urban testing dataset

+<fsurdat RESOLUTION="1x1_camdenNJ"  >lnd/clm2/surfdata/surfdata_1x1pt_camdenNJ_navy_070824.nc</fsurdat>
+<fatmgrid RESOLUTION="1x1_camdenNJ"  >lnd/clm2/griddata/griddata_1x1pt_camdenNJ_navy_070824.nc</fatmgrid>
+<fatmlndfrc RESOLUTION="1x1_camdenNJ"  mask="navy">lnd/clm2/griddata/fracdata_1x1pt_camdenNJ_navy_070824.nc


Describe any substantial timing or memory changes: None

Code reviewed by:  slevis (interpinic, run-ibm.csh), 
                   thornton (ndepregrid.ncl, outnc_large_files option)

List any svn externals directories updated (csm_share, mct, etc.):
  perl5lib to perl5lib_071204 which includes new Decomp module.

List all files eliminated: None

List all files added and what they do:

Add files for testing different tool configurations and ncl scripts, and for testing of 
create_crop_landunit, large_file support, and an urbin test. Also change offline configuration
files so they have offline explicitly set as the mode.

A  +   test/system/config_files/tools__ds
A  +   test/system/config_files/tools__o
A  +   test/system/TSMncl_tools.sh
A  +   test/system/nl_files/nl_crcrop
A  +   test/system/nl_files/nl_std
A  +   test/system/nl_files/nl_lfiles

Add ncl script to regrid Nitrogen deposition files

A  +   tools/ncl_scripts
A  +   tools/ncl_scripts/README
A  +   tools/ncl_scripts/ndepregrid.ncl
A  +   tools/mkgriddata/mkgriddata.ccsm_dom  ------ add sample script for using CCSM domain files

List all existing files that have been modified, and describe the changes:


	Testing system updates...

M      test/system/config_files/*  <-- offline configure files -- explicitly set offline mode
M      test/system/config_files/README
M      test/system/tests_posttag_spot1
M      test/system/tests_pretag_jaguar
M      test/system/README.testnames
M      test/system/tests_pretag_bangkok
M      test/system/TCBtools.sh
M      test/system/test_driver.sh
M      test/system/mknamelist
M      test/system/tests_posttag_hybrid_regression
M      test/system/tests_posttag_purempi_regression
M      test/system/tests_pretag_tempest
M      test/system/tests_pretag_bluevista
M      test/system/tests_posttag_blueice
M      test/system/input_tests_master
M      test/system/README
M      test/system/TSMtools.sh
M      test/system/TCBext_ccsmseq_cam.sh
M      test/system/tests_posttag_lightning
M      test/system/TBLtools.sh
M      test/system/TSM.sh

	Update tools makefile and change svn keyword strings

M      tools/mksurfdata/mkvarctl.F90
M      tools/mksurfdata/README
M      tools/mksurfdata/mkfileMod.F90
M      tools/mksurfdata/mksrfdat.F90
M      tools/mksurfdata/Makefile
M      tools/interpinic/interpinic.F90
M      tools/interpinic/Srcfiles
M      tools/interpinic/Makefile
M      tools/mkgriddata/creategridMod.F90
M      tools/mkgriddata/Makefile
M      tools/mkdatadomain/Makefile
M      tools/README

M      bld/configure ---------------------- changes to work with ccsm4.alpha directory structure, and jaguarcnl
M      bld/DefaultCLM_INPARM_Namelist.xml - Add new datasets
M      bld/Makefile.in -------------------- changes needed for jaguarcnl and Darwin
M      bld/scpDefaultNamelist.pl ---------- extend to work with ndep files
       Make changes to run scripts -- move section of things to change to top
       Remove stuff not used. Add more documentation. Add suggestions from Sam Levis.
M      bld/run-ibm.csh -------------------- remove -q option to diff 
M      bld/run-lightning.csh -------------- add bit about comparing rpointer files to see if advancing from run-ibm.csh
M      bld/run-pc.csh --------------------- add bit about comparing rpointer files to see if advancing from run-ibm.csh

	Add large-file support

M      src/biogeochem/CASAMod.F90
M      src/biogeochem/DGVMMod.F90
M      src/main/ncdio.F90
M      src/main/restFileMod.F90
M      src/main/controlMod.F90
M      src/main/clm_varctl.F90

Summary of testing:

  tempest: All PASS
  bluevista: All PASS, except
033 smEA1 TSM.sh _sc_ds clm_std 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic .................FAIL! rc= 10 --> Urban not active yet
034 blEA1 TBL.sh _sc_ds clm_std 19981001:NONE:3600 1x1_camdenNJ navy -90 arb_ic .................FAIL! rc= 4 ---> Urban not active yet
066 blL53 TBL.sh _sc_dh clm_std^nl_crcrop 19980115:MONTHLY:1800 10x15 USGS 24 arb_ic ............FAIL! rc= 5 ---> New test
070 blL63 TBL.sh _sc_h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup ..................FAIL! rc= 7 ---> New clmi file
074 bl563 TBL.sh _h clm_std 19980101:MONTHLY:1800 1.9x2.5 gx1v5 -10 startup .....................FAIL! rc= 7 ---> New clmi file
092 bl711 TBLtools.sh mksurfdata tools__ds namelist .............................................FAIL! rc= 4 ---> Test changed
094 bl771 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 4 ---> Test changed
099 sm921 TSMext_ccsmseq_cam.sh ext_ccsm_seq_4x5_dh ext_ccsm_seq_cam 48 .........................FAIL! rc= 4
100 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4
  jaguarcnl: ALL PASS, except TBL tests because previous code didn't run on jaguar with recent changes
  lightning: ALL PASS, except
035 blL53 TBL.sh _sc_dh clm_std^nl_crcrop 19980115:MONTHLY:1800 10x15 USGS 24 arb_ic ............FAIL! rc= 5 ---> New test
042 bl771 TBLtools.sh mksurfdata tools__ds singlept .............................................FAIL! rc= 5 ---> New test
  bangkok/lf95: All PASS, except
047 sm951 TSMext_ccsmseq_cam.sh ext_ccsm_seq_10x15_dm ext_ccsm_seq_cam 48 .......................FAIL! rc= 4
048 sm982 TSCext_ccsmseq_scam.sh ext_ccsm_seq_64x128_s scam_prep scam_ds scam 3 .................FAIL! rc= 4

  CAM tests fail because of incomptabilities of csm_share code.

CLM tag used for the baseline comparison tests if applicable: clm3_5_14

Changes answers relative to baseline: None -- bit-for-bit

===============================================================
===============================================================
Tag name:  clm3_5_14
Originator(s):  erik (Erik Kluzek)
Date: Thu Nov 29 12:18:47 MST 2007
One-line Summary: Use build-streams, and archiving, multiple bug-fixes

Purpose of changes: Move bstrms5_clm3_5_13 to trunk

Remove long-term archiving from clm code. Use Mat's long-term and short-term archiving 
scripts like cam. Short term script runs at the end of your run script -- then the 
long-term archiving script is submitted to the batch que at the end. Update to newer 
version of csm_share that doesn't have any mss_ options. Tune usage of build-namelist. 
Make streams file on the fly. Remove references to get_env and $HEADUrl$. Fix interpinic 
for CASA and RTM (from Sam). Change testing from being done in offline mode to 
seq_ccsm mode. Make default in run scripts to run seq_ccsm mode. Add option to run scripts
to resubmit itself until reaches a given model date.

Add in HCSOI and HCSOISNO from Dave Lawrence. Add PERGRO test to test suite. Simple PERGRO
fix from Jerry Olson. Use branch of driver code for seq-ccsm and removing archiving. Add 
in lnd_comp_mct changes from ccsm4.alpha series.

Bugs fixed (include bugzilla ID): 449 (create_crop), 548 (rm getenv), 579 (cam config),
                                  595 (interpic-RTM), 608 (interpic-CASA), 618 (hist-files)
                                  622 (ensures needed vars on input), 624 (compiles on ifort)
                                  632 (GREGORIAN), 636 (archiving)

Bug fixes: history,restart-override,missing-vars on input
datasets,more-grids,intel-compile,add-g95,remove getenv,add version,hostname etc. to
files from CCSMInit namelist,add auto-restart option,GREGORIAN bug,fix
create_croplandunit bug

Known bugs (include bugzilla ID): 251, 512, 546, 652, 656
                                  http://bugs.cgd.ucar.edu/

Describe any changes made to build system: Use build-streams for sequential-CCSM
  Builds the streams files on the fly. This allows running data over any period.
  Add usecase option to build-namelist to set multiple things (currently only implementing pergro and pergro0)
  Add notes to namelist files generated with build-namelist so can reconstruct.
  See details of new build-namelist options in documentation on build-namelist below.

Describe any changes made to the namelist: 
   Remove mss options (mss_irt, mss_wpass and archive_dir)
   Remove ability to change restart pointer filename (rpntpath)
   Add version, hostname, username, stop_final_ymd
   Actually use pertlim for arbitrary initial conditions if > 0

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.):

   csm_share to share3_071107
   stubs     to stubs1_0_6
   drv       to clm_branch_tags/clm02_drvseq1_044
   datm7     to datm7_071114
   perl5lib  to perl5lib_071016

List all subroutines eliminated: None

List all subroutines added and what they do:

     --------- Add files for sequential-CCSM testing
A  +   test/system/config_files/17p_cnexitspinupsc_dh
A  +   test/system/config_files/_persc_dh
A  +   test/system/config_files/_persc_dm
A  +   test/system/config_files/4p_vodsrsc_dh
A  +   test/system/config_files/_persc_ds
A  +   test/system/config_files/17p_cnnsc_h
A  +   test/system/config_files/4p_vodsrsc_dm
A  +   test/system/config_files/17p_sc_dh
A  +   test/system/config_files/17p_cnnsc_m
A  +   test/system/config_files/4p_vodsrsc_do
A  +   test/system/config_files/17p_cnnsc_o
A  +   test/system/config_files/10p_dgvmsc_h
A  +   test/system/config_files/4p_casasc_dh
A  +   test/system/config_files/17p_sc_dm
A  +   test/system/config_files/17p_sc_do
A  +   test/system/config_files/10p_dgvmsc_m
A  +   test/system/config_files/4p_casasc_dm
A  +   test/system/config_files/10p_dgvmsc_o
A  +   test/system/config_files/17p_sc_ds
A  +   test/system/config_files/4p_casasc_do
A  +   test/system/config_files/10p_dgvmsc_s
A  +   test/system/config_files/17p_cnsc_dh
A  +   test/system/config_files/17p_sc_h
A  +   test/system/config_files/4p_casasc_h
A  +   test/system/config_files/17p_sc_m
A  +   test/system/config_files/17p_sc_o
A  +   test/system/config_files/_sc_h
A  +   test/system/config_files/4p_casasc_m
A  +   test/system/config_files/4p_casasc_o
A  +   test/system/config_files/_sc_m
A  +   test/system/config_files/17p_vodsrsc_h
A  +   test/system/config_files/_sc_o
A  +   test/system/config_files/17p_vodsrsc_m
A  +   test/system/config_files/_sc_s
A  +   test/system/config_files/17p_vodsrsc_o
A  +   test/system/config_files/17p_cnadspinupsc_dh
A  +   test/system/config_files/17p_cnnsc_dh
A  +   test/system/config_files/17p_cnnsc_dm
A  +   test/system/config_files/17p_cnnsc_do
A  +   test/system/config_files/10p_dgvmsc_dh
A  +   test/system/config_files/17p_cnnsc_ds
A  +   test/system/config_files/10p_dgvmsc_dm
A  +   test/system/config_files/17p_vodsrsc_dh
A  +   test/system/config_files/10p_dgvmsc_do
A  +   test/system/config_files/17p_vodsrsc_dm
A  +   test/system/config_files/17p_vodsrsc_do
A  +   test/system/config_files/4p_vodsrsc_h
A  +   test/system/config_files/4p_vodsrsc_m
A  +   test/system/config_files/4p_vodsrsc_o
A  +   test/system/tests_posttag_spot1 ----------------- Add testing for my laptop
     --------- PERGRO testing
A  +   test/system/nl_files/clm_per
A  +   test/system/nl_files/clm_per0
A  +   test/system/TSMpergro.sh
A  +   bld/use_cases
A  +   bld/use_cases/pergro.nl
A  +   bld/use_cases/pergro0.nl
     --------- cpl6 template
A  +   bld/clm.cpl6.template
     --------- build-streams
A  +   bld/streams.txt.readme ---------------- Readme file for build-streams
A  +   bld/datm.streams.template.xml --------- XML template for streams file
A  +   bld/build-streams --------------------- Script to build streams file to list input datasets used for datm7

List all existing files that have been modified, and describe the changes:

     --------- Change testing to use sequential CCSM rather than offline add pergro tests
     --------- Add ifort for lightning and jaguarcnl to testing options
M      test/system/config_files/_per_dh
M      test/system/config_files/_per_dm
M      test/system/config_files/_per_ds
M      test/system/tests_posttag_phoenix
M      test/system/tests_pretag_jaguar
M      test/system/TBR.sh
M      test/system/tests_pretag_bangkok
M      test/system/test_driver.sh --------------------- Add jaguarcnl option and get it working
M      test/system/mknamelist
M      test/system/tests_posttag_hybrid_regression
M      test/system/tests_posttag_purempi_regression
M      test/system/tests_pretag_tempest
M      test/system/tests_pretag_bluevista
M      test/system/tests_posttag_blueice
M      test/system/input_tests_master
M      test/system/tests_posttag_robin
M      test/system/TCBext_ccsmseq_cam.sh
M      test/system/tests_posttag_lightning
M      test/system/CLM_runcmnd.sh --------------------- Change for jaguarcnl
M      test/system/TSM.sh ----------------------------- Change restart pointer filenames
     --------- Add ignore of *.o and *.mod files to tools, change source files list for new csm_share
 M     tools/mksurfdata
 M     tools/mksurfdata/mkfmax.F90 ------- remove executable property
M      tools/mksurfdata/Srcfiles
 M     tools/interpinic
M      tools/interpinic/interpinic.F90 --- fix for CASA and RTM (from Sam)
 M     tools/mkgriddata
M      tools/mkgriddata/Srcfiles
 M     tools/mkdatadomain
     --------- Put calls to archiving scripts add resubmit option and make ccsm_seq the default
M      bld/run-ibm.csh
M      bld/run-frost.csh
M      bld/run-pc.csh
M      bld/run-lightning.csh
     --------- Tweak build for using build-streams and changes to csm_share and to use seq_ccsm
     --------- Add script calls for archiving remove code for archiving
     --------- Add option to resubmitting to a given model date to run scripts
M      bld/configure -------------------------------- refactor validation
M      bld/Makefile.in ------------------------------ add ifort and g95
M      bld/namelist.pm ------------------------------ add method to write notes on output namelist files
M      bld/clm_inparm.pm ---------------------------- fix setting of pftcon and only die if arb_ic set and finidat /= ""
M      bld/queryDefaultXML.pm ----------------------- allow to read CAM config_cache file
M      bld/datm_dshr_in.pm
M      bld/sample.seqccsm.namelists
M      bld/CLMDrvInNamelistsDescriptions.xml
M      bld/drv_in.pm
M      bld/CCSMDrvInNamelistsDescriptions.xml
M      bld/SeqCCSM_namelist.pm
M      bld/SeqCCSMDrvInNamelistsDescriptions.xml
M      bld/DefaultDATM_DSHR_NML_Namelist.xml
M      bld/create_newcase --------------------------- change so changes all occurances of script name, output script has exec set.
M      bld/build-namelist --------------------------- add cam options, and options needed for building streams files

      -cam_config "file"      Read the CAM config cache file (rather than the CLM version) to get
                              build-time configuration information.
                              (Default -- not used.)
      -cam_hist_case "caseid" Use the input CAM simulation caseid to build a streams file with that case id.
                              (Default -- not used).
      -datm_data_dir "path"   Directory path to the datm data
                              (only used when mode=ccsm_seq)
      -datm_domain "file"     File name of domain file for datm data matching resolution data resolution.
                              (only used when mode=ccsm_seq)
      -datm_dom_dir "path"    Directory path to the datm_domain file.
                              (only used when mode=ccsm_seq)
      -source "source"        Source data to use for datm (for ccsm_seq mode)
      -use_case "case"        Specify a use case which will provide default values. (pergro or pergro0)
                  
     --------- Source code changes
     --------- Call endrun if needed input information isn't on input files
     --------- remove archiving in code and remove getenv -- use info on shr_inputinfo object
     --------- Add PERGRO changes and do perturbation if pertlim > 0
     --------- changes from CCSM4-alpha branch
     --------- Add hc_soi and hc_soisno
M      src/biogeochem/CASAMod.F90
M      src/biogeochem/STATICEcosysDynMod.F90
M      src/biogeochem/DGVMMod.F90
M      src/main/ncdio.F90
M      src/main/atmdrvMod.F90
M      src/main/initializeMod.F90 -------------- Call pftconrd here rather than in iniTimeConst, CCSM4-alpha changes
M      src/main/clmtypeInitMod.F90 ------------- Add hc_soi and hc_soisno
M      src/main/pftdynMod.F90
M      src/main/iniTimeConst.F90 --------------- Remove pftconrd call from here to initializeMod
M      src/main/histFileMod.F90 ---------------- Fix history problem so can put additional fields on files, remove archiving, use shr_info
M      src/main/restFileMod.F90
M      src/main/controlMod.F90 ----------------- Add new input for offline/ccsm_con modes, remove archiving
M      src/main/clm_time_manager.F90
M      src/main/clm_varctl.F90 ----------------- Add version, hostname, username, source and conventions
M      src/main/ndepFileMod.F90
M      src/main/lnd_comp_mct.F90 --------------- CCSM4-alpha changes add runoff
M      src/main/surfrdMod.F90
M      src/main/gen_ncdio_local_subs.csh
M      src/main/do_close_dispose.F90
M      src/main/clmtype.F90 -------------------- Add hc_soi and hc_soisno
M      src/main/histFldsMod.F90 ---------------- Add hc_soi and hc_soisno
M      src/main/mkarbinitMod.F90 --------------- Add pertlim to initial conditions if non-zero
M      src/biogeophys/SoilTemperatureMod.F90 --- Add hc_soi and hc_soisno
M      src/biogeophys/Biogeophysics1Mod.F90 ---- PERGRO #ifdef from Jerry Olson
M      src/biogeophys/BiogeophysicsLakeMod.F90 - Add hc_soisno

Summary of testing:

  bluevista:    All PASS except CAM, CCSM_con and TBL tests
  lightning:    All PASS except TBL tests
  jaguarcnl:    All PASS except TBL tests
  bangkok/lf95: All PASS except CAM and TBL tests

  CAM and CCSM_con tests fail because of incomptabilities of csm_share code.
  TBL tests fail -- because new tests are all with sequential-CCSM which didn't work in previous tag.

CLM tag used for the baseline comparison tests if applicable: clm3_5_13 
    (with testing changes and other changes to work)

Changes answers relative to baseline: None

	To verify bit-for-bit ran standard offline test case (bl111) on: tempest, bluevista, bangkok
	(pass on bangkok, and bluevista -- but failed on tempest)

===============================================================
===============================================================
Tag name:  clm3_5_13
Originator(s):  erik (Erik Kluzek)
Date:  Fri Nov 16 10:17:38 MST 2007
One-line Summary: Update xml file with file needed for ccsm3_5_beta18

Describe any changes made to build system: Add models/utils/perl5lib to path for perl tools

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: New 0.47x0.63 fraction
  dataset compatible with CCSM datasets

Describe any substantial timing or memory changes: None

List any svn externals directories updated (csm_share, mct, etc.): None

List all subroutines eliminated: None

List all subroutines added and what they do:

A      bld/scpDefaultNamelist.pl -- Script to help copy files in xml database.

List all existing files that have been modified, and describe the changes:

M      bld/configure --- add models/util to path
M      bld/DefaultCLM_INPARM_Namelist.xml -- add new file
M      bld/queryDefaultNamelist.pl --- add models/util to path
M      bld/build-namelist --- add models/util to path

Summary of testing: None

Changes answers relative to baseline: No

===============================================================
===============================================================
Tag name:  clm3_5_12
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date:  Thu Nov  8 13:49:25 MST 2007
One-line Summary: Tag with new files needed for ccsm3_5_beta17

Purpose of changes: Add new files needed for new resolutions being adding in ccsm3_5_beta17

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: Small changes to configure from bstrms branch

Describe any changes made to the namelist: Add new files to Default*.xml files

List any changes to the defaults for the boundary datasets: New resolutions added

Describe any substantial timing or memory changes: None

List any svn externals directories updated (csm_share, mct, etc.): None

List all existing files that have been modified, and describe the changes:

Move files over from the bstrms3_clm3_5_11 branch with the new resolutions needed.

M      bld/configure
M      bld/DefaultCLM_INPARM_Namelist.xml
M      bld/DefaultDATM_NML_Namelist.xml
M      bld/DefaultSettings.xml
M      bld/DefaultTIMEMGR_INPARM_Namelist.xml
M      bld/DefaultPROF_INPARM_Namelist.xml
M      bld/queryDefaultNamelist.pl
M      bld/DefaultCCSM_INPARM_Namelist.xml
M      bld/build-namelist
M      bld/DefaultDATM_DSHR_NML_Namelist.xml

Summary of testing: None

Changes answers relative to baseline: None
	
===============================================================
===============================================================
Tag name:  clm3_5_11
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Fri Sep 28 12:03:30 MDT 2007
Date:One-line Summary: Update datasets in the DefaultCLM file for 0.23x0.31, 0.47x0.63, 0.9x1.25 and add fndepdyn file for 1.9x2.5

Purpose of changes: Needed for CCSM 20th Century simulation needed for ccsm3_5_beta13

Bugs fixed (include bugzilla ID): 585, 589, 593, 611

	Add T42_gx1v5, 0.9x1.25_gx1v5 support.
        also look in scripts/ccsm_utils/Tools for perl5lib.
	abort if set -cycle_begyr or cycle_nyrs on namelist rather than on build-namelist command-line.

Known bugs (include bugzilla ID): 251, 449, 512, 546, 608, 618, 622, 624

	New nasty bugs found:

618 	You can't add new fields using: hist_fincl*.
622	CLM blindly continues even if needed fields are missing from surface dataset.

Describe any changes made to build system: None

Describe any changes made to the namelist: Just add more files to XML database

List any changes to the defaults for the boundary datasets: Add new files for: 
              0.23x0.31, 0.47x0.63, 0.9x1.25, (64x128 with mask=gx1v5) and add fndepdyn file for 1.9x2.5

Describe any substantial timing or memory changes: None

Code reviewed by: None

List any svn externals directories updated (csm_share, mct, etc.): csm_share updated to trunk_tags/share3_070927

	This is the version needed in ccsm3_5_beta13 tag (previous version causes problems building on tempest)

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M      bld/DefaultCLM_INPARM_Namelist.xml ---- Add new datasets.
M      bld/clm_inparm.pm --------------------- Abort if try to define cycle_nyr and cycle_begyr on namelist 
                                               rather than with command line options.
M      bld/queryDefaultNamelist.pl ----------- Add ability to use perl5lib from under ccsm_utils/scripts/Tools.
M      bld/build-namelist -------------------- Add ability to use perl5lib from under ccsm_utils/scripts/Tools.

         ------------------------- Remove test blZ11 (can't do the comparision), and update cam tag comparing to.
M      test/system/tests_pretag_bangkok
M      test/system/test_driver.sh
M      test/system/tests_posttag_purempi_regression
M      test/system/tests_posttag_hybrid_regression
M      test/system/tests_pretag_bluevista
M      test/system/tests_posttag_lightning

Summary of testing: None

Changes answers relative to baseline: No clm source code changed

===============================================================
===============================================================
Tag name:  clm3_5_10
Originator(s):  jet
Date: Tue Sep 18 12:00:23 MDT 2007
Date:One-line Summary: Fixed scam bugs when reading initial land dataset 
	and moved scam_setlatlon functionality to shr_scam_mod in 
	csm_shr repos.  Merged in Mariana's changes to add new boundary
	dataset file to help scam determine land/ocn/ice fractions.

Purpose of changes: Fix scam bugs and refactor code to allow scam to easily
        determine land/ocean/ice fractions.

Bugs fixed (include bugzilla ID):  612, 480

Known bugs (include bugzilla ID): 251, 449, 512, 546, 608, 618, 622

Describe any changes made to build system: Change configure to include new focndomain file.

Describe any changes made to the namelist: focndomain file added to ocn_in

List any changes to the defaults for the boundary datasets: Mariana created
	a new focndomain boundary dataset (at the standard resolutions) which 
	describe the grid fraction of land/ocn/ice

Describe any substantial timing or memory changes: None

Code reviewed by: self, mariana

List any svn externals directories updated (csm_share, mct, etc.):

	clm3_5_10
	branches/scm_drvseq1_0_43
        branches/csm_share3_070824_scm

List all subroutines eliminated: scam_setlatlonidx.F90

List all subroutines added and what they do: moved scm functionality
	from scam_setlatlonidx.F90 into a csm_share module that can 
	now be used by all surface models.

List all existing files that have been modified, and describe the changes:
M      test/system/test_driver.sh  - use latest cam in testing
M      test/system/nl_files/scam   - fixed scam bug
M      test/system/nl_files/scam_prep  - fixed scam bug
M      test/system/nl_files/ext_ccsm_seq_cam  - use latest cam in testing
M      SVN_EXTERNAL_DIRECTORIES - point to needed external dirs
M      src/biogeochem/STATICEcosysDynMod.F90 - use new shr code instead of scam_setlatlonidx.F90
M      src/main/ncdio.F90 - use new shr code instead of scam_setlatlonidx.F90
M      src/main/initializeMod.F90 - use new shr code instead of scam_setlatlonidx.F90
M      src/main/iniTimeConst.F90 - use new shr code instead of scam_setlatlonidx.F90
M      src/main/restFileMod.F90 - use new shr code instead of scam_setlatlonidx.F90
D      src/main/scam_setlatlonidx.F90 - use new shr code instead of scam_setlatlonidx.F90
M      src/main/clm_varctl.F90 - use new shr code instead of scam_setlatlonidx.F90
M      src/main/surfrdMod.F90 - use new shr code instead of scam_setlatlonidx.F90
Summary of testing:

  bluevista: Everything but ccsm tests pass ( due to requirment on external
	directories)

  bangkok/lf95: all passed except ccsm - expected due to requirment on external
	directories
  tempest  all passed except 034 br531 (failed previous to this commit)

  CLM tag used for the baseline comparison tests if applicable: clm3_5_09

Changes answers relative to baseline: None

===============================================================
===============================================================
Tag name:  clm3_5_09
Originator(s):  erik (Kluzek Erik 1326 CGD)
Date: Fri Aug 31 13:58:46 MDT 2007
Date:One-line Summary: Change configure to NOT have csm_share code for ccsm_con option, and add in 1x1.25 file, and update datm7 and csm_share

Purpose of changes: Fix for ccsm3_5_beta12 tag

Bugs fixed (include bugzilla ID):  581, 583

Known bugs (include bugzilla ID): 251, 449, 512, 546, 608, 618, 622

Describe any changes made to build system: Change configure so csm_share NOT included in Filepath for ccsm_con option

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: 

	1x1.25 finidat dataset now uses version used in CCSM simulations

Describe any substantial timing or memory changes: None

Code reviewed by: self, jwolfe (configure change)

List any svn externals directories updated (csm_share, mct, etc.):

	drvseq1_0_43
        csm_share3_070824
        datm7_070824

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M      bld/configure ------------------------ Change ccsm_con mode to NOT include csm_share in Filepath
                                              (from Jon Wolfe)
MM     bld/DefaultCLM_INPARM_Namelist.xml  -- new 1x1.25 finidat file

Summary of testing:

  bluevista: Tests all pass (up to test 46)
  bangkok/lf95: None

CLM tag used for the baseline comparison tests if applicable: clm3_5_08

Changes answers relative to baseline: None

===============================================================
===============================================================
Tag name: clm3_5_08
Originator(s): tcraig
Date: Mon Aug 20 20:04:47 MDT 2007
One-line Summary: convert 6 to iulog in logfile, updates for I/O

Purpose of changes: improve flexibility of logging, continue
	development of pio, remove dead code, get finemesh
	mode working in ccsm, add highmem version of gather/scatter.

Bugs fixed (include bugzilla ID):
  #446 code cleanup done
  #447 log files have been improved, some work still to do
  #558 finemesh is working in ccsm, fv still needs to be tested

Known bugs (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List any svn externals directories updated (csm_share, mct, etc.):
	pio is updated but not used by default

List all subroutines eliminated:

List all subroutines added and what they do:
	A  +   src/main/gen_ncdio_global_subs.csh
	A  +   src/main/gen_ncdio_local_subs.csh
	A  +   src/main/gen_spmdgs_subs.csh
  - add a couple csh scripts to auto-generate code for ncdio.F90
    and spmdGathScat.  this is just temporary during the current
    development.

List all existing files that have been modified, and describe the changes:
        M      test/system/test_driver.sh
	M      tools/mksurfdata/Srcfiles
	M      tools/mkgriddata/Srcfiles
	M      src/biogeochem/CNBalanceCheckMod.F90
	M      src/biogeochem/CASAMod.F90
	M      src/biogeochem/DUSTMod.F90
	M      src/biogeochem/DGVMEstablishmentMod.F90
	M      src/biogeochem/STATICEcosysDynMod.F90
	M      src/biogeochem/DGVMRestMod.F90
	M      src/biogeochem/DGVMModeMod.F90
	M      src/biogeochem/VOCEmissionMod.F90
	M      src/main/inicFileMod.F90
	M      src/main/spmdGathScatMod.F90
	M      src/main/abortutils.F90
	M      src/main/accumulMod.F90
	M      src/main/driver.F90
	M      src/main/decompInitMod.F90
	M      src/main/ncdio.F90
	M      src/main/atmdrvMod.F90
	M      src/main/accFldsMod.F90
	M      src/main/fileutils.F90
	M      src/main/initializeMod.F90
	M      src/main/pftdynMod.F90
	M      src/main/iniTimeConst.F90
	M      src/main/histFileMod.F90
	M      src/main/program_csm.F90
	M      src/main/clm_atmlnd.F90
	M      src/main/system_messages.F90
	M      src/main/clm_csmMod.F90
	M      src/main/restFileMod.F90
	M      src/main/scam_setlatlonidx.F90
	M      src/main/controlMod.F90
	M      src/main/initSurfAlbMod.F90
	M      src/main/clm_time_manager.F90
	M      src/main/filterMod.F90
	M      src/main/clm_varctl.F90
	M      src/main/ndepFileMod.F90
	M      src/main/subgridAveMod.F90
	M      src/main/initGridCellsMod.F90
	M      src/main/lnd_comp_mct.F90
	M      src/main/program_off.F90
	M      src/main/pftvarcon.F90
	M      src/main/spmdMod.F90
	M      src/main/surfrdMod.F90
	M      src/main/domainMod.F90
	M      src/main/decompMod.F90
	M      src/main/areaMod.F90
	M      src/main/iobinary.F90
	M      src/main/clm_mct_mod.F90
	M      src/main/mkarbinitMod.F90
	M      src/riverroute/RtmMod.F90
	M      src/biogeophys/BalanceCheckMod.F90
	M      src/biogeophys/CanopyFluxesMod.F90

  Summary of changes:
  - improve flexibility in log file by converting "6" to iulog.  
    iulog is defined in clm_varctl.F90.
  - refactor ncdio for optional pio usage and add many new interfaces.  
  - add lots of pio code (parallel i/o) to ncdio; not used or 
    validated yet.  
  - update history file module for new ncdio methods.  
  - refactor spmdGathScat method to support both lowmem and highmem 2d 
    gather/scatter.
  - add some new high level timers.  
  - clean up dead code.  
  - fix bugs in clm_csmMod to support running clm finemesh mode in CCSM.


Summary of testing:

  clm: vs clm3_5_07
    bluevista: all pass except
	blZ11 - compare fails, fails in clm3_5_07
    bangkok/lf95: all pass except
	blZ11 - compare failed, fails in clm3_5_07
	sm982 - hangs, fails in clm3_5_07
    tempest: all pass except
	br111
	bl111
    lightning: all pass except
	er551
	br551
	bl551
	blZ11
	
  cam: vs cam3_5_08
    bluevista:
	br532 - fails in cam3_5_08
    bangkok/lf95:
	br511 - fails in cam3_5_08
    tempest: all pass except
	br531 - fails in cam3_5_08
	
  ccsm: vs ccsm3_5_beta11
    bluevista: 
      ERS.f45_g35.B.bluevista    PASS
      ERS.T42_g35.B.bluevista    PASS
      ERS.T42_g35.B.bluevista + half_degree_clm_surfdat PASS
            (finemesh test)

CLM tag used for the baseline comparison tests if applicable:
    clm3_5_070, cam3_5_08, ccsm3_5_beta11

Changes answers relative to baseline: None

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
Tag name:  clm3_5_07
Originator(s):  erik (Erik Kluzek)
Date:  Fri Aug 17 21:27:29 MDT 2007
One-line Summary: Add mkdatadomain tool, add cprnc and perl5lib as externals

Purpose of changes:

	Add in mkdatadomain tool that Mariana created to read in clm
	input files and convert them to data model domain files.

Bugs fixed (include bugzilla ID): None

Known bugs: 251, 449, 512, 546, 608, 618
	interpinic does NOT work for DGVM

Describe any changes made to build system: Use perl5lib version of XML::Lite

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: Add new high resolution
    surface datasets from Art Mirin

+<fsurdat RESOLUTION="0.23x0.31" >lnd/clm2/srfdata/cam/clms_3.1_0.23x0.31_c061107.nc</fsurdat>
+<fsurdat RESOLUTION="0.47x0.63" >lnd/clm2/srfdata/cam/clms_3.1_0.47x0.63_c061107.nc</fsurdat>

Describe any substantial timing or memory changes: None

Code reviewed by: Mariana, erik

List any svn externals directories updated (csm_share, mct, etc.):

	Add perl5lib_070817
	Add cprnc_070817

List all subroutines eliminated:

	Delete bld/XML directory and use bld/perl5lib/XML

List all subroutines added and what they do: mkdatadomain

List all existing files that have been modified, and describe the changes:

	Add new tests for mkdatadomain to test suite

Summary of testing:

  bluevista: All PASS
  bangkok/lf95: All PASS

Changes answers relative to baseline: None

===============================================================
===============================================================
Tag name:  clm3_5_06
Originator(s):  erik (KLUZEK ERIK 1326 CGD)
Date: Fri Aug 10 15:41:50 MDT 2007
One-line Summary: Update: interpolation, testing, script namelist build, and scripts. Fix bugs, and fix possible 
                  divide by zero for eff-porosity
Purpose of changes: Fix interpolation code so can also do CN
                    Make co2_ppmv a variable that can be input at run-time
                    Major refactoring update on testing to remove resolution dependence from namelist generation
                    Allow build scripts to work with ccsm3_5_beta05 for configure/build
                    Fix various bugs
                    Fix possible divide by zero for effective porosity
                    Add new tests for sequential CCSM that's included
                    Add initial version of build-namelist to make namelists
                    Fix bug in CN exit_spinup mode

Bugs fixed (include bugzilla ID): 389, 470, 472, 484, 487, 500, 506, 507, 508, 510, 536, 540, 
                                  541, 542, 543, 545, 546, 552, 556, 557, 564
    Fix so scripts now work and use SMT. Move clm3_5_rel02 changes to trunk.
    Remove references to get_env calls, rpointer files now go in run directory
    by default. Add co2_ppmv namelist variable. Add new tests for sequential CCSM mode.
    Fix FPE error in startup for CAM. Fix bug in CN exit_spinup mode when restarting.
    Get a new 1.9x2.5_gx1v5 dataset for CN. Fix some problems with datm7 for functionalty
    as well as getting it to work. Get rid of equivalences, don't assign nan to integers.
    Make sure namelist variables are documented in controlMod.F90.

Known bugs: 251, 449, 512, 546, 608, 618
	interpinic does NOT work for DGVM or CASA

Describe any changes made to build system: Allow CCSM to use configure and query namelist tools in clm.template

Describe any changes made to the namelist: Add co2_ppmv to namelist

	Create build-namelist script to create namelists for users.

List any changes to the defaults for the boundary datasets:

	Several changes.

Describe any substantial timing or memory changes: None

Code reviewed by (only some parts): slevis, thornton, mvertens, oleson

List any svn externals directories updated (csm_share, mct, etc.): seq_mct_drv, datm7, csm_share

   src/drv/seq_mct            https://svn-ccsm-models.cgd.ucar.edu/drv/seq_mct/trunk_tags/drvseq1_0_42
   src/datm7                  https://svn-ccsm-models.cgd.ucar.edu/datm7/trunk_tags/datm7_070810
   src/csm_share              https://svn-ccsm-models.cgd.ucar.edu/csm_share/trunk_tags/share3_070810
   src/utils/pio              https://svn-ccsm-models.cgd.ucar.edu/pio/trunk_tags/pio_prod_02 --- Change to fixed tag

List all subroutines eliminated:

Remove namelist scripts -- replace with mknamelist and build-namelist scripts

R test/system/nl_files/1.9x2.5
R test/system/nl_files/10x15
R test/system/nl_files/10x15_cnall
R test/system/nl_files/10x15_dgvm
R test/system/nl_files/10x15_pftdyn
R test/system/nl_files/regional
R test/system/nl_files/seqccsm
R test/system/nl_files/singlept
R test/system/nl_files/singlept_dgvm_long
R test/system/nl_files/singlept_long
R test/system/nl_files/t31
R test/system/nl_files/t31_casa
R test/system/nl_files/t31_cnall
R test/system/nl_files/t31_dgvm
R test/system/nl_files/t31_dgvm_long
R test/system/nl_files/t42half

List all subroutines added and what they do:

A bld/create_newcase ---- Script that will create a new run script for a specific case

Scripts to support new build-namelist script that builds namelists for all modes

---- XML files to support various namelists for different modes
A bld/DefaultCCSM_INPARM_Namelist.xml
A bld/DefaultDATM_DSHR_NML_Namelist.xml
A bld/DefaultDATM_NML_Namelist.xml
A bld/DefaultPROF_INPARM_Namelist.xml
A bld/DefaultTIMEMGR_INPARM_Namelist.xml

A bld/DefaultSettings.xml ---- Defaults for build-namelist itself (resolution etc.)

----- Namelist descriptions for the drv_in virtual namelist for each mode (see below)
A bld/CCSMDrvInNamelistsDescriptions.xml
A bld/CLMDrvInNamelistsDescriptions.xml
A bld/SeqCCSMDrvInNamelistsDescriptions.xml

A bld/sample.seqccsm.namelists --- sample sequential CCSM namelists
A bld/build-namelist
A bld/SeqCCSM_namelist.pm
A bld/ccsm_inparm.pm
A bld/clm_inparm.pm
A bld/compnl.pm
A bld/datm_dshr_in.pm
A bld/datm_in.pm
A bld/datm_nml.pm
A bld/drv_in.pm
A bld/namelist.pm
A bld/prof_inparm.pm
A bld/queryDefaultXML.pm   ---- Create subroutines that can be used in different contexts.
A bld/timemgr_inparm.pm

--- Extend testing, for CN  spinup, run scripts, pergro and sequential-CCSM

A test/system/README.testnames ----- Naming conventions
----- Test that run scripts in bld directory work
A test/system/TCSruncase.sh
A test/system/TSMruncase.sh
---- CN spinup
A test/system/TSMcnspinup.sh
A test/system/config_files/17p__ds
A test/system/config_files/17p_cn_dh
A test/system/config_files/17p_cnadspinup_dh
A test/system/config_files/17p_cnexitspinup_dh
A test/system/config_files/17p_cnn_ds
--- PERGRO
A test/system/config_files/_per_dh
A test/system/config_files/_per_dm
A test/system/config_files/_per_ds
--- Sequential CCSM
A test/system/config_files/_sc_dh
A test/system/config_files/_sc_dm
A test/system/config_files/_sc_do
A test/system/config_files/_sc_ds

A test/system/mknamelist ----------------- Invoke build-namelist
A test/system/nl_files/clm_pftdyn -------- build-namelist options for dynamic PFT
A test/system/nl_files/clm_std ----------- Standard build-namelist options

A test/system/nl_files/ext_ccsm_seq_cam -- CAM build-namelist

Renames in test/system/config_files:

rename TCBseqccsm.sh    to TCBext_ccsmseq_cam.sh
rename TCTconccsm.sh    to TCText_ccsmcon.sh
rename TSCscam.sh       to TSCext_ccsmseq_scam.sh
rename TSMconccsm.sh    to TSMext_ccsmcon.sh
rename TSMseqccsm.sh    to TSMext_ccsmseq_cam.sh
rename seqccsm_10x15_dm to ext_ccsm_seq_10x15_dm
rename seqccsm_4x5_dh   to ext_ccsm_seq_4x5_dh
rename seqccsm_64x128_s to ext_ccsm_seq_64x128_s

New script:

	bld/build-namelist

	use -help option to give basic functionality. Also examine bld/run-ibm.csh
        script to see how to use. Works similarly to the cam build-namelist to build
        all the needed namelists in the correct filenames. This is critical because
        the sequential CCSM mode is much more complex than the standard offline mode.
        build-namelist uses the input config_cache.xml file created by the configure
        script to figure out what the settings are:

        Here's a description of some of the most important options:

     -case "name"            Case identifier up to 32 characters
     -clm_demand "list"      List of variables to require on clm namelist besides the
usuals.
     -config "file"          Read the given config cache file to get the configuration
                             of the CLM executable.  Default: config_cache.xml.
     -cycle_beg_year "year"  The begining year to cycle input datasets over.
     -cycle_end_year "year"  The ending year to cycle input datasets over.
     -cycle_init_year "year" The simulation year that will correspond to the data 
                             for cycle_beg_year.
     -d "directory"          Output directory name of resulant namelists.  
                             Default: ./
     -infile "file"          Specify a namelist file to read values from.
     -lnd_res "Resolution"   Horizontal resolution of fine mesh for land 
                             (if different than resolution coupling to atmosphere)
     -mask "land-mask"       Type of land-mask (default, navy, gx3v5, gx1v5 etc.)
     -namelist "namelist"    Specify namelist settings using FORTRAN namelist syntax,
e.g.,
                              -namelist "&clm_inparm hist_dov2xy=.true. /"
     -res "Resolution"       Horizontal resolution (default, 64x128, 1.9x2.5, 1x1_brazil
etc.)
     -runlength "length"     Length of simulation (e.g. default, 10d, 5s, 2y)
                             (Corresponding to: default, 10 days, 5 steps, or 2 years)
                             classifiers (d=days, s=steps, y=years)
     -sim_year year          Year to simulate for input datasets (i.e. 1890, 2000, etc.)
     -start_type "type"      Type of simulation (arb_ic, startup, continue, or branch)

    NOTE: Both -namelist and -infile parse F90 type namelists (either on command line
    or from a file respectively). Normal rules for namelists apply. You need to name
    the namelist you are using for a particular variable. So for example

     build-namelist -namelist \
     "&timemgr_inparm restart_option="nyears" / &clm_inparm co2_ppmv=450. /"

     will set the restart_option for the timemgr_inparm namelist and co2_ppmv for
     the clm_inparm namelist. When set this way it will override any defaults for
     these options.

     NOTE2: drv_in "virtual namelist". In order to facilitate testing and make
            the different build-time modes exchangeable to the user -- a virtual
            namelist "drv_in" was created. You can use this namelist to put driver
            namelist options when you don't know which namelist they belong in.

     For example,

     build-namelist -namelist "&drv_in start_ymd=19990101 /"

     will put the namelist item start_ymd in the timemgr_inparm namelist for 
     sequential-ccsm or in the clm_inparm namelist for concurrent CCSM or offline
     modes.

List all existing files that have been modified, and describe the changes:

M bld/DefaultCLM_INPARM_Namelist.xml --- Change files used
M bld/queryDefaultNamelist.pl ---------- Change to use queryDefaujltXML subs
M bld/run-ibm.csh -------- use build-namelist
M bld/run-pc.csh --------- use build-namelist
M bld/run-lightning.csh -- use build-namelist

M src/biogeochem/CASAMod.F90 ----------- update reference
M src/biogeochem/DGVMMod.F90 ----------- Mess with SVN keywords
M src/main/clm_varcon.F90 -------------- Remove co2_ppmv_const
M src/main/driver.F90 ------------------ Fix CN exit_spinup mode
M src/main/decompInitMod.F90 ----------- Remove CVS Id's
M src/main/atmdrvMod.F90 --------------- Add co2_ppmv
M src/main/program_csm.F90 ------------- Change termination message
M src/main/clm_csmMod.F90 -------------- Pass co2_ppmv
M src/main/controlMod.F90 -------------- Add co2_ppmv, remove setting rpointer to $HOME, document vars
M src/main/clm_varctl.F90 -------------- Add co2_ppmv
M src/main/lnd_comp_mct.F90 ------------ Add flux averaging, co2_ppmv, format log output
M src/main/program_off.F90 ------------- Change termination message
M src/main/spmdMod.F90 ----------------- Change log output
M src/main/ncdio.F90 ------------------- Don't set integers to nan
M src/main/histFileMod.F90 ------------- Remove equivalence statements
M src/biogeophys/BalanceCheckMod.F90 --- Don't check until step 2
M src/biogeophys/BiogeophysRestMod.F90 - Check water properly bounded on first step
M src/biogeophys/SoilHydrologyMod.F90 -- Put lower bound to eff_porisity (Oleson)

----- Modify test lists to include new tests, add new tests
M test/system/tests_driver.sh ----------- Add -d option for testing debug mode
M test/system/TCB.sh
M test/system/TBL.sh ----- Refactor to use TSM
M test/system/TBR.sh ----- Modify so doesn't compare first history file
M test/system/TER.sh ----- Refactor to use TSM
M test/system/TSM.sh ----- Use this for all start_types
M test/system/tests_posttag_blueice
M test/system/input_tests_master
M test/system/tests_posttag_robin
M test/system/tests_posttag_phoenix
M test/system/tests_pretag_jaguar
M test/system/tests_pretag_bangkok
M test/system/tests_posttag_hybrid_regression
M test/system/tests_posttag_purempi_regression
M test/system/tests_pretag_tempest
M test/system/tests_posttag_lightning


Change interpinic -- so doesn't use lists of variables for interpolation -- just
  has rules on variable names and dimensions for what to do. This allows CN files to
  be interpolated. Algorithm had to be changed for so for a given grid-point may
  use different input points. Also algorithm changed so that it runs much faster
  (still takes several hours for CN files -- but moments for other configurations).
  In DGVM mode it still uses the same point.

  Update much of it to F90 interface for NetCDF.
M tools/interpinic/interpinic.F90
M tools/interpinic/interpinic.runoptions
M tools/interpinic/addglobal.F90
M tools/interpinic/wrap_nf.F90
M tools/interpinic/Makefile
M tools/interpinic/README

Behavior of queryDefaultNamelist.pl -- changed:

  Instead of listing all files for all resolutions and configurations it will only
  list one for each variable name.

Summary of testing:

  bluevista: All PASS except...

004 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...FAIL! rc= 5
008 blA91 TBL.sh _sc_dh clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic ....FAIL! rc= 5

  bangkok/lf95: All PASS except...

004 blA92 TBL.sh _sc_dm clm_std 19990101:NONE:3600 4x5 gx3v5 -10 arb_ic .....FAIL! rc= 5
008 blA71 TBL.sh _sc_ds clm_std 19990101:NONE:3600 1x1_brazil navy -10 arb_ic ...FAIL! rc= 5
042 sm951 TSMext_ccsmseq_cam.sh seqccsm_10x15_dm seqccsm 48 .......FAIL! rc= 8

  lightning/pathf90: All PASS except...

028 sm551 TSM.sh _dh clm_std 19980115:MONTHLY:1800 10x15 default 48 arb_ic ......................FAIL! rc= 10
029 er551 TER.sh _dh clm_std 19980115:MONTHLY:1800 10x15 default 10+38 arb_ic ...................FAIL! rc= 5
030 br551 TBR.sh _dh clm_std 19980115:MONTHLY:1800 10x15 default 24+24 arb_ic ...................FAIL! rc= 5

CLM tag used for the baseline comparison tests if applicable: 

	clm3_5_05 (but with bld and test/system updates)

IF tag changes answers relative to baseline comparison: b4b

===============================================================

===============================================================
Tag name: clm3_5_05
Originator(s): tcraig
Date: Mon Jun 11 05:03:39 MDT 2007	
One-line Summary: seq clm mods and first hist refactor mods

Purpose of changes: Fix problems with clm seq mode and improve
	clm seq mode performance with new datm7 and csm_share tags.
	Also bring in first mods for history refactor

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: for seq-clm mode

Describe any changes made to the namelist: for seq-clm mode

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: 

Code reviewed by: mvertens

List any svn externals directories updated (csm_share, mct, etc.):
	datm7_070610
	share3_070610

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M      test/system/test_driver.sh
M      bld/configure
M      bld/Makefile.in
M      bld/config_clm_defaults.xml
M      bld/run-pc-seq.csh
M      bld/run-ibm-seq.csh
M      SVN_EXTERNAL_DIRECTORIES
M      doc/ChangeLog
M      src/biogeochem/CASAMod.F90
M      src/biogeochem/DGVMRestMod.F90
M      src/biogeochem/DGVMMod.F90
M      src/biogeochem/CNrestMod.F90
M      src/main/inicFileMod.F90
M      src/main/driver.F90
M      src/main/ncdio.F90
M      src/main/subgridRestMod.F90
M      src/main/initializeMod.F90
M      src/main/histFileMod.F90
M      src/main/restFileMod.F90
M      src/main/program_off.F90
M      src/main/decompMod.F90
M      src/main/clmtype.F90
M      src/main/histFldsMod.F90
M      src/biogeophys/BiogeophysRestMod.F90

- get seqclm updates from mv
- rename hist interfaces to hist_*
- remove typexy, nlonxy,nlatxy from history field_info type,
  now use the type1d and type1d_out strings to
  trigger the input/output "type" and behavior.
  fix code so it works properly using type1d*.
  typexy was already not used.  calls to history
  routines had to change in several modules.
- clean up hist file write statements, add subname consistently
- modify calls to histFile for change to nlonxy,nlatxy,type1d*
- use clmtypes namep, grlnd, etc instead of 'pft','gridcell',etc.

Summary of testing:

  clm:
    bluevista: clm pretag passes
    tempest: clm pretag passes except sm812, the test can't find the binary
    lightning: clm posttag passes except *551 which is known to be broken
    bangkok/lf95: clm pretag passes except sm982;
       The variable (scm_crm_mode) has an undefined value.
       Error occurs at or near line 350 of radiation.radiation_init_        
	
  ccsm:
    bluevista:
	PASS  ERS_OS.f19_g15.B2.bluevista16 
	PASS  ERS_OS.f19_g15.B2.bluevista16.compare.ccsm3_5_beta04 
	PASS  ERS_OS.f45_g35.A.bluevista16 
	PASS  ERS_OS.f45_g35.A.bluevista16.compare.ccsm3_5_beta04 

CLM tag used for the baseline comparison tests if applicable: clm3_5_03, ccsm3_5_beta04, seqflxave16_cam3_4_12

IF tag changes answers relative to baseline comparison the
following should be filled in:  bfb

===============================================================
Tag name: clm3_5_04
Originator(s): mvertens
Date: Tue Jun  5 09:59:48 MDT 2007
One-line Summary: lnd_comp_mct.F90 change to work with sequential diagnostics

Purpose of changes: addition of water and energy diagnostics in sequential driver
required this fix (the new diagnostics will not be part of this tag)

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List any svn externals directories updated (csm_share, mct, etc.): none

List all subroutines eliminated: noen

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
  M  lnd_comp_mct.F90
     - added an mct_aVect_permute call at the end of lnd_import_mct.F90 and
       also changed the sign of l2x_l%rAttr(index_l2x_Fall_swnet,i) (note
       that in cpl6 the sign should be changed as well in clm_csmMod.F90) 

Summary of testing:

CLM:
  bluevista: none
  bangkok/lf95: none 

CAM:
  bluevista pretag: none
  tempest pretag: none
  bangkok pretag: all pass except
    037 br511 TBR.sh s8c8mdm ttrac 6+3s

CLM tag used for the baseline comparison tests: na
CAM tag used for the baseline comparison tests: seqflxave16_cam3_4_12 

IF tag changes answers relative to baseline comparison the
following should be filled in:
  everything is bfb (clm3_5_04 will be utilized on seqflxave17_cam3_4_12)
	
===============================================================
===============================================================
Tag name: clm3_5_03
Originator(s): tcraig
Date: Wed May 23 18:57:17 MDT 2007
One-line Summary: reduce memory, partial I/O refactor, downscaling implementation

Purpose of changes:

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: reduced memory usage

Code reviewed by:

List any svn externals directories updated (csm_share, mct, etc.): none

List all subroutines eliminated: removed dead code

List all subroutines added and what they do:
  A  +   src/main/decompInitMod.F90
- split decompMod.F90 into decompMod.F90 and decompInitMod.F90

List all existing files that have been modified, and describe the changes:
  M      test/system/test_driver.sh
  M      src/biogeochem/CASAMod.F90
  M      src/biogeochem/STATICEcosysDynMod.F90
  M      src/biogeochem/DGVMRestMod.F90
  M      src/biogeochem/DGVMMod.F90
  M      src/main/spmdGathScatMod.F90
  M      src/main/accumulMod.F90
  M      src/main/ncdio.F90
  M      src/main/atmdrvMod.F90
  M      src/main/subgridRestMod.F90
  M      src/main/subgridMod.F90
  M      src/main/initializeMod.F90
  M      src/main/clmtypeInitMod.F90
  M      src/main/pftdynMod.F90
  M      src/main/iniTimeConst.F90
  M      src/main/histFileMod.F90
  M      src/main/clm_atmlnd.F90
  M      src/main/restFileMod.F90
  M      src/main/clm_csmMod.F90
  M      src/main/clm_time_manager.F90
  M      src/main/ndepFileMod.F90
  M      src/main/initGridCellsMod.F90
  M      src/main/surfrdMod.F90
  M      src/main/domainMod.F90
  M      src/main/decompMod.F90
  M      src/main/areaMod.F90
  M      src/main/iobinary.F90
  M      src/main/clmtype.F90
  M      src/main/clm_mct_mod.F90
  M      src/main/histFldsMod.F90
  M      src/riverroute/RtmMod.F90
  M      src/riverroute/RunoffMod.F90
SOFTWARE:
- clean up dead code
- initialize g,l,c,p gsmaps in glcp_init
- split decompMod to decompMod + decompInitMod
- change interface to gsmap gather/scatter/ncdio_local
- start migration of I/O
- rewrite spmdGathScat for gsmaps
- refactor ncdio for gsmaps and make more general
- get rid of gcell dc/sn and subgrid type completely
- remove map_dc2sn and sn2dc from decompMod and rtm
- get rid of lndrof and ocnrof as grid types
- modify histFileMod
- rtm fields now "global", need to put masking back in
- rewrite iobinary to take advantage of new gather/scatter
- add unpermute to clm_mct_mod
- fix error in writing of indxupsc
- implement non-mct masking in gs gather 
- convert surfrd to use ncd_ioglobal and ncd_iolocal
- change default ncd_ioglobal bcast to false
- get rid of global domains
- get rid of old celledge and cellarea routines
- remove edge and latnews from domain, use latlon type
- get rid of decompInit_domg2l
- add areaset flag to domain
- modify CASAMod to use ncd_local to read data
- get rid of all uses of gdc2i, gdc2i, gdc2gsn, gsn2gdc and remove from decomp type
- modify STATICEcosysDynMod to use ncd_iolocal to read data
- modify ndepfile reading to reduce memory and use ncd_iolocal
- add gindex and gindex_a to gptr clmtype
- change 1d lon/lat writing in dgvm and casa to history file, use llatlon
- fix rtm lat/lon bug, #478
- update ccsm tag in test_driver (EK)
DOWNSCALING:
- implement downscaling in clm_mapa2l
- add new vars and dims to history file
- leave placeholder for lapse rate being passed to clm
- include precip refractionation flux in coupling latent heat flux
	
	
Summary of testing:

CLM:
  bluevista pretag: all pass except
    014 bl131 TBL.sh 4p_vodsr_dh t42half 48 - changes in downscaling
    065 sm921 TSMseqccsm.sh seqccsm_4x5_dh seqccsm 48 - csm_share compatability
    066 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 3 - csm_share 
        compatability, passes when pointed to seqflxave16_cam3_4_12 tag
  tempest pretag: all pass
  bangkok/lf95 pretag: all pass except
    033 sm951 TSMseqccsm.sh seqccsm_10x15_dm seqccsm 48 - csm_share 
        compatability, passes when pointed to seqflxave16_cam3_4_12 tag
    034 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 3 -  csm_share
        compatability
  lightning posttag: all pass except
    019 sm551 TSM.sh _dh 10x15 48 - science fails
        Error: Forcing height is below canopy height for pft index  688
        ENDRUN: called without a message string
    020 er551 TER.sh _dh 10x15 10+38 - sm551 fail
    021 br551 TBR.sh _dh 10x15 24+24 - sm551 fail
    022 bl551 TBL.sh _dh 10x15 48 - sm551 fail

CAM:
  bluevista pretag: all pass except
    043 br531 TBR.sh s32c11dh pghgsul 6+3s - fails in out of the box 
        seqflxave16_clm3_4_12,	assuming it's a pre-existing condition
  tempest pretag: all pass except
    034 br531 TBR.sh s32c11dh pghgsul 6+3s
  bangkok pretag: all pass except
    037 br511 TBR.sh s8c8mdm ttrac 6+3s
		
CLM tag used for the baseline comparison tests: clm3_5_02
CAM tag used for the baseline comparison tests: seqflxave16_cam3_4_12

IF tag changes answers relative to baseline comparison the
following should be filled in:  
  everything is bfb except for downscaling when coarse and finemesh are 
  on different grids.  

  Summarize any changes to answers, i.e.,
    - what code configurations: all
    - what platforms/compilers: all
    - nature of change (roundoff; larger than roundoff/same climate; new climate):  
      larger than roundoff.  implemented a much improved downscaling package consistent 
      with finemesh testing project.  expect different answers but only when
      coarse and finemesh grids are not identical.  shown via testing.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
==============================================================
===============================================================
Tag name: clm3_5_02
Originator(s): mvertens (Mariana Vertenstein)
Date: Tue May 22 11:23:13 MDT 2007
One-line Summary: put in hourly coupling with sequential driver

Purpose of changes: To only communicate with sequential driver on
CAM shortwave time step. Also added the functionality to run in
an "I" configuration through the sequential driver (dtam7, stub-ice,
stub-ocn, clm). This will become the default way in the near future.

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: 
   M  configure
      - added option to run through sequential system - now
        can invoke configure with either -con_ccsm or -seq_ccsm
        as inputs (rather than just -ccsm)
   A  run-pc-seq.csh
      - script to run with datm7 (this will eventually need to be
        migrated into a clm build-namelist functionality)
   A  run-ibm-seq.csh
      - script to run with datm7 (this will eventually need to be
        migrated into a clm build-namelist functionality)

Describe any changes made to the namelist: None 
None for the default offine mode. The datm7-clm mode, however,
will require new namelist settings for the sequential driver and
datm7.  

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Myself

List any svn externals directories updated (csm_share, mct, etc.):
modified csm_share:
src/csm_share    https://svn-ccsm-models.cgd.ucar.edu/csm_share/branch_tags/cpl7_share3_070410_tags/cpl709_share3_070410

added the following:
src/drv/seq_mct  https://svn-ccsm-models.cgd.ucar.edu/drv/seq_mct/trunk_tags/drvseq1_0_32
src/datm7        https://svn-ccsm-models.cgd.ucar.edu/datm7/trunk_tags/datm7_070503
src/socn         https://svn-ccsm-models.cgd.ucar.edu/stubs/trunk_tags/stubs1_0_5/socn
src/sice         https://svn-ccsm-models.cgd.ucar.edu/stubs/trunk_tags/stubs1_0_5/sice 

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:
   M  src/main/abortutils.F90
      - removed following cpp #if-def
        #if (defined OFFLINE) || (defined COUP_CSM) || (defined SEQ_ESMF) || (defined SEQ_MCT)
   M  src/main/clm_comp.F90
      - clm_run1 - removed optional arguments for nextsw_cday and dosend (these calculations 
	now occur in lnd_comp_mct.F90
      - clm_run2 - added optional arguments nlend and rdate that are now obtained from SyncClock
        to determine name stamp on restart file and flag if run is ending on this time step
      - removed various timing library start/stop calls that are now in lnd_comp_mct.F90
   M  src/main/driver.F90
      - added optional arguments nlend and rdate to driver2 (that are passed from clm_run2 - see above)
   M  src/main/fileutils.F90
      - removed old comments
   M  src/main/histFileMod.F90
      - added optional arguments nlend and rstwr that are passed down from driver2 that will only be
        invoked in sequential driver mode
   M  src/main/clm_csmMod.F90
      - formatting 
   M  src/main/restFileMod.F90
      - added nlend as optional argument to restFile_write and restFile_write_binary
      - added rdate as optional argument to restFile_filename 
      - modified logic for nlend in restFile_archive for (defined SEQ_MCT) || (defined SEQ_ESMF)
        these last modifications will become irrelevant when long term archiver gets implemented in 
        offline clm
   M  src/main/controlMod.F90
      - moved offline_atmdir to its own separate #ifdef
        #if (defined OFFLINE)
            namelist /clm_inparm/ offline_atmdir
        #endif
   M  src/main/lnd_comp_mct.F90
       - made numerous changes to only couple to sequential driver on atmosphere short wave timesteps
         the calendar used for the next radiation computation is determined via the following:
             call eshr_timemgr_clockGet( SyncClock, nextsw_cday=nextsw_cday )
       - all fluxes are averaged between dosend=.true. times 
       - the time stamp of the restart file is determined from the sync clock
       - the coordination with the sync clock is now determined at the end of the time loop due
         to the fact that the sync clock is advanced at the beginning of the driver time loop 
   M  src/main/do_close_dispose.F90
       - numerous changes were made to this file 
         added optional arguments rstwr and nlend and generalized code to respond to these arguments

Summary of testing:
   - Note that CLM_SEQCCSMROOT was set to a checked out version of the cam branch 
     https://svn-ccsm-models.cgd.ucar.edu/cam1/branch_tags/seqflxave_cam3_4_01/seqflxave16_cam3_4_12
   - The folloiwng files were modified to fix a SCAM problem account for the fact that the driver time step is now
     one hour:
        M  nl_files/scam_prep
        M  input_tests_master

  bluevista:
067 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 7
  bangkok/lf95:
034 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4

CLM tag used for the baseline comparison tests if applicable: clm3_5_01

IF tag changes answers relative to baseline comparison the
following should be filled in: Results were bfb for all offline tests
	
===============================================================
===============================================================
Tag name:  clm3_5_01
Originator(s):  erik (KLUZEK ERIK 1326 CGD)
Date: Wed May 16 14:14:59 MDT 2007
One-line Summary: Move newcn06 branch to trunk

Purpose of changes: Move newcn06-02_clm3_5_00 branch tag to trunk

Bugs fixed (include bugzilla ID): 471, 474, 475, 478, 479
  Add time to lightning test, add mkgriddata namelist back in,
  add new clmi dataset for cam, fix lonrof (from Tony), fix long-line
  in interpinic.

Describe any changes made to build system: Add new options to configure

  -ad_spinup    Turn on AD_SPINUP mode for bgc setting of CN [on | off]
  -exit_spinup  Turn on EXIT_SPINUP mode for bgc setting of CN [on | off]
  -pergro       Switch enables building CLM for perturbation growth tests.

Describe any changes made to the namelist: New options added to namelist, use query for datasets

  New namelist items:

      cycle_begyr     = integer, first year of offline atm data (e.g. 1948)
      cycle_nyr       = integer, number of years of offline atm data to cycle

  Use queryDefaultNamelist.pl to get datasets for namelists for test and run scripts

List any changes to the defaults for the boundary datasets:

	Add new clmi datasets and add datasets for OFFLINE mode to namelist xml file

Describe any substantial timing or memory changes: None

Code reviewed by: erik,thornton

List any svn externals directories updated (csm_share, mct, etc.): None

List all subroutines eliminated: None

List all subroutines added and what they do:

A      test/system/nl_files/singlept_long
A  +   tools/mkgriddata/mkgriddata.namelist --- Add back namelist that was missing
A  +   src/biogeochem/CASASummaryMod.F90
A  +   src/main/CASAiniTimeVarMod.F90

List all existing files that have been modified, and describe the changes:

-------> Add new tests for CN and cycle_ namelist items and use query script for filenames in namelists
M test/system/tests_posttag_purempi_regression
M test/system/tests_posttag_hybrid_regression
M test/system/tests_pretag_bluevista
M test/system/nl_files/10x15_cnall
M test/system/nl_files/10x15_pftdyn
M test/system/nl_files/t31_cnall
M test/system/nl_files/singlept_dgvm_long
M test/system/nl_files/t31_dgvm
M test/system/nl_files/1.9x2.5
M test/system/nl_files/singlept
M test/system/nl_files/10x15_dgvm
M test/system/nl_files/t31_casa
M test/system/nl_files/regional
M test/system/nl_files/t31_dgvm_long
M test/system/nl_files/t42half
M test/system/nl_files/t31
M test/system/nl_files/10x15
M test/system/input_tests_master
--------> 
M bld/run-pc.csh
M bld/DefaultCLM_INPARM_Namelist.xml
M bld/configure
M bld/queryDefaultNamelist.pl
M bld/run-lightning.csh
M bld/run-ibm.csh
M bld/config_clm_defaults.xml
M bld/run-frost.csh
--------> Changes to CN mode (also add ability to do pftdyn mode in CN and add cycle_* namelist variables
M src/main/clmtypeInitMod.F90
M src/main/clmtype.F90
M src/main/histFldsMod.F90
M src/main/CASAiniTimeVarMod.F90
M src/main/CNiniTimeVar.F90
M src/main/driver.F90
M src/main/atmdrvMod.F90
M src/main/initializeMod.F90
M src/main/pftdynMod.F90
M src/main/histFileMod.F90
M src/main/restFileMod.F90
M src/main/controlMod.F90
M src/main/clm_varctl.F90
M src/main/CNiniSpecial.F90
M src/main/surfrdMod.F90
M src/main/decompMod.F90
M src/biogeophys/BareGroundFluxesMod.F90
M src/biogeophys/CanopyFluxesMod.F90
M src/biogeophys/SurfaceAlbedoMod.F90
M src/biogeophys/Hydrology2Mod.F90
M src/biogeophys/BiogeophysicsLakeMod.F90
M src/biogeochem/CASASummaryMod.F90
M src/biogeochem/CNNStateUpdate1Mod.F90
M src/biogeochem/CNBalanceCheckMod.F90
M src/biogeochem/CASAMod.F90
M src/biogeochem/CNSummaryMod.F90
M src/biogeochem/CNPhenologyMod.F90
M src/biogeochem/CNCStateUpdate1Mod.F90
M src/biogeochem/CNDecompMod.F90
M src/biogeochem/CNC13StateUpdate1Mod.F90
M src/biogeochem/CNrestMod.F90
M src/biogeochem/CNAnnualUpdateMod.F90
M src/biogeochem/C13SummaryMod.F90
M src/biogeochem/CNAllocationMod.F90
M src/biogeochem/CNEcosystemDynMod.F90
M src/biogeochem/CNSetValueMod.F90
M src/riverroute/RtmMod.F90
M tools/mksurfdata/mksrfdat.fdynfile
M tools/interpinic/addglobal.F90
-------------> Tweak namelists
M tools/mkgriddata/mkgriddata.regional
M tools/mkgriddata/mkgriddata.singlept

Summary of testing:

  bluevista: All PASS except
024 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................FAIL! rc= 7
028 bl252 TBL.sh 17p_cnn_dm 10x15_cnall 48 ........................FAIL! rc= 7
067 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 7

  bangkok/lf95: All PASS except

014 bl252 TBL.sh 17p_cnn_dm 10x15_cnall 48 ........................FAIL! rc= 7
034 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers:
    - what code configurations: CN-mode only
    - what platforms/compilers: All
    - nature of change (changes to CN climate)

===============================================================
===============================================================
Tag name:  clm3_5_00
Originator(s):  erik (Erik Kluzek)
Date: Thu May  3 12:03:53 MDT 2007
Date:One-line Summary: New surface datasets, improved canopy integration, and various improvements to Hydrology

Purpose of changes (Since CLM3.0):

  CLM3.5 is considerably different to CLM3.0, particularly with respect to its 
  simulation of the hydrologic cycle.   The modifications consist of new surface 
  datasets based on Moderate Resolution Imaging Spectroradiometer (MODIS) products 
  (Lawrence and Chase 2007), an improved canopy integration scheme 
  (Thornton and Zimmermann 2007), scaling of canopy interception (Lawrence et al. 2007), 
  a simple TOPMODEL-based model for surface and sub-surface runoff (Niu et al. 2005), a 
  simple groundwater model for determining water table depth (Niu et al. 2007), and a 
  new frozen soil scheme (Niu and Yang 2006).  

  There are four additional modifications.  Three of these, an improved description of 
  soil water availability, a resistance term to reduce excessive soil evaporation, and the
  introduction of a factor to simulate nitrogen limitation on plant productivity, can be 
  categorized as new or improved parameterizations from the perspective of CLM3.  The 
  other may be categorized as fixing an algorithmically defective existing parameterization
  (correction to snowage calculation so that snowage increases monotonically) 
  (Dickinson et al. 2006).

  See:

  http://www.cgd.ucar.edu/tss/clm/distribution/clm3.5/

  for more information, and for technical and scientific papers that describe CLM3.5.

  Lastly, we are distributing a new forcing dataset with the new code.  This
  dataset was derived by combining observation-based analyses of monthly precipitation and
  surface air temperature with intramonthly variations from the NCEP/NCAR reanalysis 
  (Qian et al., 2006)

  If you would like to run CLM-CN, please contact Peter Thornton (thornton@ucar.edu).
  If you would like to run CLM-DGVM, please contact Sam Levis (slevis@ucar.edu).
  If you would like to run CLM-CASA', please contact Forrest Hoffman (hof@ornl.gov).

Describe any bug fixes:

  o A revision of RTM-subcycling and corrections to a few land-locked grid cells.
  o A more efficient soil evaporation calculation based on PFT demand.
  o A fix to aggregation of LAI from high-resolution source data to CLM surface data.
  o Changing Temperature of freezing of water from 273.16 (triple point of water) to 273.15.

Summarize any software engineering improvements:

  o Add option to run CLM at a finer resolution than the atmospheric model coupled to
     (Tony Craig and others)
  o MCT (Model Coupling Toolkit) used to describe decompositions and do redistributions.
  o Remove dependences on CAM modules and data structures.
  o Use csm_share clocks and CCSMInit objects for simulation time information and
    initialization information needed by all CCSM models.
  o Update time-management to ESMF_2_2_2r interfaces and use the WRF implementation of
    ESMF time-management modules.
  o Made restart datasets double precision NetCDF rather than binary 
    (except history restarts).
  o Add interface layers to link to Sequential CCSM (formally standalone CAM) using MCT.
  o Parallelize RTM, by Tony Craig and Pat Worley.
  o Add a new testing suite to do automated testing for any code changes.
  o Improve memory scaling with a new decomposition from Tony Craig.
  o Move make surface dataset capability to an offline tool (mksurfdata).
  o Add an offline tool to create grid datasets needed for initialization (mkgriddata).
  o Add ability to run concurrent CCSM in single-executable mode.
  o Running with SCAM (Single Column Atmospheric Model) mode modularized better.

Versions of any externally defined libraries: (under src/utils)

  o csm_share:        share3_070321 (add flds, eshr and dshr directories, 
                                     add shr_inputinfo_mod, eshr_timemgr_mod, 
                                     other modules for shared data work)
  o esmf_wrf_timemgr: esmf_wrf_timemgr_060616 (or can link to full ESMF_2_2_2r)
  o timing:           timing_070328 (extensive updates and utilize PAPI and new namelist)
  o mct:              MCT2_3_0_070206 (allow to build with code, Cray mods, misc.)

Describe any changes made to build system: 

  o A configure script was created to create files needed to build the model. 
  o There are also cshell run scripts for different platforms to: 
       configure, build and run the model.
  o Remove SPMD CPP token -- use src/utils/mct/mpi-serial library for serial mode.
  o Remove HIDE_MPI token.
  o Remove CAM and COUP_CAM CPP tokens -- replace with SEQ_MCT and SEQ_ESMF.
  o Remove NOCOMPETE CPP token.
  o Most SCAM #ifdef's removed.
  o Remove TIMING_BARRIERS CPP token -- add option to prof_inparm namelist.
  o See src/utils/timing for new tokens added for timing library 
     (HAVE_PAPI, THREADED_OMP, DIAG, HASH).
  o MCT included with offline CLM.

  Build features added -- but unsupported for public release:

  o Port to jaguar.ccs.ornl.gov (Cray XT3/XT4)
  o Port to Bluegene/L (frost.ucar.edu) (add BGL CPP token)
  o Port to lightning.ucar.edu (frost.ucar.edu with Pathscale)
  o Add SINGLE_EXEC CPP token for running concurrent CCSM in single-executable mode.
  o Add CN CPP token and CN BGC code.
  o Add NO_FIRE CPP token for use by CN mode.
  o Add AD_SPINUP and EXIT_SPINUP CPP token for initial spinup of CN.
  o Add DUST and PROGSST CPP tokens.
  o Add COUP_WRF CPP token.

Describe any changes made to the namelist:

  Main namelist name changed from clmexp to clm_inparm

  Option to run clm at a finer mesh than the atmosphere added several namelist items.

  flndtopo        = 256 character land topography file name
  fatmgrid        = 256 character atmosphere grid data file name
  fatmlndfrc      = 256 character landfrac (on atm grid) file name
  fatmtopo        = 256 character atmosphere topography file name

  Decomposition/performance control:

  nsegspc         = Number of segments per clump for new decomp. 
                    1 will produce poor loadbalance, infinity yields too many
                    segments per pe but good load balance. (default 20)

  All mksrf_* options moved to the mksurfdata offline tool. So instead of
  creating surface datasets by running clm -- you run the mksurfdata tool
  to create them.

  mksrf_* = Removed from namelist.

  Miscellaneous:

  rest_flag            = logical, turns restart file writing on (default .true.)
  wrtdia               = true if want output written  (default .false.)
  create_crop_landunit = true => separate crop landunit is not created by default
                         (currently broken see KnownBugs) (default .false.)

  New prof_inparm namelist added for timing library.

   profile_single_file  = Write timing output to single file or file per task 
                          (default single)
   profile_disable      = Turn timing off. (default .false.)
   profile_barrier      = Turn MPI barriers on in t_barrierf calls. (default .false.)
   profile_depth_limit  = Integer indicating maximum number of levels of timer nesting 
                          (default 99999)
   profile_detail_limit = integer indicating maximum detail level to profile (default 0)
   profile_timer        = integer indicating which timer to use
      GPTLwall           = 1
      GPTLcpu            = 2
      GPTLabort_on_error = 3
      GPTLoverhead       = 4
      GPTLdepthlimit     = 5
      GPTLgettimeofday   = 6
      GPTLnanotime       = 7
      GPTLrtc            = 8
      GPTLmpiwtime       = 9
      GPTLclockgettime   = 10
      GPTLpapitime       = 11
      (default is 9, except on UNICOSMP where it is 8)

  Namelist items added -- but unsupported in public release:

  co2_type             = values of 'prognostic','diagnostic','constant' 
                         (only constant mode for OFFLINE)

  CASA':

  spunup   =  0=no, 1=yes (used with nsrest/=1 only)   (default 0)
  lalloc   =  0=fixed allocation, 1=dynamic allocation (default 1)
  lnpp     =  1=gpp*gppfact,2=fn(lgrow)*gppfact        (default 2)
  q10      =  temperature dependence                   (default 2.0)
  fcpool   =  Carbon Pool initial state filename

List any changes to the defaults for the boundary datasets:

 Use following files for T42 resolution:

 finidat        = '$CSMDATA/inidata_3.1/offline/clmi_0000-01-01_064x128_c070403.nc'
 fsurdat        = '$CSMDATA/surfdata/surfdata_64x128_c070501.nc'
 fatmgrid       = '$CSMDATA/griddata/griddata_64x128_060829.nc'
 fatmlndfrc     = '$CSMDATA/griddata/fracdata_64x128_USGS_070110.nc'
 fpftcon        = '$CSMDATA/pftdata/pft-physiology.c070207'
 offline_atmdir = '$CSMDATA/NCEPDATA.Qian.T62.c051024'
 frivinp_rtm    = '$CSMDATA/rtmdata/rdirc.05.061026'

 Only needed for CN mode:

 fndepdat       = '$CSMDATA/ndepdata/ndep_clm_2000_64x128_c060414.nc'

Code reviewed by: 
   bonan, dlawren, erik, mvertens, nanr, oleson, pworley, slevis, tcraig, thornton

Summary of testing: Other than bugs documented in KnownBugs works on following machines:

   bluevista.ucar.edu ---- IBM/SP running AIX
   blueice.ucar.edu ------ IBM/SP running AIX
   bangkok.cgd.ucar.edu -- Linux cluster (both PGI and Lahey compilers)
   tempest.ucar.edu ------ SGI running IRIX
   lightning.ucar.edu ---- Linux cluster (using Pathscale compiler)
   jaguar.ccs.ornl.edu --- Cray XT3/XT4 (using Cray-specific PGI compiler) (builds)
   phoenix.ccs.ornl.edu -- Cray X1 (using Cray-specific PGI compiler) (builds)

  MSS location of control simulations used to validate new climate:

	OFFLINE: /OLESON/csm/hydp2_off_communn_hk44
        CAM/CLM: /OLESON/csm/hydp2_communn_hk44a
        CCSM:    /CCSM/csm/b31.020ws
   
  URL for LMWG diagnostics output used to validate new climate:

OFFLINE:
http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk44a-hyd_off_con3d/setsIndex.html

CAM/CLM:
http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_communn_hk44aa-hyd_sstb/setsIndex.html

CCSM:
http://www.cgd.ucar.edu/tss/clm/diagnostics/ccsm2_prod/b31.020wsb-b31.002b/setsIndex.html

===============================================================
===============================================================
Tag name:  clm3_4_2
Originator(s):  erik (Erik Kluzek)
Date: Wed May  2 15:09:41 MDT 2007
Date:One-line Summary: Use new surfdatasets, add new tests, fix newcprnc makefile, fix bugs, and documentation, add script to query XML file 

Purpose of changes: Bug-fixes in preparation of clm3_5_00

        Use new surface datasets created by Nan R.
        Add new sets of regression tests
	Fix so that newcprnc will work on pathscale
        Fix so that newcprnc can be tested
        Fix so that PGI mode can be tested on bangkok
        Fix so that run-pc script runs for both lahey and pgi
        Fix some documentation
        Add script to query the Namelist XML file

Bugs fixed (include bugzilla ID): 461, 463, 468

Describe any changes made to build system: None

Describe any changes made to the namelist: surface datasets updated

List any changes to the defaults for the boundary datasets: surface datasets updated

Describe any substantial timing or memory changes: None

Code reviewed by: self, had nanr review query script

List any svn externals directories updated (csm_share, mct, etc.): None

List all subroutines eliminated: Remove convert_ascii as no longer needed
   (Can use earlier CLM versions if needed in the future)

List all subroutines added and what they do:

---------> Add a set of regression tests that will do almost all tests in the list
A test/system/tests_posttag_hybrid_regression
A test/system/tests_posttag_purempi_regression
---------> Add a script to query the contents to the DefaultCLM_INPARM_Namelist.xml file
---------> to ensure it is read correctly. Also can be used to copy files as well.
A bld/queryDefaultNamelist.pl
---------> Add files so that newcprnc uses the standard tools Makefile and can be tested by
---------> test_driver.sh
A tools/newcprnc/misc.h
A tools/newcprnc/Filepath
A tools/newcprnc/newcprnc.runoptions
A tools/newcprnc/preproc.h
A tools/newcprnc/cprnc.F90
A tools/newcprnc/Srcfiles

List all existing files that have been modified, and describe the changes:

M test/system/nl_files/t31_cnall
M test/system/nl_files/t31_dgvm
M test/system/nl_files/1.9x2.5
M test/system/nl_files/10x15_cnall
M test/system/nl_files/10x15_dgvm
M test/system/nl_files/t31_casa
M test/system/nl_files/10x15_pftdyn
M test/system/nl_files/t31_dgvm_long
M test/system/nl_files/t31
M test/system/nl_files/10x15
M test/system/input_tests_master
M test/system/README
M test/system/tests_pretag_bangkok
M test/system/test_driver.sh
M test/system/tests_pretag_tempest
M tools/newcprnc/Makefile ----> Use standard tools Makefile
---------> Update datasets get right surface dataset, get working on bangkok
M bld/run-pc.csh
M bld/DefaultCLM_INPARM_Namelist.xml
M bld/run-lightning.csh
M bld/run-ibm.csh
M bld/run-frost.csh
---------> Add an update date option
M doc/UpDateChangeLog.pl
---------> Fix minor problems in documenation
M src/biogeochem/DGVMMod.F90
M src/main/initializeMod.F90
M src/main/scam_setlatlonidx.F90
M src/main/program_off.F90
M src/main/surfrdMod.F90

Summary of testing:

All standard tests PASS (10x15, and 1.9x2.5 tests are different because of new surfdata files)*

  bluevista: All tests PASS except
  For regression tests the following fail because of changes in surfdata sets
054 bl551 TBL.sh _dh 10x15 48 .....................................FAIL! rc= 7
058 bl563 TBL.sh _h 1.9x2.5 -10 ...................................FAIL! rc= 7
062 bl552 TBL.sh _ds 10x15 24 .....................................FAIL! rc= 7
082 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 4

  blueice: All tests PASS except
  For regression tests the following fail because of changes in surfdata sets
054 bl551 TBL.sh _dh 10x15 48 .....................................FAIL! rc= 7
058 bl563 TBL.sh _h 1.9x2.5 -10 ...................................FAIL! rc= 7
062 bl552 TBL.sh _ds 10x15 24 .....................................FAIL! rc= 7
082 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 4

  For regression tests the following fail because of changes in surfdata sets

054 bl551 TBL.sh _dh 10x15 48 .....................................FAIL! rc= 7
058 bl563 TBL.sh _h 1.9x2.5 -10 ...................................FAIL! rc= 7
062 bl552 TBL.sh _ds 10x15 24 .....................................FAIL! rc= 7
082 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 4

  lightning: All PASS except (because of earlier reported bug 444)

019 sm551 TSM.sh _dh 10x15 48 .....................................FAIL! rc= 8
020 er551 TER.sh _dh 10x15 10+38 ..................................FAIL! rc= 5
021 br551 TBR.sh _dh 10x15 24+24 ..................................FAIL! rc= 5

  jaguar: Build of first test works (need datasets to do more testing)
  robin/phoenix: Build of all standard tests work (need datasets to do more testing)
  bangkok: All standard tests PASS*

PGI testing:

011 sm132 TSM.sh 4p_vodsr_dm t42half 48 ...........................FAIL! rc= 8
012 er132 TER.sh 4p_vodsr_dm t42half 10+38 ........................FAIL! rc= 5
013 br132 TBR.sh 4p_vodsr_dm t42half 24+24 ........................FAIL! rc= 5
014 bl132 TBL.sh 4p_vodsr_dm t42half 48 ...........................FAIL! rc= 4
015 sm135 TSM.sh 4p_vodsr_m t42half 48 ............................FAIL! rc= 8
022 er212 TER.sh 17p_cnn_dm t31_cnall 10+38 .......................FAIL! rc= 9
038 sm471 TSM.sh 10p_dgvm_s singlept_dgvm_long -730 ...............FAIL! rc= 8
039 er471 TER.sh 10p_dgvm_s singlept_dgvm_long -334+-396 ..........FAIL! rc= 5
040 bl471 TBL.sh 10p_dgvm_s singlept_dgvm_long -730 ...............FAIL! rc= 4
046 er564 TER.sh _m 1.9x2.5 -5+-5 .................................FAIL! rc= 9
060 bl711 TBLtools.sh mksurfdata namelist .........................FAIL! rc= 7
062 bl771 TBLtools.sh mksurfdata singlept .........................FAIL! rc= 7
063 sm811 TSMtools.sh interpinic runoptions .......................FAIL! rc= 6
068 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 4

Test 046 and 022 restart testis fail because restart IC file was NOT in the right place
Tests 038-040 "singlept_dgvm_long" test fails because needs more input NCEPDATA
Test 063 interpinic FAIL's because file using does NOT exist on bangkok

Lahey testing:

011 sm132 TSM.sh 4p_vodsr_dm t42half 48 ...........................FAIL! rc= 8
012 er132 TER.sh 4p_vodsr_dm t42half 10+38 ........................FAIL! rc= 5
013 br132 TBR.sh 4p_vodsr_dm t42half 24+24 ........................FAIL! rc= 5
014 bl132 TBL.sh 4p_vodsr_dm t42half 48 ...........................FAIL! rc= 4
015 sm135 TSM.sh 4p_vodsr_m t42half 48 ............................FAIL! rc= 8
022 er212 TER.sh 17p_cnn_dm t31_cnall 10+38 .......................FAIL! rc= 11
023 br212 TBR.sh 17p_cnn_dm t31_cnall 24+24 .......................FAIL! rc= 11
029 bl312 TBL.sh 4p_casa_dm t31_casa 48 ...........................FAIL! rc= 7
034 bl412 TBL.sh 10p_dgvm_dm t31_dgvm 48 ..........................FAIL! rc= 7
044 bl552 TBL.sh _ds 10x15 24 .....................................FAIL! rc= 7
048 bl564 TBL.sh _m 1.9x2.5 -10 ...................................FAIL! rc= 7
063 sm811 TSMtools.sh interpinic runoptions .......................FAIL! rc= 6
066 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4
067 bl982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 2
068 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 4

Test 022 (CN restart test) fails -- because answers are different! (Documented as bug 469)
TBL tests fail because of change in surfdata files
Tests 038-040 "singlept_dgvm_long" test fails because needs more input NCEPDATA
Test 063 interpinic FAIL's because file using does NOT exist on bangkok
Tests 067-068 fail because of a variable defined in CAM is not initialized.

  tempest: All standard tests PASS*

  CCSM tests FAIL because we currently don't have a version of CCSM that will work with 
  this version of CLM (because of the timing library updates and incomptabilities).
  run scripts work on bluevista and bangkok (for Lahey and PGI)

===============================================================
===============================================================
Tag name:  clm3_4_1
Originator(s):  erik (KLUZEK ERIK 1326 CGD)
Date: Mon Apr 30 14:18:46 MDT 2007
One-line Summary: Add documentation to code from Keith Oleson, and set keywords on files so Version will be given

Purpose of changes: Add documentation to code and set keywords on files that keep track of versions on output NetCDF files

Bugs fixed (include bugzilla ID): 453, 458

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.): None

List all subroutines eliminated: None

List all subroutines added and what they do:

A         DefaultCLM_INPARM_Namelist.xml   ! Add XML file that CAM will use to reference what datasets to point to

	This file will later be used by both CCSM and CLM

List all existing files that have been modified, and describe the changes:

M      test/system/TER.sh
M      test/system/TSM.sh

 ----------------> Remove files with RCS keywords, and activate keywords for files that use them
M      src/main/abortutils.F90
MM     src/main/histFileMod.F90
MM     src/main/restFileMod.F90
M      src/main/scam_setlatlonidx.F90
M      src/main/decompMod.F90
M      tools/mkgriddata/creategridMod.F90
M      tools/mksurfdata/mkfileMod.F90
M      tools/mksurfdata/mksurfdata.namelist
M      tools/mksurfdata/mksurfdata.regional
M      tools/mksurfdata/mksurfdata.singlept
M      tools/interpinic/interpinic.F90
M      tools/interpinic/addglobal.F90
M      tools/interpinic/clmi_1999-01-02_10x15_c070330.nc   ! Put descriptive data on file

 ----------------> Add documentation to code from Keith Oleson
M      src/main/iniTimeConst.F90
M      src/main/clmtype.F90
M      src/main/histFldsMod.F90
M      src/main/mkarbinitMod.F90
M      src/biogeophys/BalanceCheckMod.F90
M      src/biogeophys/SoilTemperatureMod.F90
M      src/biogeophys/Biogeophysics1Mod.F90
M      src/biogeophys/Hydrology1Mod.F90
M      src/biogeophys/Hydrology2Mod.F90
M      src/biogeophys/SoilHydrologyMod.F90
M      src/biogeophys/BareGroundFluxesMod.F90
M      src/biogeophys/CanopyFluxesMod.F90

Summary of testing:

  bluevista:
062 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 7
  lightning: All PASS except
019 sm551 TSM.sh _dh 10x15 48 .....................................FAIL! rc= 8
020 er551 TER.sh _dh 10x15 10+38 ..................................FAIL! rc= 5
021 br551 TBR.sh _dh 10x15 24+24 ..................................FAIL! rc= 5
  bangkok/lf95:
033 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4

===============================================================
===============================================================
Tag name:  clm3_expa_99
Originator(s):  erik (KLUZEK ERIK 1326 CGD)
Date:  Tue Apr 24 13:27:10 MDT 2007
One-line Summary: Update to mklai02_clm3_expa_98, mklai changes, dust changes, TKFRZ fix from Keith O., fix CASA

Purpose of changes: Answer changing code changes moved onto the clm trunk: 
    mklai changes for mksurfdata -- reviewed by Sam L., and Nan R. extensively
    changes for DUST mode from Natalie M. and Francis V.
    TKFRZ fix from Keith O.
    Fix CASA' from problem Sam L. found with a suggested fix by Inez Fung

Bugs fixed (include bugzilla ID): 389 (partial), 442, 443, 445, 450

Describe any changes made to build system: Fix build for jaguar and phoenix

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: nanr, slevis, dlawren, oleson, and bonan reviewed the mklai changes

List any svn externals directories updated (csm_share, mct, etc.): None

List all subroutines eliminated: None

List all subroutines added and what they do: Documentation files

A  +   doc/README.DGVM
A  +   doc/KnownBugs

List all existing files that have been modified, and describe the changes:

---------------------> Improve testing
M      test/system/nl_files/t31_cnall
M      test/system/nl_files/singlept_dgvm_long
M      test/system/nl_files/1.9x2.5
M      test/system/nl_files/t31_dgvm
M      test/system/nl_files/singlept
M      test/system/nl_files/10x15_cnall
M      test/system/nl_files/10x15_dgvm
M      test/system/nl_files/t31_casa
M      test/system/nl_files/regional
M      test/system/nl_files/10x15_pftdyn
M      test/system/nl_files/t31_dgvm_long
M      test/system/nl_files/t42half
M      test/system/nl_files/t31
M      test/system/nl_files/10x15
M      test/system/tests_posttag_robin
M      test/system/input_tests_master
M      test/system/tests_pretag_jaguar
M      test/system/tests_posttag_phoenix
M      test/system/test_driver.sh
M      test/system/TSCscam.sh

---------------------> Change calculation of LAI,SAI,Canopy-top/bottom so weighted by %-PFT
M      tools/mksurfdata/mkfmax.F90
M      tools/mksurfdata/mklaiMod.F90
M      tools/mksurfdata/mkglacier.F90
M      tools/mksurfdata/mkurban.F90
M      tools/mksurfdata/mksoitex.F90
M      tools/mksurfdata/areaMod.F90
M      tools/mksurfdata/mksrfdat.F90
M      tools/mksurfdata/Srcfiles
M      tools/mksurfdata/mksoicol.F90
M      tools/mksurfdata/mkpftMod.F90

---------------------> Use new default files at T42, add and correct documentation
M      bld/run-pc.csh
M      bld/run-lightning.csh
M      bld/Makefile.in
M      bld/run-ibm.csh
M      bld/config_clm_defaults.xml
M      bld/system_defaults.xml
M      bld/run-frost.csh

---------------------> Remove uneeded shr_sys_flush, put #ifndef UNICOSMP around shr_sys_flush(6), correct MCT vector calls
                       needed for phoenix/robin build.

M      src/biogeochem/CNCStateUpdate2Mod.F90
M      src/biogeochem/CNGapMortalityMod.F90
M      src/biogeochem/CNC13StateUpdate2Mod.F90
M      src/biogeochem/CNFireMod.F90
M      src/biogeochem/CASAMod.F90 -------------------> Fix CASA by uncommenting lines according to Inez Fung
M      src/biogeochem/CNPrecisionControlMod.F90
M      src/biogeochem/DUSTMod.F90 -------------------> Changes from Natalie M. and Francis Vitt for CAM/CLM3.5 Aerosols
M      src/biogeochem/CNPhenologyMod.F90
M      src/biogeochem/CNCStateUpdate1Mod.F90
M      src/biogeochem/CNDecompMod.F90
M      src/biogeochem/CNCStateUpdate3Mod.F90
M      src/biogeochem/CNC13StateUpdate1Mod.F90
M      src/biogeochem/CNC13StateUpdate3Mod.F90
M      src/biogeochem/CNAllocationMod.F90
M      src/biogeochem/CNC13FluxMod.F90
M      src/biogeochem/CNEcosystemDynMod.F90
M      src/biogeochem/CNVegStructUpdateMod.F90
M      src/main/inicFileMod.F90
M      src/main/abortutils.F90
M      src/main/driver.F90
M      src/main/ncdio.F90
M      src/main/atmdrvMod.F90 -----------------------> Changes from Keith O. to fix TKFRZ change
M      src/main/initializeMod.F90
M      src/main/clmtypeInitMod.F90
M      src/main/histFileMod.F90
M      src/main/clm_csmMod.F90
M      src/main/controlMod.F90 ----------------------> Fix #ifdef's so extra namelist items only on for COUP_CSM or OFFLINE
M      src/main/initSurfAlbMod.F90
M      src/main/clm_time_manager.F90
M      src/main/initGridCellsMod.F90
M      src/main/program_off.F90
M      src/main/surfrdMod.F90
M      src/main/decompMod.F90
M      src/main/areaMod.F90
M      src/main/clm_mct_mod.F90
M      src/riverroute/RtmMod.F90
M      src/biogeophys/SurfaceRadiationMod.F90
M      src/biogeophys/SurfaceAlbedoMod.F90
M      src/biogeophys/Hydrology2Mod.F90
M      src/biogeophys/CanopyFluxesMod.F90

Summary of testing:

  bluevista: All PASS except
004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................FAIL! rc=
009 bl127 TBL.sh 17p_vodsr_dh t31 48 ..............................FAIL! rc=
014 bl131 TBL.sh 4p_vodsr_dh t42half 48 ...........................FAIL! rc=
019 bl141 TBL.sh 17p__dh 10x15_pftdyn 48 ..........................FAIL! rc=
024 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................FAIL! rc=
028 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................FAIL! rc=
032 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................FAIL! rc=
037 bl471 TBL.sh 10p_dgvm_s singlept_dgvm_long -730 ...............FAIL! rc=
041 bl563 TBL.sh _h 1.9x2.5 -10 ...................................FAIL! rc=
045 bl552 TBL.sh _ds 10x15 24 .....................................FAIL! rc=
049 bl573 TBL.sh _s singlept -10 ..................................FAIL! rc=
053 bl583 TBL.sh _dh regional -10 .................................FAIL! rc=
057 bl711 TBLtools.sh mksurfdata namelist .........................FAIL! rc=
059 bl771 TBLtools.sh mksurfdata singlept .........................FAIL! rc=
062 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 7
  lightning: All PASS except
004 bl112 TBL.sh 4p_vodsr_dm t31 48 ...............................FAIL! rc=
009 bl142 TBL.sh 17p__dm 10x15_pftdyn 48 ..........................FAIL! rc=
014 bl252 TBL.sh 17p_cnn_dm 10x15_cnall 48 ........................FAIL! rc=
018 bl451 TBL.sh 10p_dgvm_dm 10x15_dgvm 48 ........................FAIL! rc=
019 sm551 TSM.sh _dh 10x15 48 .....................................FAIL! rc= 8
020 er551 TER.sh _dh 10x15 10+38 ..................................FAIL! rc= 5
021 br551 TBR.sh _dh 10x15 24+24 ..................................FAIL! rc= 5
022 bl551 TBL.sh _dh 10x15 48 .....................................FAIL! rc=
026 bl573 TBL.sh _s singlept -10 ..................................FAIL! rc=
029 bl771 TBLtools.sh mksurfdata singlept .........................FAIL! rc=
  bangkok/lf95:
004 bl112 TBL.sh 4p_vodsr_dm t31 48 ...............................FAIL! rc=
009 bl142 TBL.sh 17p__dm 10x15_pftdyn 48 ..........................FAIL! rc=
014 bl252 TBL.sh 17p_cnn_dm 10x15_cnall 48 ........................FAIL! rc=
018 bl312 TBL.sh 4p_casa_dm t31_casa 48 ...........................FAIL! rc=
022 bl451 TBL.sh 10p_dgvm_dm 10x15_dgvm 48 ........................FAIL! rc=
026 bl551 TBL.sh _dh 10x15 48 .....................................FAIL! rc=
030 bl573 TBL.sh _s singlept -10 ..................................FAIL! rc=
033 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4
  robin: All compile tests pass

CLM tag used for the baseline comparison tests if applicable: clm3_expa_98

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers:
    - what code configurations: All
    - what platforms/compilers: All
    - nature of change: new LAI, TKFRZ change is roundoff different, Dust and CASA changes are significant

===============================================================
===============================================================
Tag name:  clm3_expa_98
Originator(s):  erik (KLUZEK ERIK 1326 CGD)
Date:  Wed Apr 18 09:51:53 MDT 2007
One-line Summary: Move externals to top, make SOM4 the default, rename setidx file, use new datafiles, 
    remove NUMLONS read, tweak testing, remove shell_cmd, remove read of old surfdata file

Purpose of changes: Some simple cleanup preparing for CLM3.5 release

Bugs fixed (include bugzilla ID): 440, 441

Describe any changes made to build system: None

Describe any changes made to the namelist: Use new datasets

List any changes to the defaults for the boundary datasets: Use new NCEP forcing datasets,
  and new Nitrogen deposition datasets

Describe any substantial timing or memory changes: None

Code reviewed by: self

List any svn externals directories updated (csm_share, mct, etc.):

	Directories are the same -- but SVN externals themselves moved to top level

List all subroutines eliminated:

D      test/system/tests_pretag_blueice > Rename to posttag filename
D      bld/empty -----------------------> Rename to usr.src
D      src/main/setlatlonidx.F90 -------> Rename to scam_setlatlonidx.F90 filename
D      src/main/system_cmd.c
D      src/main/cfort.h
D      src/SVN_EXTERNAL_DIRECTORIES ----> Move to top layer

List all subroutines added and what they do:

  -------------------> Files renamed from above
A  +   test/system/tests_posttag_blueice
A  +   bld/usr.src
A  +   SVN_EXTERNAL_DIRECTORIES
A  +   src/main/scam_setlatlonidx.F90

  -------------------> New files
A      test/system/config_files/10p_dgvm_s -------> New DGVM test
A  +   test/system/tests_posttag_blueice ---------> Rename
A      test/system/tests_posttag_robin -----------> Add tests for robin/phoenix
A      test/system/tests_posttag_phoenix
A      test/system/nl_files/singlept_dgvm_long ---> Add new singlept DGVM test
  -------------------> Add new documentation README files
A      tools/README
A      bld/README
A      Copyright ----> CCSM Copyright file
A      README

List all existing files that have been modified, and describe the changes:

  -------------------> Tweak testing -- use new datasets, increase diversity of testing
M      test/system/tests_pretag_bluevista
M      test/system/nl_files/t31_cnall
M      test/system/nl_files/1.9x2.5
M      test/system/nl_files/t31_dgvm
M      test/system/nl_files/singlept
M      test/system/nl_files/10x15_cnall
M      test/system/nl_files/10x15_dgvm
M      test/system/nl_files/t31_casa
M      test/system/nl_files/regional
M      test/system/nl_files/10x15_pftdyn
M      test/system/nl_files/t31_dgvm_long
M      test/system/nl_files/t42half
M      test/system/nl_files/t31
M      test/system/nl_files/10x15
M      test/system/input_tests_master
M      test/system/test_driver.sh
   ---------------------> Remove system_cmd.c from list of source files needed to compile
M      tools/mksurfdata/Srcfiles
M      tools/interpinic/interpinic.F90 <--- fix interpinic compile on bluevista
M      tools/mkgriddata/Srcfiles
   ---------------------> Use new datasets, make sure works
M      bld/run-pc.csh
M      bld/configure ---- Remove SOM4 CPP declaration
M      bld/run-lightning.csh
M      bld/run-ibm.csh
M      bld/run-frost.csh
   ---------------------> Make SOM4 the default remove other option, remove read of NUMLON
   ---------------------> Remove read of old surfdata sets, remove shell_cmd
M      src/biogeochem/CNDecompMod.F90
M      src/biogeochem/STATICEcosysDynMod.F90
M      src/main/ncdio.F90
M      src/main/fileutils.F90 -----> Remove shell_cmd as unused now.
M      src/main/iniTimeConst.F90
M      src/main/clm_varsur.F90
M      src/main/surfrdMod.F90

Summary of testing:

  bluevista:    All PASS, except
062 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 7
  bangkok/lf95: All PASS
  tempest:      All PASS, except
033 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4

CLM tag used for the baseline comparison tests if applicable: clm3_expa_97

===============================================================
===============================================================
Tag name:  clm3_expa_97
Originator(s):  erik (KLUZEK ERIK 1326 CGD)
Date:  Wed Apr 11 12:18:32 MDT 2007
One-line Summary: Remove SPMD, update to clm proc tag, update timing, improve testing

Purpose of changes:
     Remove SPMD #ifdefs -- use mpi-serial code
     Remove COUP_CAM #ifdefs for SEQ_MCT || SEQ_ESMF
     Remove LOCAL_DEBUG CPP #ifdefs
     Update to prof05_clm3_expa_92 tag (timing changes, SCAM fixes)
     Update timing library to latest
     Fix bugs
     Improve test suite
     Change scripts so will rebuild each time (only configure first time if config file DNE)
     Change tool Makefile to be consistent and have USER_ overload options.
     Add script to update ChangeLog

Bugs fixed (include bugzilla ID):  337, 361, 389(partial), 407, 408, 417, 428
     337 -- SPMD
     361 -- IRIX
     389 -- Testing
     407 -- Single gridcell
     408 -- mksurfdata,mkgriddata compiling
     417 -- write last file to mss correctly
     428 -- pdt-dyn mode now restarts correctly

Describe any changes made to build system: Remove HIDE_MPI, remove 
     stuff left over from CAM Makefile, put FORTRAN name definition in configure
     remove LOCAL_DEBUG CPP #ifdefs

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: mvertens, oleson, thornton (all just briefly)

List any svn externals directories updated (csm_share, mct, etc.):
        Update csm_share to share3_070321
        Update timing    to timing_070328

List all subroutines eliminated:

D      bld/run-sgi.csh --------------------> Remove SGI run script
D      test/system/tests_pretag_bluesky ---> Remove since bluesky is gone
D      tools/mksurfdata/mksrfdat.namelist -> Change name to mksurfdata.namelist

   -------> Rename interpinic files to *.F90

D      tools/interpinic/fmain.f90
D      tools/interpinic/wrap_nf.f90
D      tools/interpinic/shr_kind_mod.f90
D      tools/interpinic/interpinic.f90
D      tools/interpinic/addglobal.f90

   --------> Remove file no longer needed by SCAM or for SPMD mode
D      src/main/getnetcdfdata.F90
D      src/main/mpiinc.F90


List all subroutines added and what they do:

------- Add concurrent and sequential CCSM tests, add more resolutions, improve tools tests
A      test/system/TSMconccsm.sh   ----------- Concurrent CCSM test
--------------------> New configurations to test
A      test/system/config_files/scam_ds
A      test/system/config_files/_h
A      test/system/config_files/_dh
A      test/system/config_files/_m
A      test/system/config_files/_o
A      test/system/config_files/_dm
A      test/system/config_files/_do
A      test/system/config_files/_s
A      test/system/config_files/_ds
A      test/system/config_files/seqccsm_4x5_dh
A      test/system/config_files/seqccsm_64x128_s
A      test/system/config_files/seqccsm_10x15_dm
A      test/system/config_files/17p__m
A      test/system/config_files/17p__o
A      test/system/config_files/17p__dh
A      test/system/config_files/17p__dm
A      test/system/config_files/17p__do
A      test/system/config_files/17p__h
A      test/system/TSMseqccsm.sh ------------- Sequential CCSM test
--------------------> New namelists and resolutions to test
A      test/system/nl_files/scam
A      test/system/nl_files/1.9x2.5
A      test/system/nl_files/singlept
A      test/system/nl_files/10x15_cnall
A      test/system/nl_files/10x15_dgvm
A      test/system/nl_files/seqccsm
A      test/system/nl_files/regional
A      test/system/nl_files/scam_prep
A      test/system/nl_files/10x15
A      test/system/README
A      test/system/TCBseqccsm.sh --------> Sequential CCSM configure/build
A      test/system/TSCscam.sh -----------> Sequential CCSM SCAM mode configure/build
A      test/system/TCTconccsm.sh --------> CCSM create-test
A      test/system/TBLtools.sh ----------> Compare tools to baseline version

----------- add singlept and regional tests
A      tools/mksurfdata/mksurfdata.singlept
A      tools/mksurfdata/mksurfdata.regional
A  +   tools/mksurfdata/mksurfdata.namelist

----------- Get improved code from Sam Levis (change names to *.F90)

A      tools/interpinic/interpinic.runoptions
A  +   tools/interpinic/fmain.F90
A      tools/interpinic/clmi_1999-01-02_10x15_c070330.nc <---- Test file
A  +   tools/interpinic/wrap_nf.F90
A      tools/interpinic/Filepath
A  +   tools/interpinic/interpinic.F90
A  +   tools/interpinic/addglobal.F90
A      tools/interpinic/Srcfiles
----------- add singlept and regional tests
A      tools/mkgriddata/mkgriddata.singlept
A      tools/mkgriddata/mkgriddata.regional

----------- Help to update ChangeLog
A      doc/UpDateChangeLog.pl

----------- New code needed for SCAM mode
A  +   src/main/setlatlonidx.F90


List all existing files that have been modified, and describe the changes:

----------- Improve test system (tweak tests, add new tests to various machines)
M      test/system/tests_pretag_bluevista
M      test/system/nl_files/t31_cnall
M      test/system/nl_files/t31_dgvm
M      test/system/nl_files/t31_casa
M      test/system/nl_files/10x15_pftdyn
M      test/system/nl_files/t31_dgvm_long
M      test/system/nl_files/t42half
M      test/system/nl_files/t31
M      test/system/CLM_runcmnd.sh ------- Use mpirun instead of mpiexec on bangkok/calgary
M      test/system/tests_pretag_blueice
M      test/system/input_tests_master
M      test/system/tests_pretag_jaguar
M      test/system/TSMtools.sh
M      test/system/tests_pretag_bangkok
M      test/system/TCBtools.sh
M      test/system/test_driver.sh
M      test/system/tests_pretag_tempest
M      test/system/tests_posttag_lightning

----------- Get tools to build
M      tools/mksurfdata/mklaiMod.F90
M      tools/mksurfdata/mkfileMod.F90
M      tools/mksurfdata/creategridMod.F90
M      tools/mksurfdata/Srcfiles
M      tools/mksurfdata/Makefile ------ Make makefile consistent and add USER_ options
M      tools/interpinic/Makefile ------ Make makefile consistent and add USER_ options
M      tools/mkgriddata/mkgriddata.F90
M      tools/mkgriddata/creategridMod.F90
M      tools/mkgriddata/Srcfiles
M      tools/mkgriddata/Makefile ------ Make makefile consistent and add USER_ options

----------- Improvements to run scripts and build system
     Change scripts so will rebuild each time (only configure first time if config file DNE), remove left over
     features from CAM Makefile.
M      bld/run-pc.csh
M      bld/configure
M      bld/run-lightning.csh
M      bld/Makefile.in
M      bld/run-ibm.csh
M      bld/run-frost.csh

----------- Source code changes, removing SPMD #ifdef, LOCAL_DEBUG, get SCAM mode working with new CAM, change
            to work with new timing library, fix code bugs above.  Remove COUP_CAM #ifdefs for SEQ_MCT || SEQ_ESMF
M      src/biogeochem/CASAMod.F90
M      src/biogeochem/CNPhenologyMod.F90
M      src/biogeochem/STATICEcosysDynMod.F90
M      src/biogeochem/DGVMMod.F90
M      src/biogeochem/CNAllocationMod.F90
M      src/biogeochem/CNVegStructUpdateMod.F90
M      src/main/spmdGathScatMod.F90
M      src/main/abortutils.F90
M      src/main/clm_comp.F90
M      src/main/driver.F90
M      src/main/ncdio.F90
M      src/main/atmdrvMod.F90
M      src/main/fileutils.F90
M      src/main/pftdynMod.F90
M      src/main/iniTimeConst.F90
M      src/main/histFileMod.F90
M      src/main/program_csm.F90
M      src/main/restFileMod.F90
M      src/main/clm_csmMod.F90
M      src/main/controlMod.F90
M      src/main/ndepFileMod.F90
M      src/main/initGridCellsMod.F90
M      src/main/lnd_comp_mct.F90
M      src/main/program_off.F90
M      src/main/pftvarcon.F90
M      src/main/spmdMod.F90
M      src/main/surfrdMod.F90
M      src/main/decompMod.F90
M      src/main/areaMod.F90
M      src/main/iobinary.F90
M      src/main/do_close_dispose.F90
M      src/riverroute/RtmMod.F90
M      src/biogeophys/Hydrology2Mod.F90
M      src/biogeophys/BiogeophysRestMod.F90

Summary of testing:

  tempest: ALL PASS
  bluevista:
019 bl141 TBL.sh 17p_vodsr_dh 10x15_pftdyn 48 .....................FAIL! rc= 7
022 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................FAIL! rc= 6
059 sm061 TSMconccsm.sh ERS f19_g13 ...............................FAIL! rc= 5
  bangkok/lf95:
033 sm982 TSCscam.sh seqccsm_64x128_s scam_prep scam_ds scam 7 ....FAIL! rc= 4

TBL test fails because of restart trouble with pftdyn.
Concurrent CCSM test fails because of a problem with ccsm3_5_beta01 for datm7.
bangkok scam test fails as is says that scm_crm_mode is not initialized in
CAM code.

CLM tag used for the baseline comparison tests if applicable: clm3_expa_96
 (had to add in new tests, and set SOM4)

Changes Answers: No

===============================================================

===============================================================
Tag name: clm3_expa_96
Originator(s): tcraig
Date: Mon Mar 12 16:41:58 MDT 2007
One-line Summary: fixed finemesh, pftdyn modes, add new tests

Purpose of changes: restore finemesh and pftdyn modes, improve
	test coverage

Bugs fixed (include bugzilla ID): 389 (partial)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: reduced memory use in pftdyn

Code reviewed by:

List any svn externals directories updated (csm_share, mct, etc.): none

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

        M      test/system/tests_pretag_bluevista
	A  +   test/system/nl_files/10x15_pftdyn
	A  +   test/system/nl_files/t31_dgvm_long
	A  +   test/system/nl_files/t42half
	M      test/system/input_tests_master
	M      test/system/tests_pretag_blueice
	M      test/system/tests_pretag_jaguar
	M      test/system/tests_pretag_bangkok
	M      test/system/test_driver.sh
	M      test/system/tests_posttag_lightning
	M      src/main/subgridMod.F90
	M      src/main/initializeMod.F90
	M      src/main/pftdynMod.F90
	M      src/main/clm_varsur.F90
	M      src/main/ndepFileMod.F90
	M      src/main/subgridAveMod.F90
	M      src/main/initGridCellsMod.F90
	M      src/main/lnd_comp_mct.F90
	M      src/main/program_off.F90
	M      src/main/surfrdMod.F90
	M      src/main/domainMod.F90
	M      src/main/decompMod.F90
	M      src/main/areaMod.F90

- rename lvegxy,lwtxy to vegxy, wtxy
- implement general setgatm, get finemesh working again
- refactor pftdynMod for low memory implementation, validate pfydyn mode
- modify ndep and pftdyn from x = x1*wt1 + x2*wt2 to x = x2 + wt1*(x1-x2)
  as suggested by k.lindsay, improves roundoff performance
- clean up some old code
- add new tests configurations (10x15_pftdyn, t31_dgvm_long, t42half), 
- update pretag lists, add new tests
		
Summary of testing: 

  bluevista:
	     all clm tests pass except bl for new cases including new tests 
	     all cam tests pass except bl (due to clm changes in expa_94/95)
	     ccsm passes ERS.f45_g35.B.bluevista16 (answers change due to expa_94/95)
  bangkok/lf95: 
	     all clm tests pass including new tests in list
	     all cam tests pass except bl (due to clm changes in expa_94/95)
  tempest:
	     all cam tests pass except bl (due to clm changes in expa_94/95)
  lightning: 
	     ccsm passes ERS.f45_g35.B2.lightning (answers change due to expa_94/95)

CLM tag used for the baseline comparison tests if applicable:
	clm3_expa_95, cam3_4_03, ccsm3_1_beta45

IF tag changes answers relative to baseline comparison the
following should be filled in:
	answers are bfb with clm3_expa_95 in clm.  cam and ccsm could not
	be tested for bfb due to lagging clm version in latest cam and ccsm tags

  Summarize any changes to answers, i.e.,
    - what code configurations: 
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
Tag name: clm3_expa_95
Originator(s): nanr, Keith Oleson, Peter Thornton
Date: Thu Mar  8 17:06:06 MST 2007
One-line Summary: Adding N limitation for CLM standalone w/o CN.

Purpose of changes: Improve estimation of photosynthesis in CLM when it
is run without CN active.  These changes impose a N limitation as a fcn of
PFT [0-1].

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: testing suites: fpftcon = pft-physiology.c070207

List any changes to the defaults for the boundary datasets: 
	fptfcon = pft-physiology.c070207
		  pft-physiology.c070207.readme

Describe any substantial timing or memory changes: none expected

Code reviewed by: Keith Oleson, Peter Thornton, Dave Lawrence

List any svn externals directories updated (csm_share, mct, etc.):  none
  
List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

bv1103en.ucar.edu-/fis/cgd/tss/nanr/clm/clm3_trunk % !svn
svn status | grep 'M '
M      test/system/nl_files/t31_cnall	! change pft-physiology.c070207
M      test/system/nl_files/t31_dgvm	! change pft-physiology.c070207
M      test/system/nl_files/t31		! change pft-physiology.c070207
M      test/system/nl_files/t31_casa	! change pft-physiology.c070207
M      bld/run-pc.csh			! change pft-physiology.c070207
M      bld/run-sgi.csh			! change pft-physiology.c070207
M      bld/run-lightning.csh		! change pft-physiology.c070207
M      bld/run-ibm.csh			! change pft-physiology.c070207
M      bld/run-frost.csh		! change pft-physiology.c070207
M      src/main/clmtypeInitMod.F90		! initialize new N limitation factor (fnitr)
M      src/main/iniTimeConst.F90		! initialize new N limitation factor (fnitr)
M      src/main/pftvarcon.F90			! read in new var (fnitr)
M      src/main/clmtype.F90			! initialize new N limitation factor (fnitr)
M      src/biogeophys/CanopyFluxesMod.F90	! apply new N limitation factor (fnitr)

Summary of testing:  

  bluevista:
	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................PASS
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................PASS
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................PASS
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................PASS
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................PASS
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable:

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:	  CN inactive
    - what platforms/compilers:	  all
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	new climate

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

  MSS location of control simulations used to validate new climate:

	/OLESON/csm/hydp2_off_communn_hk39
   
   URL for LMWG diagnostics output used to validate new climate:

http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk39aa-hydp2_off_communn_hk38aa/setsIndex.html


	
===============================================================
===============================================================
Tag name: clm3_expa_94
Originator(s): nanr, Keith Oleson, Peter Thornton
Date: 	Thu Mar  8 14:22:36 MST 2007
One-line Summary:  BTRAN modification

Purpose of changes:  Change BTRAN calculation to improve prognostic
	LAI estimation in high latitudes.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Keith Oleson, Peter Thornton, Dave Lawrence

List any svn externals directories updated (csm_share, mct, etc.): nanr

List all subroutines eliminated: nanr

List all subroutines added and what they do: nanr

List all existing files that have been modified, and describe the changes:
M      src/biogeophys/CanopyFluxesMod.F90

Changing calculation of rootr to allow non-zero rootr (and btran) in partially frozen layers.

Summary of testing:

  bluevista:

	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................PASS
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................PASS
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................PASS
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................PASS
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................PASS
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable: none

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: all
    - what platforms/compilers: all
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

	-larger than roundoff.  Climate changes unknown.
	-Improves prognostic LAI estimation in high latitudes.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository): clm3_expa_89
   - platform/compilers:  bluevista
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
	/OLESON/csm/hydp2_off_communn_hk38
   
   URL for LMWG diagnostics output used to validate new climate:

http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk38aa-hydp2_off_communn_expa89aa/setsIndex.html

	
===============================================================

===============================================================
Tag name: clm3_expa_93		! NOTE: Tag incremented to correct mistaken tag number in documentation. (nanr)
Originator(s): tcraig
Date: Tue Feb 27 16:53:41 MST 2007	
One-line Summary: merge fmf branch to trunk (low memory mods)

Purpose of changes: reduce memory and improve memory scaling

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: began adding support
  for frost in Makefile and added a run-frost.csh (not yet
  fully validated)

Describe any changes made to the namelist: added new optional namelist
  input, nsegspc (number of segments per clump for new decomp.  default
  is 20, 1 will produce poor loadbalance, infinity yields too many
  segments per pe but good load balance.  performance asymptotes for
  several configurations at about 5-10 segments/pe, use 20 as default.)

List any changes to the defaults for the boundary datasets: NONE

Describe any substantial timing or memory changes: significant reduction
  in memory use and improved memory scaling.

Code reviewed by:

List any svn externals directories updated (csm_share, mct, etc.): update
  to mct external, MCT2_3_0_070206

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

- implement new 1d decomp based on ngsegspc rather than balancing pfts,
  ngsegspc is the number of segments per clump.  the 1d gridcells will
  be divided into clumps and segments per clump so there will be
  a total number of segments, clumps*nsegspc, each of about equal number
  of gridcells, that will be distributed round-robin to pes.  pfts are
  derived later and will hopefully end up being nearly as well load
  balanced as the previous method without having to precompute pfts
  and requiring much less memory.  see above for more info on the namelist 
  input and default.
- reorganize initialization, split decomp_init into three phases,
  atm (coarse), lnd (finemesh), and glcp (subgrid).
- add new datatype, latlon to hold some global grid info
- now all domain info is local (although initialization still needs
  to be modified)
- remove some dead code
- add new timers (bug #302)
- split gatm out of domain type
- create simple setgatm_UNITY routine, finemesh capability now disabled,
  must fix setgatm in future version
- move wtxy, vegxy, and pctspec to clm_varsur, allocate as local arrays
  now (begg:endg) and modify surfrd to handle local data only both for
  I/O and initialization.
- implement gather/scatter routines in spmdGathScatMod that use gsmaps.
- update MCT and share
- port to frost
- get rid of some of the global decomps use in code, still more to do
- memory cleanup in STATICEcosysDynMod
- implement new ncdio methods for reading to local gridcell data using gsmaps
- clean up atmdrv, use newer low mem datatypes, reduce memory
- clean up rtm, use newer low mem datatypes, reduce memory
- remove history "lat/lon" fields

M      test/system/test_driver.sh
M      tools/mkgriddata/mkgriddata.F90
M      bld/configure
M      bld/Makefile.in
A  +   bld/run-frost.csh
M      src/biogeochem/CASAMod.F90
M      src/biogeochem/STATICEcosysDynMod.F90
M      src/biogeochem/DGVMMod.F90
M      src/main/spmdGathScatMod.F90
M      src/main/abortutils.F90
M      src/main/clm_comp.F90
M      src/main/driver.F90
M      src/main/ncdio.F90
M      src/main/atmdrvMod.F90
M      src/main/subgridMod.F90
M      src/main/initializeMod.F90
M      src/main/pftdynMod.F90
M      src/main/iniTimeConst.F90
M      src/main/histFileMod.F90
M      src/main/program_csm.F90
M      src/main/clm_atmlnd.F90
M      src/main/clm_varsur.F90
M      src/main/clm_csmMod.F90
M      src/main/restFileMod.F90
M      src/main/controlMod.F90
M      src/main/clm_varctl.F90
M      src/main/ndepFileMod.F90
M      src/main/initGridCellsMod.F90
M      src/main/lnd_comp_mct.F90
M      src/main/program_off.F90
M      src/main/surfrdMod.F90
M      src/main/domainMod.F90
M      src/main/decompMod.F90
M      src/main/areaMod.F90
M      src/main/clm_mct_mod.F90
M      src/SVN_EXTERNAL_DIRECTORIES
M      src/riverroute/RtmMod.F90
	
Summary of testing:

  bluevista: all pass except
    004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................FAIL! rc= 7
    009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................FAIL! rc= 7
  bangkok/lf95: all pass except
    004 bl112 TBL.sh 4p_vodsr_dm t31 48 ...............................FAIL! rc= 7
    009 bl122 TBL.sh 17p_vodsr_dm t31 48 ..............................FAIL! rc= 7
  Due to roundoff change in rtm, only rtm fields affected, otherwise bfb

  Also tested version in CCSM vs ccsm3_1_beta45
    ERS.f45_g35.B.bluevista16
    ERS.f45_g35.B2.lightning
    Both PASS and bfb versus beta45 except for rtm roundoff difference and
      associated error growth through ocean coupling

  Also tested mods merged to clm3_expa_91 with cam3_4_00, all
    CAM tests pass on bangkok, bluevista, and tempest including scam.
  Tested on bangkok with cam3_4_01 and updated to clm3_expa_92, all
    CAM tests pass on bangkok.  bluevista and tempest not tested
    due to time constraints and earlier adequate testing with 
    clm3_expa_91 and cam3_4_00.
	
CLM tag used for the baseline comparison tests if applicable: clm3_expa_89

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: anything with RTM on
    - what platforms/compilers: all 
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
        roundoff change in RTM due to roundoff change in cell area calculation

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?  tested in multiple systems, review growth of diffs in 
     stand-alone clm, only rtm fields affected, diffs remain roundoff for
     48 timesteps, no coupling to other fields or error growth in system.

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================


===============================================================
Tag name: clm3_expa_92
Originator(s): erik,mvertens,mvr
Date: Mon Feb 26 15:59:16 MST 2007
One-line Summary: When running with Sequential CCSM -- use date for albedo calculation

Purpose of changes: To work with cam3_4_01

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: erik,mvr,mvertens

List any svn externals directories updated (csm_share, mct, etc.): none

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      src/main/clm_comp.F90
M      src/main/lnd_comp_mct.F90

Have sequential CCSM give CLM the date of the next radiation calculation so that
it can calculate albedo's for that specific time-step. This is needed to work with
cam3_4_01.

Summary of testing:

  bluevista: Pass
  bangkok/lf95: Pass

CLM tag used for the baseline comparison tests if applicable: clm3_expa_91

===============================================================
===============================================================
Tag name: clm3_expa_91
Originator(s): erik
Date: Wed Feb 21 13:19:51 MST 2007
One-line Summary: Fix SCAM mode, add more machines for test_driver, have tools use csm_share, 
	make clmtype private (except for data exporting), fix several bugs

Purpose of changes: Fix SCAM mode so can make a new CAM tag.

Bugs fixed (include bugzilla ID): 252, 310, 370, 377, 385 (partial -- 302, 357, 389)

Describe any changes made to build system: Remove -DNO_R16 from Makefile

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: MSS writes are now synchronous instead of
	asynchronous

Code reviewed by: slevis

List any externals updated: Update to csm_share3_070220

List all subroutines eliminated:

Remove makdep -- as MkDepends replaces it
Remove cprlndnc -- as newcprnc replaces it

D      tools/makdep
D      tools/makdep/main.c
D      tools/makdep/Makefile
D      tools/makdep/README
D      tools/cprlndnc
D      tools/cprlndnc/cprtps.F
D      tools/cprlndnc/lenchr.F
D      tools/cprlndnc/precision.F
D      tools/cprlndnc/printstats.F
D      tools/cprlndnc/wrap_nf.F
D      tools/cprlndnc/stats.F
D      tools/cprlndnc/ismax.F
D      tools/cprlndnc/initstats.F
D      tools/cprlndnc/nldat.F
D      tools/cprlndnc/cpr.F
D      tools/cprlndnc/prhddiff.F
D      tools/cprlndnc/header.F
D      tools/cprlndnc/Makefile
D      doc/BranchLog
D      doc/ChangeSum

Delete files that tools use that are copied from main src directories (so we don't have
to maintain separate copies of code)

D      Deleting       tools/mkgriddata/fileutils.F90
D      Deleting       tools/mkgriddata/nanMod.F90
D      Deleting       tools/mkgriddata/shr_const_mod.F90
D      Deleting       tools/mkgriddata/shr_kind_mod.F90
D      Deleting       tools/mkgriddata/shr_sys_mod.F90
D      Deleting       tools/mksurfdata/fileutils.F90
D      Deleting       tools/mksurfdata/nanMod.F90
D      Deleting       tools/mksurfdata/shr_const_mod.F90
D      Deleting       tools/mksurfdata/shr_kind_mod.F90
D      Deleting       tools/mksurfdata/shr_sys_mod.F90
D      Deleting       tools/mksurfdata/shr_timer_mod.F90

List all subroutines added and what they do:

A      test/system/TSMtools.sh -- for testing of the tools (not tested yet)
A      test/system/TCBtools.sh -- for build testing of the tools (not tested yet)
A      test/system/tests_pretag_blueice -- for running on blueice (does work)
A      test/system/tests_pretag_jaguar -- for running on jaguar (doesn't work yet)
A      test/system/tests_posttag_lightning -- for running on lightning (doesn't work yet)

Files added so that tools build uses copies of files in main directories rather than separate copies

A      tools/mkgriddata/Filepath
A      tools/mkgriddata/Srcfiles
A      tools/mkgriddata/misc.h
A      tools/mkgriddata/preproc.h
A      tools/mksurfdata/Filepath
A      tools/mksurfdata/Srcfiles
A      tools/mksurfdata/misc.h
A      tools/mksurfdata/preproc.h

List all existing files that have been modified, and describe the changes:

Add check for soil energy balance:

M      src/biogeophys/BalanceCheckMod.F90

Bigint bug fix (don't copy over static fields with bigint values when copying a domain)

M      src/main/domainMod.F90

SCAM fixes (read datasets differently for SCAM)

M      src/main/surfrdMod.F90
M      src/main/ndepFileMod.F90
M      src/main/iniTimeConst.F90

Change so that tools use main copies of code rather than own particular copy:

M      tools/mkgriddata/Makefile
M      tools/mkgriddata/mkgriddata.namelist
M      tools/mksurfdata/Makefile
M      tools/mksurfdata/domainMod.F90

Make MSS write's synchronous instead of asynchronous: Required for LSF queing systems

M      src/main/fileutils.F90

Landmask bug fix: (landmask now output globally with no missing or fill values)

M      src/main/histFileMod.F90
M      src/main/initializeMod.F90
M      src/main/ncdio.F90

Timers

M      src/main/program_csm.F90
M      src/main/driver.F90

Make clmtype private -- so only exports it's data not data it uses.

M      src/biogeochem/CNGapMortalityMod.F90
M      src/biogeochem/VOCEmissionMod.F90
M      src/biogeochem/CNrestMod.F90
M      src/biogeochem/CNC13FluxMod.F90
M      src/biogeochem/CNSetValueMod.F90
M      src/main/atmdrvMod.F90
M      src/main/clmtypeInitMod.F90
M      src/main/pftdynMod.F90
M      src/main/restFileMod.F90
M      src/main/clmtype.F90
M      src/biogeophys/SnowHydrologyMod.F90
M      src/biogeophys/SurfaceAlbedoMod.F90
M      src/biogeophys/BiogeophysRestMod.F90
M      src/biogeophys/DriverInitMod.F90

Miscellaneous:

M      bld/Makefile.in  --- Remove NO_R16 CPP token, some changes to start work on jaguar
M      test/system/test_driver.sh -- add more machines
M      test/system/CLM_runcmnd.sh -- add more machines

Summary of testing:

  bluevista: 	All PASS -- except TBL tests because of csm_share shr_const_mod TKFRZ change
  bangkok/lf95: All PASS -- except TBL tests because of csm_share shr_const_mod TKFRZ change
  blueice: 	All PASS -- except TBL tests because of csm_share shr_const_mod TKFRZ change

CLM tag used for the baseline comparison tests if applicable: clm3_expa_90

  Summarize any changes to answers: larger than roundoff (all config/all machines)

  (No simulations were performed as CCSM scientists deemed the change to be
   insignificant)

===============================================================
===============================================================
Tag name:  clm3_expa_90
Originator(s):  nanr
Date:  Tue Feb  6 13:17:55 MST 2007
One-line Summary:  Changed creategridMod.F90 to read variables from 10min USGS file.

Purpose of changes:  
Added htopo and landfract to retrieve landfrac and topography for processing USGS-gtopo30_10min_c050419.nc

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by:  nanr

List all subroutines eliminated:  none

List all subroutines added and what they do:  none

List all existing files that have been modified, and describe the changes:

M      creategridMod.F90

   Added lines to creategridMod.F90 to read variables from USGS-gtopo30-10min_c050419.nc 

    ier = nf_inq_varid (ncid, 'landfract', varid)
    if (ier == NF_NOERR) then
       if (landfracset) write(6,*) trim(subname),' WARNING, overwriting frac'
       landfracset = .true.
       write(6,*) trim(subname),' read landfract'
       call check_ret(nf_inq_varid (ncid, 'landfract', varid), subname)
       call check_ret(nf_get_var_double (ncid, varid, domain%frac), subname)
    endif

    ier = nf_inq_varid (ncid, 'htopo', varid)
    if (ier == NF_NOERR) then
       if (toposet) write(6,*) trim(subname),' WARNING, overwriting topo'
       toposet = .true.
       write(6,*) trim(subname),' read htopo'
       call check_ret(nf_inq_varid (ncid, 'htopo', varid), subname)
       call check_ret(nf_get_var_double (ncid, varid, domain%topo), subname)
    endif


Summary of testing:  none. Affects tools/mkgriddata only.

  bluesky:
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable:

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate: 
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
===============================================================
Tag name: clm3_expa_89
Originator(s): erik,oleson
Date: Feb/02/2007
One-line Summary: 

Purpose of changes: Use new water table rise calculation in SoilHydrology

Bugs fixed (include bugzilla ID): 345, 353

Describe any changes made to build system: None (although added Darwin to mksrfdat build Makefile)

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Keith Oleson

List all subroutines eliminated: None

Remove bld/offline directory tree

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M      bld/Makefile.in ---- Add -DFORTRANUNDERSCORE so can compile mpi-serial on IRIX

Change run scripts so that spmd and smp settings work for both on AND off

M      bld/run-pc.csh ----------------------- Also add LD_LIBRARY_PATH setting
M      bld/run-sgi.csh
M      bld/run-lightning.csh

M      src/main/spmdMod.F90 ------------------ Remove #ifdef around #include <mpif.h> so will
	run serial (this is a partial fix to bug 337. The longer term fix is to remove all
	#ifdef SPMD as we can use the mpi-serial code to make the serial and SPMD code the same.

M      src/biogeophys/SoilHydrologyMod.F90 --- New drainage formulation from Keith Oleson

Summary of testing:

  bluesky: -- All but comparision to previous version
  tempest: -- All but comparison to previous version and the following restart tests
	(These tests fail on previous versions as well -- documented as bug 361)
002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................FAIL! rc= 11
003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
005 sm116 TSM.sh 4p_vodsr_o t31 48 ................................FAIL! rc= 4
007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................FAIL! rc= 11
008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................FAIL! rc= 11
013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................FAIL! rc= 11
017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................FAIL! rc= 11
021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	(We are going to remove tempest as a standard test for CLM)

  bangkok/lf95: -- All but comparision to previous version

CLM tag used for the baseline comparison tests if applicable: none

  Summarize any changes to answers, i.e.,
    - what code configurations: All
    - what platforms/compilers: All
    - nature of change (similar climate)

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers: Cray-XT3/jaguar
   - configuration (CPP ifdefs): default
   - build-namelist command (or complete namelist):
   - MSS location of output: /CCSM/csm/b31.020ws/lnd/hist

   URL for LMWG diagnostics output used to validate new climate: Not yet prepared
	
===============================================================
===============================================================
Tag name: clm3_expa_88
Originator(s): nanr
Date: Thu Jan 11 12:31:51 MST 2007
One-line Summary:  Minor formatting change in tools.
		   Correctons to ChangLog
		

Purpose of changes: 
1.	Update formatted write in tools/ mkgriddata.F90 and tools/mksrfdat.F90 
	to accomodate 4 digit lat/lons.
2.	Add note to ChangeLog to explain commit by nanr (10/27) that was not tagged.
3.	correct Changelog for tag clm3_expa_80.  The changes listed below never happened.
	surfFileMod.F90 was actually removed from the trunk in a previous tag (clm3_expa_66)
	and renamed surfrdMod.F90.  So this modification probably reflects the status of the branch 
	Keith Oleson was working on.
		M      src/main/surfFileMod.F90

		Removed statements contained within CN ifdef (OK'd by P. Thornton) that:

		! the following test prevents the assignment of temperate deciduous
                  		! vegetation types in the tropics
                  		! 1. broadleaf deciduous temperate tree -> broadleaf deciduous tropical tree
                  		! 2. broadleaf deciduous temperate shrub -> broadleaf deciduous tropical tree
                  		! this reassignment from shrub to tree is necessary because there is currently no
                  		! tropical deciduous broadleaf shrub type defined.


Bugs fixed (include bugzilla ID):  none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: nanr

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      tools/mksurfdata/mksrfdat.F90
M      tools/mkgriddata/mkgriddata.F90
	
   Changed formatting strings to accomodate 4 char lat/lons.
	OLD:  write (resol,'(i3.3,"x",i3.3)') lsmlat,lsmlon
	NEW:  write (resol,'(i4.4,"x",i4.4)') lsmlat,lsmlon

Summary of testing:  none.  Changes only to tools and ChangeLog

  bluesky:
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable: none

IF tag changes answers relative to baseline comparison the
following should be filled in: none

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate: NA
   
   URL for LMWG diagnostics output used to validate new climate: NA
	
===============================================================
===============================================================
Tag name: clm3_expa_87
Originator(s): tcraig, jet
Date: Wed Dec 27 05:03:01 GMT 2006
One-line Summary: merge fme branch, merge refactor_scam branch

Purpose of changes: bug fixes, reduce memory usage, improve memory scaling,
	add mct package, update scam

Bugs fixed (include bugzilla ID): 
	#133 adomain,ldomain compare
	#290 time bounds problem in history file
	#291 fix rtm history bug on bangkok
	#301 modify decomp info in i/o
	#321 merge refactor_scam branch

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: memory reduce, amount TBD

Code reviewed by: tcraig

List all subroutines eliminated: many routines in areaMod removed
	rename seq_mct_mod.F90 to clm_mct_mod.F90
	add getnetcdfdata.F90

List all subroutines added and what they do: added MCT package and interpolation
	routines that use MCT mapping datatypes

List all existing files that have been modified, and describe the changes:

         test/system/TBL.sh
	 test/system/TBR.sh
	 test/system/test_driver.sh
	 test/system/TER.sh
	 bld/offline/mkSrcfiles
	 bld/offline/tests/CLM_namelist.pm
	 bld/offline/tests/compare.csh
	 bld/offline/tests/config_machine_specs.csh
	 bld/offline/tests/CLM_lab.pm
	 bld/offline/tests/CLM_test.pm
	 bld/offline/tests/CLM.pm
	 bld/offline/tests/test-model.pl
	 bld/offline/tests/model_specs.csh
	 bld/offline/tests/CLM_run.pm
	 bld/offline/tests/test_batch.csh
	 bld/offline/tests/Makefile
	 bld/offline/tests/configure.csh
         bld/offline/tests/lab_default.pm
	 bld/offline/mkDepends
	 bld/offline/jobscript.csh
	 bld/offline/Makefile
         src/biogeochem/STATICEcosysDynMod.F90
         src/SVN_EXTERNAL_DIRECTORIES
	 src/main/inicFileMod.F90
	 src/main/driver.F90
	 src/main/ncdio.F90
	 src/main/atmdrvMod.F90
	 src/main/initializeMod.F90
	 src/main/iniTimeConst.F90
	 src/main/histFileMod.F90
	 src/main/clm_atmlnd.F90
	 src/main/clm_csmMod.F90
	 src/main/restFileMod.F90
	 src/main/controlMod.F90
	 src/main/clm_varctl.F90
	 src/main/getnetcdfdata.F90
	 src/main/lnd_comp_mct.F90
	 src/main/program_off.F90
	 src/main/spmdMod.F90
	 src/main/surfrdMod.F90
	 src/main/domainMod.F90
	 src/main/decompMod.F90
	 src/main/areaMod.F90
	 src/main/iobinary.F90
	 src/main/clmtype.F90
	 src/main/clm_mct_mod.F90
	 src/riverroute/RtmMod.F90
	 src/riverroute/RunoffMod.F90

  fix minor bug in TBL, TBR, TER reporting non bfb errors
  include mods from john truesdale for refactor_scam branch
  add MCT package to utils and SVN_EXTERNALS
  add mpicom to smpdMod.F90 default for mct
  add map_setmapAR to areaMod.F90
  refactor clm mapping datatypes and subroutines in general
  remove 9 of 15 global arrays from decomp type
  add MCT datatypes and mapping to atmdrv and rtm
	
Summary of testing:
  fme05_clm3_expa_78 vs clm3_expa_78, cam3_3_40, ccsm3_1_beta40
  (mods on top of clm3_expa_78)
    bluesky:   all clm pass except BL fail due to changes in atmdrv mapping
	       all cam pass
    tempest:   all cam pass
    bangkok:   all clm pass except BL fail due to changes in atmdrv mapping
    lightning: ccsm ERS.f45_g35.B2 bfb with ccsm3_1_beta40
    bluevista: ccsm ERS.f45_g35.B2 bfb with ccsm3_1_beta40
	       cam finemesh test is bfb

  fme06_clm3_expa_79 vs clm3_expa_79, cam3_3_44, ccsm3_1_beta40
  (merge in scam_refactor02_clm3_expa_79)
    bluesky:   all clm pass except BL fail due to changes in atmdrv mapping
	       clm *211 test fail (due to failures in clm3_expa_79)
	       all cam pass
    tempest:   all cam pass
    bangkok:   all cam pass
    lightning: ccsm ERS.f45_g35.B2 bfb with ccsm3_1_beta40
    bluevista: ccsm ERS.f45_g35.B2 bfb with ccsm3_1_beta40
	       cam finemesh test is bfb

  clm3_expa_87 == fme07_clm3_expa_86 vs clm3_expa_86, ccsm3_1_hydro01
  (merge in clm3_expa_86, cam testing not possible)
    bluesky:   all clm pass except BL fail due to changes in atmdrv mapping
    bangkok:   all clm pass except BL fail due to changes in atmdrv mapping
    bluevista: ccsm ERS.f19_g14.B2 bfb with ccsm3_1_beta40

CLM tag used for the baseline comparison tests if applicable: clm3_expa_86

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: all
    - what platforms/compilers: all
    - nature of change (roundoff; larger than roundoff/same climate; new climate): roundoff

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?
	roundoff differences introduced in rtm and atmdrv due to change in
	  interpolation order of operations.  verified this carefully during
	  development with print statements.
	also, with BL tests, history fields are typically different in only the 15th digit 
	  after several timesteps
	verified bfb in ccsm vs ccsm3_1_hydro01 tag (includes clm3_expa_86)
	all cam tests pass with fme mods bfb including BL

===============================================================
===============================================================
Tag name: clm3_expa_86
Originator(s): nanr
Date: Thu Dec  7 10:22:11 MST 2006
One-line Summary:  Correct FMAX calculation.

Purpose of changes:  Correction for iniTimeConst.F90, which incorrectly divides fmax by 100.
	fmax is already stored as unitless [0-1].

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by:  myself, Keith Oleson

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      iniTimeConst.F9
   OLD:  wtfact(c) = gti(i,j)/100.
   NEW:  wtfact(c) = gti(i,j)

Summary of testing:

  bluesky:
	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

   Note, the branch tests failed only in the differences to the time_bounds variable
   upon branching - all other variables stayed the same. This has been reported as
   bug #290.

  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable:

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:	All
    - what platforms/compilers:	All
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	small changes in climate which are now more realistic.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:  
   
   URL for LMWG diagnostics output used to validate new climate:  
	
===============================================================
===============================================================
Tag name:  clm3_expa_85
Originator(s): nanr
Date: Fri Dec  1 11:46:26 MST 2006
One-line Summary: change in topsoil evaporation.

Purpose of changes:  Change in topsoil evaporation sums the contributions of qflx_evap_soi over
all pft, regardless of sign of the pft

Bugs fixed (include bugzilla ID): 264

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Peter Thornton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

        M      src/biogeophys/Biogeophysics2Mod.F90

1. (around line 297) Changed calculation of topsoil_evap_tot(c) to sum the contributions of qflx_evap_soi(p) over all PFTs, regardle
ss of the sign of the PFT-level flux term.  Previously, this summation was only done over the positive PFT-level evaporation fluxes
(excluded condensation terms).

2. Change (1) eliminates the need for rescaling the topsoil_evap_tot(c) using sumwt(c), so this code was removed (around line 308).
 Calculation of egirat(c) looks the same, but is now based on the modified topsoil_evap_tot(c), which includes both evaporation and
condensation terms.

3. Removed control on positive qflx_evap_soi(p) in block where PFT-level fluxes are being modified to avoid evaporation in excess of
 top-layer water.  Now both evaporation and condensation terms are scaled by egirat(c).

4. Removed calculation of evaprat(p)(around line 323).  Changed calculation of split between soil evaporation and ice sublimation to
 eliminate use of evaprat(p), instead using the ratio of liquid/(liquid+ice) in top layer to partition total evaporation loss into w
ater evaporation and ice sublimation (around line 354).

Summary of testing:

  bluesky:
	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable:  None

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:	All
    - what platforms/compilers:	All
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	new physics.  Same climate; larger than roundoff differences.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
===============================================================
Tag name: clm3_expa_84
Originator(s):  nanr
Date: Fri Dec  1 10:32:28 MST 2006
One-line Summary: Modify stomatal open/close values for ENF/DNF/EBF

Purpose of changes: Make stomatal open/close values consistent with White et al. (2000)
	update run script namelists to point to new physiology files.

Bugs fixed (include bugzilla ID): 
	Bug #265
	mksurfdata was missing the mkfmax.F90 file from clm3_expa_76, so I added mkfmax.F90
	Bug #300 - Uncorporated most of Keith Oleson's recommended changes to the run scripts

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: 

	A new pft physiology file is required: pft-physiology.c061129

Describe any substantial timing or memory changes: None

Code reviewed by: Keith Oleson

List all subroutines eliminated: None

List all subroutines added and what they do: 
	tools/mksurfdata/mkfmax.F90 	(documented in clm3_expa_76 but not added)
	/bld/empty			empty directory was added as template for run scripts (Bug 300)

List all existing files that have been modified, and describe the changes: None

M      test/system/nl_files/t31_cnall		! namelist change for new pft file
M      test/system/nl_files/t31_dgvm		! namelist change for new pft file
M      test/system/nl_files/t31			! namelist change for new pft file
M      test/system/nl_files/t31_casa		! namelist change for new pft file
A      tools/mksurfdata/mkfmax.F90		! adding fmax tool
M      bld/run-pc.csh				! namelist change for new pft file
M      bld/run-sgi.csh				! namelist change for new pft file
M      bld/run-lightning.csh			! namelist change for new pft file
M      bld/run-ibm.csh				! namelist change for new pft file
A      bld/empty				! empty directory for run script 

Summary of testing:  bluesky

	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

   Note, the branch tests failed only in the differences to the time_bounds variable
   upon branching - all other variables stayed the same. This has been reported as
   bug #290.

CLM tag used for the baseline comparison tests if applicable: None

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: all
    - what platforms/compilers: all
    - nature of change (roundoff; larger than roundoff/same climate; new climate): small changes in climate 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository): clm3_expa_60 was the baseline tag, 
      the testing source was:
      /home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_communn_hk30
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/main
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeophys
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeochem
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/riverroute
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/csm_share/shr
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/timing
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/esmf_wrf_timemgr
   - platform/compilers: bluesky
   - configuration (CPP ifdefs): 
      #define SPMD
      #define OFFLINE
      #define LSMLON       128
      #define LSMLAT       64
      #define MAXPATCH_PFT 4
      #define RTM
      #undef  DUST
      #undef  VOC
      #undef  DGVM
      #undef  CN
      #undef  SUPLN
   - build-namelist command (or complete namelist):

 &clmexp
 caseid         = 'hydp2_off_communn_hk30'
 ctitle         = 'offline run with clm3_expa_60, same as hydp2_off_communn_hk26 but with new smpso and smpsc values for DNF,ENF,EBF'
 finidat        = ' '
 fsurdat        = '/fis/cgd/tss/oleson/plawren_datasets3/surfdata_064x128_hydro_060426.nc'
 fatmlndfrc     = '$CSMDATA/griddata/fracdata_64x128_gx1v3_060401.nc'
 fpftcon        = '/home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_communn_hk30/pft-physiology.c061129'
 frivinp_rtm    = '$CSMDATA/rtmdata/rdirc.05'
 offline_atmdir = '/cgd/tss/oleson/ncepdata.tqian'
 nsrest         =  0
 nelapse        =  -6570
 dtime          =  1200
 start_ymd      =  19480101
 start_tod      =  0
 irad           = -1
 wrtdia         = .true.
 mss_irt        =  1095
 hist_dov2xy    = .true.
 hist_nhtfrq    =  0
 hist_mfilt     =  1
 hist_crtinic   = 'YEARLY'
 /

   - MSS location of output:
        mss:/OLESON/csm/hydp2_off_communn_hk30

   URL for LMWG diagnostics output used to validate new climate:

	http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk30aa-hydp2_off_communn_hk26aa/setsIndex.html

===============================================================
Tag name: clm3_expa_83
Originator(s): nanr
Date:  Tue Nov 28 13:45:11 MST 2006
One-line Summary:  Fix snow age bug.

Purpose of changes: Snow age (which affects snow albedo) is currently reset to zero 
at each time step if there are less than five snow layers.  Snow age should only be 
reset to zero if there are no snow layers.  This fix lowers surface albedo, 
resulting in faster snow ablation in some regions.  

Bugs fixed (include bugzilla ID):  281

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by:  Keith Oleson

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

  M Hydrology2Mod.F90

  Set snowage to zero only if there are no snow layers.

Summary of testing:

  bluesky:
	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

  NOTE:  the branch tests failed only in the differences to the time_bounds variable
         upon branching - all other variables stayed the same. This has been reported as
         bug #290.

  tempest:  Needs to be tested.
  bangkok/lf95:  Needs to be tested.

CLM tag used for the baseline comparison tests if applicable: None

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:  All
    - what platforms/compilers:  All
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	small change in climate in regions with snow.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
      the testing source was:
      /home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_communn_hk19
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/main
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeophys
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeochem
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/riverroute
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/csm_share/shr
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/timing
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/esmf_wrf_timemgr
   - platform/compilers: bluesky
   - configuration (CPP ifdefs):
      #define SPMD
      #define OFFLINE
      #define LSMLON       128
      #define LSMLAT       64
      #define MAXPATCH_PFT 4
      #define RTM
      #undef  DUST
      #undef  VOC
      #undef  DGVM
      #undef  CN
      #undef  SUPLN
   - build-namelist command (or complete namelist):
 	&clmexp
 	caseid         = 'hydp2_off_communn_hk19'
 	ctitle         = 'offline run with clm3_expa_60, same as hydp2_off_con but with version 3 of P. Lawrence sfc dataset and new community hydrology with soil ice and recharge fix,hkdepth=2.5,gridcell fmax,WT fix,ws fix,Sellers rsoil,rsoil dew fix,snowage fix'
 	finidat        = ' '
 	fsurdat        = '/fis/cgd/tss/oleson/plawren_datasets3/surfdata_064x128_hydro_060426.nc'
 	fatmlndfrc     = '$CSMDATA/griddata/fracdata_64x128_gx1v3_060401.nc'
 	fpftcon        = '/home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_commun/pft-physiology.c060426'
 	frivinp_rtm    = '$CSMDATA/rtmdata/rdirc.05'
 	offline_atmdir = '/ptmp/oleson/qian_atm2'
 	nsrest         =  1
 	nelapse        =  -7300
 	dtime          =  1200
 	start_ymd      =  19790101
 	start_tod      =  0
 	irad           = -1
 	wrtdia         = .true.
 	mss_irt        =  1095
 	hist_dov2xy    = .true.
 	hist_nhtfrq    =  0
 	hist_mfilt     =  1
 	hist_crtinic   = 'YEARLY'

    MSS location of control simulations used to validate new climate:

       mss:/OLESON/csm/hydp2_off_communn_hk19

    URL for LMWG diagnostics output used to validate new climate:

 	http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk19a-hydp2_off_communn_hk15a/setsIndex.html
===============================================================
Tag name: clm3_expa_82
Originator(s): nanr	
Date: Mon Nov 27 21:51:23 MST 2006
One-line Summary:  Fix water balance error

Purpose of changes: Fix water balance error in calculation of btran.  In certain situations not enough
water was being drawn out of the soil according to the calculated transpiration.  

Bugs fixed (include bugzilla ID): 263

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none.

Code reviewed by: Keith Oleson, Dave Lawrence

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M	CanopyFluxesMod.F90 

   OLD: real(r8), parameter :: btran0 = 1.0e-10_r8  ! initial value
   NEW: real(r8), parameter :: btran0 = 0.0_r8  ! initial value

   do j = 1,nlevsoi
      do f = 1, fn
         p = filterp(f)
         if (btran(p) .gt. btran0) then
           rootr(p,j) = rootr(p,j)/btran(p)
         else				! NEW
           rootr(p,j) = 0._r8		! NEW
         end if				
      end do
   end do

Summary of testing: test_driver.sh

  bluesky:
	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

  NOTE:  the branch tests failed only in the differences to the time_bounds variable
         upon branching - all other variables stayed the same. This has been reported as
         bug #290.

  tempest:  Needs to be tested.
  bangkok/lf95:  Needs to be tested.

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:	All
    - what platforms/compilers: All
    - nature of change (roundoff; larger than roundoff/same climate; new climate): roundoff

	Keith Oleson ran a 20-year global offline simulation and didn't get a single water balance error warning. 
	The annual mean min and max ERRH2O for the new simulation is -3.75e-13 and
	6.7e-14.  Previously it was -4.15e-15 and 1.28e-7.

   MSS location of control simulations used to validate new climate:

	/OLESON/csm/hydp2_off_communn_hk20

   URL for LMWG diagnostics output used to validate new climate:

	http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk20a-hydp2_off_communn_hk16d/setsIndex.html
	The hk20 simulation is the one with the fix.

	
===============================================================
===============================================================
Tag name: clm3_expa_81
Originator(s): nanr	
Date: Mon Nov 27 19:56:25 MST 2006
One-line Summary:  Changes to water table calculations for frozen soil 

Purpose of changes: Improve water table calculations for frozen soil.  
Correct typo in Pat Worley's timing code.  Correct run-ibm.csh script.

Bugs fixed (include bugzilla ID): 304, 303 

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by:  Keith Oleson, David Lawrence

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M      bld/run-ibm.csh

	OLD:  set clmroot   = /fis/cgd/tss/nanr/clm/hydro/clm_trunk.061107
	NEW:  set clmroot   = /fis/cgd/.......

	OLD:  fpftcon        = '$CSMDATA/pftdata/pft-physiology-cn16.c040719'
	NEW:  fpftcon        = '$CSMDATA/pftdata/pft-physiology.c060426'

M      src/main/lnd_comp_mct.F90

	OLD:  call t_stopf ('sync_clm_run11') 
	NEW:  call t_stopf ('sync_clm_run1')

M      src/biogeophys/Hydrology2Mod.F90

Modify subroutine calls to SurfaceRunoff and Drainage to pass icefrac in/out

M      src/biogeophys/SoilHydrologyMod.F90

Modify subroutine arguments for SurfaceRunoff and Drainage to pass icefrac in/out.
Make surface runoff a function of ice content in soil layers. 
Make soil matric potential a function of liquid water content and effective porosity only.
Remove qcharge limit in "permafrost areas".

Summary of testing:

  bluesky: test_driver.sh

	tests of CCSM will use source code from:
	/fs/cgd/csm/collections/ccsm3_1_beta40
	see /fis/cgd/tss/nanr/clm/hydro/clm3_expa_80_nr/test/system/td.187162.log for more detailed output

	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

  NOTE:  the branch tests failed only in the differences to the time_bounds variable
         upon branching - all other variables stayed the same. This has been reported as
         bug #290.

  tempest: Needs to be tested
  bangkok/lf95:  Needs to be tested

  Summarize any changes to answers, i.e.,
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

	small changes in climate in some frozen soil regions, but mainly affects runoff.

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):  clm3_expa_60 was the baseline tag
   - testing source:
      /home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_communn_hk26
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/main
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeophys
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeochem
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/riverroute
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/csm_share/shr
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/timing
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/esmf_wrf_timemgr
   - platform/compilers: bluesky
   - configuration (CPP ifdefs): 
      #define SPMD
      #define OFFLINE
      #define LSMLON       128
      #define LSMLAT       64
      #define MAXPATCH_PFT 4
      #define RTM
      #undef  DUST
      #undef  VOC
      #undef  DGVM
      #undef  CN
      #undef  SUPLN
   - build-namelist command (or complete namelist):

 &clmexp
 caseid         = 'hydp2_off_communn_hk26'
 ctitle         = 'offline run with clm3_expa_60, same as hydp2_off_con but with version 3 of P. Lawrence sfc dataset,new comm
unity hydrology,soil ice and recharge fix,hkdepth=2.5,gridcell fmax,WT fix,ws fix,Sellers rsoil,rsoil dew fix,s_node fix,my fr
ozen soil fixes,starts 1948'
 finidat        = ' '
 fsurdat        = '/fis/cgd/tss/oleson/plawren_datasets3/surfdata_064x128_hydro_060426.nc'
 fatmlndfrc     = '/fs/cgd/csm/inputdata/lnd/clm2/griddata/fracdata_64x128_gx1v3_060401.nc'
 fpftcon        = '/home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_communn_hk23/pft-physiology.c060426'
 frivinp_rtm    = '/fs/cgd/csm/inputdata/lnd/clm2/rtmdata/rdirc.05'
 offline_atmdir = '/cgd/tss/oleson/ncepdata.tqian'
 nsrest         =  1
 nelapse        =  -6570
 dtime          =  1200
 start_ymd      =  19480101
 start_tod      =  0
 irad           = -1
 wrtdia         = .true.
 mss_irt        =  1095
 hist_dov2xy    = .true.
 hist_nhtfrq    =  0
 hist_mfilt     =  1
 hist_crtinic   = 'YEARLY'
 /

   MSS location of control simulations used to validate new climate:

   	mss:/OLESON/csm/hydp2_off_communn_hk26
  
   URL for LMWG diagnostics output used to validate new climate:

	http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk26d-obs/setsIndex.html
	
===============================================================
===============================================================
Tag name: clm3_expa_80
Originator(s): nanr
Date:  Thu Nov 16 13:38:09 MST 2006
One-line Summary:  Merge Keith Oleson's Hydrology changes to the clm trunk.

Purpose of changes:  New hydrology for CLM

Bugs fixed (include bugzilla ID): Bug #249

Describe any changes made to build system:  None

Describe any changes made to the namelist:

  This tag requires a new variable 'fmax' found in new surface datasets.  
  Code is not backward compatible.

  fsurdat, fatmgrid, and fatmlndfrc are t31 only.  We need to produce
  new datasets at other resolutions.

  OLD Namelist:
   fsurdat        = '$CSMDATA/surfdata/surfdata_48x96_060404.nc'
   fatmgrid       = '$CSMDATA/griddata/griddata_48x96_060404.nc'
   fatmlndfrc     = '$CSMDATA/griddata/fracdata_48x96_gx1v3_060404.nc'
   fpftcon        = '$CSMDATA/pftdata/pft-physiology-cn16.c040719'
   frivinp_rtm    = '$CSMDATA/rtmdata/rdirc.05'

  NEW Namelist:
   fsurdat        = "$CSMDATA/surfdata/surfdata_048x096_061108.nc"
   fatmgrid       = "$CSMDATA/griddata/griddata_48x96_060829.nc"
   fatmlndfrc     = "$CSMDATA/griddata/fracdata_48x96_gx3v5_060829.nc"
   fpftcon        = "$CSMDATA/pftdata/pft-physiology.c060426"
   frivinp_rtm    = "$CSMDATA/rtmdata/rdirc.05.061026"

List any changes to the defaults for the boundary datasets:

  This tag requires a new variable 'fmax' found in new surface datasets.  
  Code is not backward compatible.

  OLD:
     Vegetation_type_raw_data_filename = "mksrf_pft.050425.nc" ;
     Soil_color_raw_data_file_name = "mksrf_soilcol.050425.nc" ;
     Inland_water_raw_data_file_name = "mksrf_lanwat.050425.nc" ;
     Glacier_raw_data_file_name = "mksrf_glacier.050425.nc" ;
     Urban_raw_data_file_name = "mksrf_urban.050425.nc" ;
     Lai_raw_data_file_name = "mksrf_lai.050425.nc" ;
  NEW:
     Vegetation_type_raw_data_filename = "mksrf_pft.060929.nc" ;
     Soil_color_raw_data_file_name = "mksrf_soilcol.060929.nc" ;
     Inland_water_raw_data_file_name = "mksrf_lanwat.060929.nc" ;
     Glacier_raw_data_file_name = "mksrf_glacier.060929.nc" ;
     Fmax_raw_data_file_name = "mksrf_fmax.061020.nc" ;
     Urban_raw_data_file_name = "mksrf_urban.060929.nc" ;
     Lai_raw_data_file_name = "mksrf_lai.060929.nc" ;

Describe any substantial timing or memory changes: Unknown; Needs to be tested.

Code reviewed by: myself (testing suite), David Lawrence, Keith Oleson

List all subroutines eliminated: None

List all subroutines added and what they do:

A      test/system/nl_files/t31_casa	! Addition to testing suite

List all existing files that have been modified, and describe the changes:

test suite mods:
M      test/system/input_tests_master
M      test/system/test_driver.sh
M      bld/run-ibm.csh
M      test/system/nl_files/t31_cnall
        1. pointing to new pft file, 
	2. starting at first day of the year.
Inputdataset Changes:
M      tools/mksurfdata/mksrfdat.namelist
	test suite mods
Hydrology mods: 

M      src/main/clm_varcon.F90

Removed CN ifdef for csoilc.

M      src/main/clmtypeInitMod.F90

Added allocation and initialization for two new pft-physiology variables and
several hydrology variables.
Removed smpmax.

M      src/main/iniTimeConst.F90

Read in new fmax surface dataset.
Initialize hkdepth (decay factor).

M      src/main/histFileMod.F90

Changed string from CLM2 to CLM3.

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Start Revision:  
   ChangLog modified by nanr (1/11/07):  
   surfFileMod.F90 was removed from the trunk in clm3_expa_66 and renamed surfrdMod.F90.
   Therefore, these changes did not actually happen in the code base.

	M      src/main/surfFileMod.F90

	Removed statements contained within CN ifdef (OK'd by P. Thornton) that:

	! the following test prevents the assignment of temperate deciduous
                 ! vegetation types in the tropics
                 ! 1. broadleaf deciduous temperate tree -> broadleaf deciduous tropical tree
                 ! 2. broadleaf deciduous temperate shrub -> broadleaf deciduous tropical tree
                 ! this reassignment from shrub to tree is necessary because there is currently no
                 ! tropical deciduous broadleaf shrub type defined.

End Revision:   
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

M      src/main/pftvarcon.F90

Added statements to take care of two new pft-physiology variables.

M      src/main/clmtype.F90

Added pointers for new pft-physiology variables and hydrology variables.

M      src/main/histFldsMod.F90

Added the following new hydrology fields:

      call add_fld1d (fname='FCOV',  units='unitless',  &
           avgflag='A', long_name='fractional area with water table at surface', &
           ptr_col=clm3%g%l%c%cws%fcov)
      call add_fld1d (fname='ZWT',  units='m',  &
           avgflag='A', long_name='water table depth', &
           ptr_col=clm3%g%l%c%cws%zwt)
      call add_fld1d (fname='WA',  units='mm',  &
           avgflag='A', long_name='water in the unconfined aquifer', &
           ptr_col=clm3%g%l%c%cws%wa)
      call add_fld1d (fname='WT',  units='mm',  &
           avgflag='A', long_name='total water storage (unsaturated soil water + groundwater)', &
           ptr_col=clm3%g%l%c%cws%wt)
      call add_fld1d (fname='QCHARGE',  units='mm/s',  &
           avgflag='A', long_name='aquifer recharge rate', &
           ptr_col=clm3%g%l%c%cws%qcharge)

M      src/main/mkarbinitMod.F90

Added arbitrary initialization for water table variables and changed soil water 
initialization from 0.3 to 0.4

M      src/biogeophys/BalanceCheckMod.F90

Added aquifer water to water balance check

M      src/biogeophys/SoilTemperatureMod.F90

Subroutine PhaseChange was changed to accomodate the presence of supercooled liquid water
in the soil at temperatures less than freezing. Also incorporates the concepth of 
fractional permeable area (Niu and Yang, 2006, J. Hydrometeorol., 7, 937-952).

M      src/biogeophys/Biogeophysics1Mod.F90

Added statements to set soilalpha as an output variable.

M      src/biogeophys/Biogeophysics2Mod.F90

Added index for landunit.

M      src/biogeophys/Hydrology2Mod.F90

Added aquifer water to ending water balance.
Added pointers to hydrology variables.
Added arguments to subroutines SurfaceRunoff and Drainage.

M      src/biogeophys/BiogeophysRestMod.F90

Added wa, wt, zwt to restart/initial file

M      src/biogeophys/SoilHydrologyMod.F90

Changes to subroutines SurfaceRunoff, SoilWater, and Drainage.  
New parameterizations are based on 
Niu et al., 2006, J. Geophys. Res., in press (Groundwater)
Niu et al., 2005, J. Geophys. Res., 110, doi:10.1029/2005JD006111 (Runoff)
Niu and Yang, 2006, J. Hydrometeorol., 7, 937-952 (Frozen soil)

M      src/biogeophys/HydrologyLakeMod.F90

Set hydrology variables to special value for lakes.

M      src/biogeophys/BareGroundFluxesMod.F90

Added soil resistance function for soil evaporation.

M      src/biogeophys/CanopyFluxesMod.F90

New parameterization for soil moisture limitation function (P. Thornton).
Removed CN ifdef for csoilc.

Summary of testing:

  bluesky:

	001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
	002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
	003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
	004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
	005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
	006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
	007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
	008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
	009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
	010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
	011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
	012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
	013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
	014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
	015 sm311 TSM.sh 4p_casa_dh t31_casa 48 ...........................PASS
	016 er311 TER.sh 4p_casa_dh t31_casa 10+38 ........................PASS
	017 br311 TBR.sh 4p_casa_dh t31_casa 24+24 ........................FAIL! rc= 11
	018 bl311 TBL.sh 4p_casa_dh t31_casa 48 ...........................SKIPPED*
	019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
	020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
	021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
	022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*

  NOTE:  the branch tests failed only in the differences to the time_bounds variable
         upon branching - all other variables stayed the same. This has been reported as
         bug #290.
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable:  None

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:  all
    - what platforms/compilers:  all
    - nature of change (roundoff; larger than roundoff/same climate; new climate):  new climate

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
      clm3_expa_60 was the baseline tag
      the testing source was:
      /home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_communn_hk15
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/main
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeophys
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/biogeochem
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/riverroute
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/csm_share/shr
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/timing
      /home/bluesky/oleson/hydro01_clm3_expa_60/src/utils/esmf_wrf_timemgr
   - platform/compilers:  bluesky
   - configuration (CPP ifdefs):
      #define SPMD
      #define OFFLINE
      #define LSMLON       128
      #define LSMLAT       64
      #define MAXPATCH_PFT 4
      #define RTM
      #undef  DUST
      #undef  VOC
      #undef  DGVM
      #undef  CN
      #undef  SUPLN
   - build-namelist command (or complete namelist):
         &clmexp
         caseid         = 'hydp2_off_communn_hk16'
         ctitle         = 'offline run with clm3_expa_60, same as hydp2_off_con but with version 3 of P. Lawrence sfc dataset and new community hydrology with soil ice and recharge fix and hkdepth=2.5 and gridcell fmax and WT fix and ws fix and Sellers rsoil and r
soil dew fix and starts 1948'
         finidat        = ' '
         fsurdat        = '/fis/cgd/tss/oleson/plawren_datasets3/surfdata_064x128_hydro_060426.nc'
         fatmlndfrc     = '/fs/cgd/csm/inputdata/lnd/clm2/griddata/fracdata_64x128_gx1v3_060401.nc'
         fpftcon        = '/home/bluesky/oleson/hydro01_clm3_expa_60/bld/offline/mods_hydp2_off_commun/pft-physiology.c060426'
         frivinp_rtm    = '/fs/cgd/csm/inputdata/lnd/clm2/rtmdata/rdirc.05'
         offline_atmdir = '/cgd/tss/oleson/ncepdata.tqian'
         nsrest         =  0
         nelapse        =  -6570
         dtime          =  1200
         start_ymd      =  19480101
         start_tod      =  0
         irad           = -1
         wrtdia         = .true.
         mss_irt        =  1095
         hist_dov2xy    = .true.
         hist_nhtfrq    =  0
         hist_mfilt     =  1
         hist_crtinic   = 'YEARLY'
         /

   - MSS location of output:
        mss:/OLESON/csm/hydp2_off_communn_hk16

   URL for LMWG diagnostics output used to validate new climate:

http://www.cgd.ucar.edu/tss/clm/diagnostics/lmwg_hydro/hydp2_off_communn_hk16c-obs/setsIndex.html
	
===============================================================
===============================================================
Tag name: clm3_expa_79
Originator(s): nanr
Date: Wed Nov 15 14:29:37 MST 2006
One-line Summary: Add Pat Whorley's timing changes.

Purpose of changes: 
Pat Whorley's improvements to the timing calls to give a better picture of 
CLM timing.  Pat added comments and a few modifications to the t_startf/t_stopf calls.  

Bugs fixed (include bugzilla ID):  None

Describe any changes made to build system:  None

Describe any changes made to the namelist:  updated pft namelist to point to new pft-physiology file:
$CSMDATA/pftdata/pft-physiology.c060426.   


List any changes to the defaults for the boundary datasets:  None

Describe any substantial timing or memory changes:  None

Code reviewed by: myself

List all subroutines eliminated:  None

List all subroutines added and what they do:  None

List all existing files that have been modified, and describe the changes:

M      test/system/nl_files/t31_cnall
M      test/system/test_driver.sh
M      src/main/clm_comp.F90
M      src/main/driver.F90
M      src/main/lnd_comp_mct.F90
M      src/main/decompMod.F90
M      src/main/areaMod.F90

Summary of testing:

  bluesky:
   001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
   002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
   003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
   004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................PASS
   005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
   006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
   007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
   008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
   009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................PASS
   010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
   011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................FAIL! rc= 11
   012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................FAIL! rc= 11
   013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
   014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................FAIL! rc= 11
   015 sm311 TSM.sh 4p_casa_dh t31_dgvm 48 ...........................PASS
   016 er311 TER.sh 4p_casa_dh t31_dgvm 10+38 ........................PASS
   017 br311 TBR.sh 4p_casa_dh t31_dgvm 24+24 ........................FAIL! rc= 11
   018 bl311 TBL.sh 4p_casa_dh t31_dgvm 48 ...........................PASS
   019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
   020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
   021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
   022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
   
   TESTING NOTE 1:  the branch tests failed only in the differences to the time_bounds variable
   		    upon branching - all other variables stayed the same. This has been reported as
   		    bug #290.
   TESTING NOTE 2:  The new pft file (added for hydro changes (clm3_expa_80) caused the t31_cnall tests to fail.

  tempest:      (tests must still be done)
  bangkok/lf95: (tests must still be done)

CLM tag used for the baseline comparison tests if applicable: clm3_expa_78

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers:  NONE
	
===============================================================
===============================================================
Tag name: clm3_expa_78
Originator(s): mvertens
Date: Mon Nov 13 20:22:05 MST 2006
One-line Summary: introduced new offline build/run scripts and testing suite

Purpose of changes: New build/run scripts were introduced in order to make it easier 
to run the offline clm on platforms other than the NCAR IBMs. In addition a new testing
suite was introduced that will make it much easier to add new tests and trace the status
of current tests. The new test suite can also be run on a much wider set of platforms
than the NCAR IBMs. Both the new build/run scripts and the new offline test suite were
based on the current CAM build/run scripts and CAM test suite.

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: New build system based on a new "configure" utility

Describe any changes made to the namelist: The namelist generation is the same. For the
the new build/run scripts, sample namelists can be found in the scripts bld/run-*.csh.

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: myself

List all subroutines eliminated:
   D   bld/offline
   D   bld/offline/tests
   D   bld/offline/tests/CLM_namelist.pm
   D   bld/offline/tests/compare.csh
   D   bld/offline/tests/config_machine_specs.csh
   D   bld/offline/tests/CLM_lab.pm
   D   bld/offline/tests/CLM_test.pm
   D   bld/offline/tests/CLM.pm
   D   bld/offline/tests/test-model.pl
   D   bld/offline/tests/model_specs.csh
   D   bld/offline/tests/CLM_run.pm
   D   bld/offline/tests/test_batch.csh
   D   bld/offline/tests/Makefile
   D   bld/offline/tests/configure.csh
   D   bld/offline/tests/lab_default.pm
   D   bld/offline/mkSrcfiles
   D   bld/offline/mkDepends
   D   bld/offline/jobscript.csh
   D   bld/offline/Makefile

List all subroutines added and what they do:
   A   test/system
   A   test/system/TCB.sh
   A   test/system/tests_pretag_bluevista
   A   test/system/config_files
   A   test/system/config_files/4p_casa_h
   A   test/system/config_files/4p_casa_m
   A   test/system/config_files/4p_casa_o
   A   test/system/config_files/17p_vodsr_h
   A   test/system/config_files/17p_vodsr_m
   A   test/system/config_files/17p_vodsr_o
   A   test/system/config_files/4p_vodsr_dh
   A   test/system/config_files/17p_cnn_h
   A   test/system/config_files/4p_vodsr_dm
   A   test/system/config_files/17p_cnn_dh
   A   test/system/config_files/17p_cnn_m
   A   test/system/config_files/4p_vodsr_do
   A   test/system/config_files/17p_cnn_o
   A   test/system/config_files/10p_dgvm_h
   A   test/system/config_files/4p_casa_dh
   A   test/system/config_files/17p_cnn_dm
   A   test/system/config_files/17p_cnn_do
   A   test/system/config_files/10p_dgvm_dh
   A   test/system/config_files/10p_dgvm_m
   A   test/system/config_files/4p_casa_dm
   A   test/system/config_files/10p_dgvm_o
   A   test/system/config_files/4p_casa_do
   A   test/system/config_files/README
   A   test/system/config_files/10p_dgvm_dm
   A   test/system/config_files/10p_dgvm_do
   A   test/system/config_files/17p_vodsr_dh
   A   test/system/config_files/17p_vodsr_dm
   A   test/system/config_files/17p_vodsr_do
   A   test/system/config_files/4p_vodsr_h
   A   test/system/config_files/4p_vodsr_m
   A   test/system/config_files/4p_vodsr_o
   A   test/system/gen_test_table.sh
   A   test/system/TBL.sh
   A   test/system/CLM_compare.sh
   A   test/system/nl_files
   A   test/system/nl_files/t31_cnall
   A   test/system/nl_files/t31_dgvm
   A   test/system/nl_files/t31
   A   test/system/input_tests_master
   A   test/system/TBR.sh
   A   test/system/tests_pretag_bangkok
   A   test/system/tests_pretag_bluesky
   A   test/system/TER.sh
   A   test/system/test_driver.sh
   A   test/system/tests_pretag_tempest
   A   test/system/CLM_runcmnd.sh
   A   test/system/TSM.sh

List all existing files that have been modified, and describe the changes:

Summary of testing:

  bluesky:
   001 sm111 TSM.sh 4p_vodsr_dh t31 48 ...............................PASS
   002 er111 TER.sh 4p_vodsr_dh t31 10+38 ............................PASS
   003 br111 TBR.sh 4p_vodsr_dh t31 24+24 ............................FAIL! rc= 11
   004 bl111 TBL.sh 4p_vodsr_dh t31 48 ...............................SKIPPED*
   005 sm114 TSM.sh 4p_vodsr_h t31 48 ................................PASS
   006 sm121 TSM.sh 17p_vodsr_dh t31 48 ..............................PASS
   007 er121 TER.sh 17p_vodsr_dh t31 10+38 ...........................PASS
   008 br121 TBR.sh 17p_vodsr_dh t31 24+24 ...........................FAIL! rc= 11
   009 bl121 TBL.sh 17p_vodsr_dh t31 48 ..............................SKIPPED*
   010 sm124 TSM.sh 17p_vodsr_h t31 48 ...............................PASS
   011 sm211 TSM.sh 17p_cnn_dh t31_cnall 48 ..........................PASS
   012 er211 TER.sh 17p_cnn_dh t31_cnall 10+38 .......................PASS
   013 br211 TBR.sh 17p_cnn_dh t31_cnall 24+24 .......................FAIL! rc= 11
   014 bl211 TBL.sh 17p_cnn_dh t31_cnall 48 ..........................SKIPPED*
   015 sm311 TSM.sh 4p_casa_dh t31_dgvm 48 ...........................PASS
   016 er311 TER.sh 4p_casa_dh t31_dgvm 10+38 ........................PASS
   017 br311 TBR.sh 4p_casa_dh t31_dgvm 24+24 ........................FAIL! rc= 11
   018 bl311 TBL.sh 4p_casa_dh t31_dgvm 48 ...........................SKIPPED*
   019 sm411 TSM.sh 10p_dgvm_dh t31_dgvm 48 ..........................PASS
   020 er411 TER.sh 10p_dgvm_dh t31_dgvm 10+38 .......................PASS
   021 br411 TBR.sh 10p_dgvm_dh t31_dgvm 24+24 .......................FAIL! rc= 11
   022 bl411 TBL.sh 10p_dgvm_dh t31_dgvm 48 ..........................SKIPPED*
   
   Note, the branch tests failed only in the differences to the time_bounds variable
   upon branching - all other variables stayed the same. This has been reported as
   bug #290.

  bangkok/lf95: (new tests will be added in later tags)
   001 sm112 TSM.sh 4p_vodsr_dm t31 48 ...............................PASS
   002 er112 TER.sh 4p_vodsr_dm t31 10+38 ............................FAIL! rc= 11
   003 br112 TBR.sh 4p_vodsr_dm t31 24+24 ............................FAIL! rc= 11
   004 bl112 TBL.sh 4p_vodsr_dm t31 48 ...............................SKIPPED*
   005 sm115 TSM.sh 4p_vodsr_m t31 48 ................................PASS

   Note, the branch tests failed only in the differences to the time_bounds variable
   upon branching - all other variables stayed the same. This has been reported as
   bug #290.

   Note, the restart test fails in rtm (the exact same restart test passes on bluesky).
   This has been reported as bug #291. 

  tempest: (tests must still be done)

CLM tag used for the baseline comparison tests if applicable:

Summarize any changes to answers: NONE
	
===============================================================

===============================================================
Tag name: clm3_expa_77
Originator(s): tcraig
Date: Thu Nov  9 23:08:50 MST 2006
One-line Summary: fix retain branch casename bug in restFileMod

Purpose of changes: correct behaviour of retain branch casename.  
  Was mostly working ok except for a few cases where the test
  of the old and new casename would produce the incorrect result.

Bugs fixed (include bugzilla ID): #269

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: none

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      src/main/restFileMod.F90
       - recode verify call to a more robust index call and associated mods

Summary of testing:

  bluesky: none
  tempest: none
  bangkok/lf95: all CAM tests passed with cam3_3_40 vs cam3_3_37
  bluevista: tested in CCSM with ERB test
  lightning: tested in CCSM with ERB test

Summarize any changes to answers: NONE
	
===============================================================
===============================================================
Tag name: clm3_expa_76
Originator(s): tcraig,nanr,pworley
Date: Sun Oct 29 16:03:38 MST 2006
One-line Summary: memory use and rtm parallelization/rewrite

Purpose of changes: Merge fmd07_clm3_expa_75 to the main trunk.
  That branch has several updates related to memory usage and
  parallelization of RTM.  In addition, rtm subcycling was
  added to address problems in cfl in rtm and a bug was fixed
  that resulted in incorrect downstream flux when volumes were
  negative.  Also, mksurfdata was updated to add fmax and
  several other minor bugs were fixed.

Bugs fixed (include bugzilla ID):
  RTM was changed from velocity limiting to subcycling to
    handle cfl issues.
  RTM bug fix in downstream flux calculation when volumes were
    negative
  Fix to history file for long_name.
  Add bounds attribute to time variable in history files (#254).

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by:

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:
	M      tools/newcprnc/cprnc.F90
	M      tools/newcprnc/nfwrappers.f90
	M      tools/mksurfdata/mksrfdat.namelist
	M      tools/mkgriddata/mkvarctl.F90
	M      tools/mkgriddata/README
	M      tools/mkgriddata/domainMod.F90
	M      tools/mkgriddata/mkgriddata.F90
	M      tools/mkgriddata/creategridMod.F90
	M      bld/offline/tests/test_batch.csh
	M      src/biogeochem/CASAMod.F90
	M      src/biogeochem/DGVMMod.F90
	M      src/main/spmdGathScatMod.F90
	M      src/main/clm_varcon.F90
	M      src/main/ncdio.F90
	M      src/main/atmdrvMod.F90
	M      src/main/initializeMod.F90
	M      src/main/pftdynMod.F90
	M      src/main/histFileMod.F90
	M      src/main/program_csm.F90
	M      src/main/clm_atmlnd.F90
	M      src/main/clm_csmMod.F90
	M      src/main/restFileMod.F90
	M      src/main/ndepFileMod.F90
	M      src/main/initGridCellsMod.F90
	M      src/main/lnd_comp_mct.F90
	M      src/main/surfrdMod.F90
	M      src/main/domainMod.F90
	M      src/main/decompMod.F90
	M      src/main/areaMod.F90
	M      src/main/iobinary.F90
	M      src/main/clmtype.F90
	M      src/main/histFldsMod.F90
	M      src/SVN_EXTERNAL_DIRECTORIES
	M      src/riverroute/RtmMod.F90
	M      src/riverroute/RunoffMod.F90
	
- added Pat Worley's mods for initialization performance on phoenix.  in 
  decompMod and areaMod.
- add fmax calculation in mksurdata
- add time bounds attribute and fix long_name string in history files
- rtm refactor.  convert from 2d to 1d fields.  inline routines where
  appropriate.  introduce downstream index instead of rdirc.  
  parallelize over river basins.  update i/o for parallel rtm.
  introduce subcycling.  fix bug in downstream flux calc when
  volume is negative.  introduce max timestep calculation for cfl
  for use in subcyling.  add cfl_scale parameter to rtm to set
  relative cfl limit, set cfl_scale to 0.1.  remove rtmfluxini
  routine, set fluxout=0 at initialization.  update rtm restart
  to maximize backward compatability but allowing upgrade.
- remove global domains after use in initalization.  introduce
  local domains (locdomain) in run phase.  add decomp_domg2l meethod.
  add regional and decomped logicals to domain type.
- migrate all ioglobal calls to iolocal.
- inline interpa2si in atmdrv.
- add mct to externals set, not yet used.

Summary of testing:

  This tag is bfb except when RTM is turned on.  the bug fix
  and subcycling change answers by more than roundoff.  A validation
  was performed with RTM, see below.

  bluesky: clm stand alone tests pass except RTM fields.
  bluesky: cam pretag tests all pass
  tempest: cam pretag tests all pass
  bangkok/lf95: cam pretag tests all pass
  bluevista: ccsm test bfb except rtm fields which lead to
	     divergence in solution after 2 days.  pass ERS test.
  bluevista: finemesh tests case runs to completion.
  lightning: ccsm test bfb except rtm fields which lead to
	     divergence in solution after 2 days.  pass ERS test.

CLM tag used for the baseline comparison tests if applicable:
  clm3_expa_69, cam3_3_37, ccsm3_1_beta40

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: RTM subcyling and bug fix
    - what platforms/compilers: all
    - nature of change (roundoff; larger than roundoff/same climate; new climate): larger than roundoff, same climate

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   b31.001r1 validation run done, see /TCRAIG/csm/b31.001r1 relative
   to /CCSM/csm/b31.001.  Keith Oleson also carried out a standalone
   clm run and found bfb except in runoff fields.  Results reviewed
   by land and ocean groups.

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository): ccsm3_1_beta39
	and ccsm3_1_beat39 + fmd06_clm3_expa_74
   - platform/compilers: bluevista16
   - configuration (CPP ifdefs): ccsm B2 case
   - build-namelist command (or complete namelist):
   - MSS location of output: /CCSM/csm/b31.001, /TCRAIG/csm/b31.001r1

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================

NOTE (1/11/07):  This note documents a commit done by nanr (r2316) that committed 
	changes to /tools/mksurfdata files without a tag.  Changes introduced fmax variable to mksrfdat.F90.
	mkfmax.F90 was added in clm3_expa_84.  Changes were only to /tools and not to clm code.

M	/tools/mksrfdat.F90
	
===============================================================
Tag name: clm3_expa_75
Originator(s): mvertens	
Date: Tue Oct 24 21:10:59 MDT 2006
One-line Summary: sequential and concurrent ccsm now have same flux sign convention

Purpose of changes: To have consistent flux sign convention in sequential and concurrent ccsm.
As a result, lnd_comp_mct.F90 now has same flux sign convention as clm_csmsMod.F90
(i.e. fluxes are positive downwards).

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none
 
Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvertens

List all subroutines eliminated: nonen

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
   M  lnd/clm2/src/main/clm_time_manager.F90
      - Removed write statement to fort.30

   M  lnd/clm2/src/main/lnd_comp_mct.F90
      - Changed sign convention of fluxes sent to driver to be consistent 
        with those used by concurrent ccsm

Summary of testing:

  no offline or ccsm tests were done
  ran cam testing suite successfully (see ChangeLog for cam3_3_37)

Summarize any changes to answers: See ChangeLog for cam3_3_37
	
===============================================================
===============================================================
Tag name: clm3_expa_74
Originator(s): mvertens
Date: Mon Oct  2 20:16:52 MDT 2006
One-line Summary: removed SCAM if-defs from lnd_comp_mct.F90

Purpose of changes: Let SCAM driver decide if clm has a land point
   rather than putting that decision in lnd_comp_mct.F90.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: erik

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
  M lnd_comp_mct.F90
    - removed SCAM if-defs

Summary of testing:

  bluesky: all CAM tests passed using this lnd_comp_mct.F90
  tempest: all CAM tests passed using this lnd_comp_mct.F90
  bangkok/lf95: all CAM tests passed using this lnd_comp_mct.F90

Summarize any changes to answers: NONE
	
===============================================================
===============================================================
Tag name: clm3_expa_73
Originator(s): mvertens
Tue Sep 26 08:33:48 MDT 2006
One-line Summary: removed use of mpicom as cam module variable

Purpose of changes: to make determination of clm mpi commmunicator
   self contained

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: 
  clm namelist in cam-standalone mode has changed
  clm namelist in offline and ccsm mode has not changed

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: tcraig, robj, eaton

List all subroutines eliminated: 
  
  D  src/main/do_restwrite.F90

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  M  src/main/histFileMod.F90
     - removed COUP_CAM if-def for setting if_writrest flag
  M  src/main/program_csm.F90
     - initialize mpi communicator group and iam, masterproc and npes in this module
  M  src/main/controlMod.F90
     - added ditme_out to scam_clm_default_opts call 
       this should have been done when the cam time manager was no longer used by clm
  M  src/main/lnd_comp_mct.F90
     - removed lnd_export_init (using only lnd_export now) 
     - now passing LNDID, mpicom as input argument to lnd_init_mct
     - mct_gsmap_init now used to set clm gsmap (rather than seq_init_setgsmap_init)
  M  src/main/program_off.F90
     - initialize mpi communicator group and iam, masterproc and npes in this module
  M  src/main/spmdMod.F90
     - masterproc, iam, npes and mpicom are now module variables
     - mpi no longe intialized in spmd_init
     - clm communicator pased in as argument

Summary of testing:

  bluesky:
    - ran test_batch.csh and verified that all tests passed successfully
	 when compared to clm3_expa_69
    - ran cam3_3_31 sandbox (not checked in yet) using clm3_expa_73 code changes 
         and verified that all tests passed successfully when compared to cam3_3_30
    - ran ESR.T31_g35.B.bluesky using ccsm3_1_beta36 and the clm3_expa_73 code base
         and verified that results were bfb when compared to ccsm3_1_beta36
  tempest:
    - ran cam3_3_31 sandbox (not checked in yet) using clm3_expa_73 code changes 
         and verified that all tests passed successfully when compared to cam3_3_30
  bangkok/lf95:
    - ran cam3_3_31 sandbox (not checked in yet) using clm3_expa_73 code changes 
         and verified that all tests passed successfully when compared to cam3_3_30

CLM tag used for the baseline comparison tests if applicable: clm3_expa_69

Summarize any changes to answers: Results are bfb
	
===============================================================
===============================================================
Tag name: clm3_expa_72
Originator(s): mvertens
Date: Sun Sep 24 17:40:41 MDT 2006
One-line Summary: removed spaces before #include in controlMod.F90

Purpose of changes: fixed spaces before #include in controlMdd.F90
   this caused problems on lightning with CCSM build (where the
   c preprocessor is invoked independently 

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none
 
Describe any substantial timing or memory changes: nonen

Code reviewed by: mvertens

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
 M src/main/controlMod.F90
    - removed spaces before #include (introduced in clm3_epxa_70)

Summary of testing:

  bluesky: none
  tempest: none
  bangkok/lf95: none

Summarize any changes to answers: Answers are bfb
	
===============================================================
===============================================================
Tag name: clm3_expa_71
Originator(s): jwolfe
Date: Wed Sep 20 12:09:10 MDT 2006
One-line Summary: fixed single executable problem on lightning

Purpose of changes: to fix single executable ccsm problem on lightning

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: jwofle

List all subroutines eliminated: none

List all subroutines added and what they do: one

List all existing files that have been modified, and describe the changes:
  program_csm.F90
   - call to opm_set_threads only invoked now if cpp variable _OPENMP is defined

Summary of testing:

  bluesky: none
  tempest: none
  bangkok/lf95: none
  lightning/pathscale : ccsm mode  only tested

  Note: this change only effects the driver for COUP_CSM mode and so will
  have no impact on COUP_CAM or OFFLINE mode   

CLM tag used for the baseline comparison tests if applicable:

Summarize any changes to answers: answers are bfb
===============================================================
===============================================================
Tag name: clm3_expa_70
Originator(s): mvertens
Date: Thu Sep 14 12:53:28 MDT 2006
One-line Summary: removed use of cam time manager in COUP_CAM mode

Purpose of changes: To enable clm to only use the clm time manager regardless
   of the modes it is run in

Bugs fixed (include bugzilla ID): #215 will be resolved when clm3_expa_70
   is checked into the cam code base

Describe any changes made to build system: clm.template needed to have
   \$CODEROOT/csm_share/eshr added to Filepath

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: mvertens, erik (briefly)

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:
   M   src/main/clm_comp.F90
         - passed SyncClock as optional argument to clm_init1 and call initialize2 
   M   src/main/initializeMod.F90
         - obtained initialization information from SyncClock if passed in as argument,
           rather than using namelist input. For restart runs, stop date obtained from
           SyncClock if passed in as argument, rather than from namelist input.
         - removed COUP_CAM as CPP if-def
   M   src/main/restFileMod.F90
         - renamed routine that reads in time manager restart information to timemgr_restart_io
   M   src/main/controlMod.F90
         - now use clm_time_manager in all CLM modes (including COUP_CAM)
         - removed call to CAM radiation_get routine
         - ***Note that this assumes that CAM and CLM radiation frequency are identical ***
         - ***Should put this into the CAM build-namelist generation routine - filed as a bug report ***
         - need to put in such a check in the future
         - dtime obtained now from CLM namelist, not CAM time manager
   M   src/main/clm_time_manager.F90
         - put in new optional arguments into timemgr_init and timemgr_restart to use SyncClock values if 
           they are passed in to initialize clock
   M   src/main/lnd_comp_mct.F90
         - passed SyncClock in as argument into clm_init1

Summary of testing:

    bluesky: 
    - ran test_batch.csh and verified that all tests passed successfully
	   when compared to clm3_expa_69
    - ran cam3_3_27 using clm3_expa_70 code changes and verified that 
      all tests passed successfully when compared to cam3_3_27
    - ran ESR.T31_g35.B.bluesky using ccsm3_1_beta36 and the clm3_expa_70 code base
      and verified that results were bfb when compared to ccsm3_1_beta36

Summarize any changes to answers: Results are bfb
	
===============================================================
===============================================================
Tag name: clm3_expa_69
Originator(s): erik, jedwards, jeff
Date: Thu Aug 17 09:54:23 MDT 2006
One-line Summary: Fix perpetual bug and update csm_share

Purpose of changes: Fix bugs in perpetual mode and restat_option="end" when
	running with CAM.

Bugs fixed (include bugzilla ID): 107, 185

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: self

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M bld/offline/tests/CLM_lab.pm
    Put test output for all platforms under "clmtest" directory
M bld/offline/tests/test_batch.csh
    Update version comparing to, abort if error status is not ok.
M src/SVN_EXTERNAL_DIRECTORIES
    Update csm_share to share3_060814
M src/main/ncdio.F90
    Change from Jim Edwards to eliminate use of wrap_nf module (from cam3_3_19 commit)
M src/main/controlMod.F90
    Change from Jeff Lee to make use statement for "shr_inputInfo_mod" all lower-case.
    This is important for the CCSM dependency generator on some platforms.

Summary of testing:

  bluesky: all tests pass
  tempest: T31 debug-mode, spmd=False test fails
  bangkok/lf95: all tests pass

CLM tag used for the baseline comparison tests if applicable: clm3_expa_65, and
                                                              clm3_expa_67 (bangkok)

  Summarize any changes to answers: bit-for-bit

Move branch tag over to trunk from: fixtgrbug2_clm3_expa_68

===============================================================
===============================================================
Tag name: clm3_expa_68
Originator(s): mvertens
Date: Wed Aug  9 16:43:04 MDT 2006
One-line Summary: replaced time_manager.F90 with clm_time_manager.F90

Purpose of changes: To eliminate name space conflicts in the 
	single executable CCSM mplementation. 

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none 

Code reviewed by: erik, mvertens

Externals changed:  

List all subroutines eliminated:

List all subroutines added and what they do: 
	
List all existing files that have been modified, and describe the changes:

- time_manager.F90 has been moved to clm_time_manager.F90
  to eliminate name space conflicts in the single executable CCSM 
  implementation. For stand-alone CAM, clm_time_manager.F90 simply
  uses the cam time_manager.F90 code.	 
- program_csm.F90 has also been modified to put in changes needed	
  for the single executable ccsm implementation.	
	
        M      src/biogeochem/CNCStateUpdate2Mod.F90
	M      src/biogeochem/CASAPhenologyMod.F90
	M      src/biogeochem/CNC13StateUpdate2Mod.F90
	M      src/biogeochem/CNNStateUpdate1Mod.F90
	M      src/biogeochem/DGVMEcosystemDynMod.F90
	M      src/biogeochem/CNBalanceCheckMod.F90
	M      src/biogeochem/CNNStateUpdate3Mod.F90
	M      src/biogeochem/CNFireMod.F90
	M      src/biogeochem/CNMRespMod.F90
	M      src/biogeochem/CASAMod.F90
	M      src/biogeochem/CNPhenologyMod.F90
	M      src/biogeochem/CNCStateUpdate1Mod.F90
	M      src/biogeochem/CNDecompMod.F90
	M      src/biogeochem/STATICEcosysDynMod.F90
	M      src/biogeochem/CNCStateUpdate3Mod.F90
	M      src/biogeochem/CNC13StateUpdate1Mod.F90
	M      src/biogeochem/DGVMMod.F90
	M      src/biogeochem/CNC13StateUpdate3Mod.F90
	M      src/biogeochem/CNAnnualUpdateMod.F90
	M      src/biogeochem/CNNStateUpdate2Mod.F90
	M      src/biogeochem/CNNDynamicsMod.F90
	M      src/biogeochem/CNAllocationMod.F90
	M      src/biogeochem/CNC13FluxMod.F90
	D      src/main/time_manager.F90
	M      src/main/accumulMod.F90
	M      src/main/clm_comp.F90
	M      src/main/driver.F90
	M      src/main/atmdrvMod.F90
	M      src/main/subgridRestMod.F90
	M      src/main/accFldsMod.F90
	M      src/main/initializeMod.F90
	M      src/main/pftdynMod.F90
	M      src/main/iniTimeConst.F90
	M      src/main/histFileMod.F90
	M      src/main/program_csm.F90
	M      src/main/do_restwrite.F90
	M      src/main/clm_csmMod.F90
	M      src/main/restFileMod.F90
	M      src/main/controlMod.F90
	M      src/main/initSurfAlbMod.F90
	A  +   src/main/clm_time_manager.F90
	M      src/main/ndepFileMod.F90
	M      src/main/lnd_comp_mct.F90
	M      src/main/program_off.F90
	M      src/main/do_close_dispose.F90
	M      src/riverroute/RtmMod.F90
	M      src/biogeophys/BalanceCheckMod.F90
	M      src/biogeophys/SurfaceRadiationMod.F90
	M      src/biogeophys/SoilTemperatureMod.F90
	M      src/biogeophys/SnowHydrologyMod.F90
	M      src/biogeophys/Biogeophysics2Mod.F90
	M      src/biogeophys/SurfaceAlbedoMod.F90
	M      src/biogeophys/Hydrology1Mod.F90
	M      src/biogeophys/Hydrology2Mod.F90
	M      src/biogeophys/BiogeophysicsLakeMod.F90
	M      src/biogeophys/SoilHydrologyMod.F90
	M      src/biogeophys/HydrologyLakeMod.F90
	M      src/biogeophys/CanopyFluxesMod.F90
		
Summary of testing: 
        - ran test-model.pl on bluesky and verified that all tests
	  passed successfully when compared to clm3_expa_67
	- ran cam3_3_17 test model suite with clm3_expa_68 code used
	  for clm and verified that all tests passed successfully when 
	  compared to cam3_3_17
	- ran ERS.T31_g35.I.bluesky using ccsm3_1_beta35 and the clm3_expa_68
	  clm code based and verified that results were bfb when compared to
	  ccsm3_1_beta35
	
CLM tag used for the baseline comparison tests if applicable: 

Summarize any changes to answers: results are bfb

===============================================================
Tag name: clm3_expa_67
Originator(s): tcraig
Date: Thu Jul 27 12:50:37 MDT 2006
One-line Summary: Fix tiny bug in controlMod.F90 for lighting compiling 

Purpose of changes: compiler failure associated with inconsistent
	module name related to shr_input vs shr_Input.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: 

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: 

Code reviewed by: jeff, mvertens

Externals changed:  

List all subroutines eliminated:

List all subroutines added and what they do: 
	
List all existing files that have been modified, and describe the changes:

src/main/controlMod.F90
-     use shr_InputInfo_mod, only : shr_inputInfo_initType,       &
+     use shr_inputinfo_mod, only : shr_inputInfo_initType,       &
		
Summary of testing: NONE

CLM tag used for the baseline comparison tests if applicable: 

Summarize any changes to answers: should be bit-for-bit

===============================================================
Tag name: clm3_expa_66
Originator(s): tcraig
Date: Tue Jul 25 17:29:37 MDT 2006
One-line Summary: Add topographic downscaling, refactor mid-level infrastructure

Purpose of changes: Add topographic downscaling, improve memory use and scaling,
	step towards supporting nested grids.  Merge fmc12_clm3_expa_64 to trunk.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: 

Describe any changes made to the namelist: Add two new optional namelist to
	read atm and lnd topography, fatmtop, flndtop

List any changes to the defaults for the boundary datasets: Updated the
	mkgriddata tool to produce an optional topographic dataset.
	Several topo datasets added to inputdata/lnd/clm2/griddata/.
	These datasets have not been added to any scripts as they
	are optional at this point and the scripts don't support 
	downscaling yet "out of the box".

Describe any substantial timing or memory changes: Memory scaling much improved.
	still too many global arrays in domain and decomp.  these will be removed
	in future revisions.

Code reviewed by: 

Externals changed:  

List all subroutines eliminated:
D      src/main/surfFileMod.F90
D      src/main/initSubgridMod.F90
	

List all subroutines added and what they do: 
A  +   src/main/subgridMod.F90
  - code cleanup and merge of deleted subroutines
A  +   src/main/surfrdMod.F90
  - added to isolate routines and eliminate circular use issues
	
List all existing files that have been modified, and describe the changes:
M      tools/mkgriddata/mkvarctl.F90
M      tools/mkgriddata/domainMod.F90
M      tools/mkgriddata/mkgriddata.F90
M      tools/mkgriddata/areaMod.F90
M      tools/mkgriddata/creategridMod.F90
M      tools/mkgriddata/mkvarsur.F90
M      src/biogeochem/CASAMod.F90
M      src/biogeochem/STATICEcosysDynMod.F90
M      src/biogeochem/DGVMMod.F90
M      src/main/clm_varpar.F90
M      src/main/driver.F90
M      src/main/ncdio.F90
M      src/main/atmdrvMod.F90
M      src/main/subgridRestMod.F90
M      src/main/initializeMod.F90
M      src/main/clmtypeInitMod.F90
M      src/main/pftdynMod.F90
M      src/main/iniTimeConst.F90
M      src/main/histFileMod.F90
M      src/main/clm_atmlnd.F90
M      src/main/clm_varsur.F90
M      src/main/clm_csmMod.F90
M      src/main/controlMod.F90
M      src/main/filterMod.F90
M      src/main/clm_varctl.F90
M      src/main/ndepFileMod.F90
M      src/main/initGridCellsMod.F90
M      src/main/lnd_comp_mct.F90
M      src/main/domainMod.F90
M      src/main/decompMod.F90
M      src/main/areaMod.F90
M      src/main/clmtype.F90
M      src/riverroute/RtmMod.F90
M      src/biogeophys/SurfaceAlbedoMod.F90

Merge fmc12_clm3_expa_64 to trunk:
- update mkgrid to add topographic data file generation
- comment out print statement in lnd_comp_mct
- change use of shr_kind_mod in SurfaceAlbedoMod for compiler
  problem on pgi (MVR)
- change clm so memory now dynamically allocated.  LSMLON and LSMLAT
  in preproc.h no longer used except for with SCAM.  MAXPATCH still
  used but could be changed into a namelist input.
- add support for reading topographic datasets and using them
  for downscaling between clm atm and land grids.
- reorganize code to eliminate circular use logic
- rewrite decompInit to improve memory use and scaling
- remove obsolete routines in decompMod.F90
- rename datatype procs to procinfo, now contains only local data
- modify clmtype so all data is local gdc, no more global arrays in
  clmtype!
- update map_type for efficient memory use.  like mct with 1d arrays
  consisting of src, dst, S (COL, ROW, S).  update the internal clm
  atm/lnd mappings to use new datatype.  lnd/rtm and driver/atm
  mapping still using gridmap_type.  this will be updated in future
  versions.
- convert domain from 2d global to 1d global arrays.  add glo 
  decomp which is global 1d indexing like ij to 1d or gsn 
  uncompressed.
- convert wtxy, vegxy, pctspec from 2d to 1d arrays.  migrate many other arrays 
  from 2d global (i,j) to 1d global.  this is for nesting and to eventually
  cut down on number of index mappings in decomp_type
- reorganize order of initialization calls to start thinking about nesting
- add gatm array to domain datatype
- clean up dead code.
- rename initSubgridMod to subgridMod
- move map_indexes to subgridMod, rename get_subgrid_indexees
- rearrange a few subroutines to improve filename hierarchy and use logic
- delete get_sn routines, no longer needed
- update indexing in clm_atmlnd, remove hardwire indexes
- rewrite i/o as needed for 1d global arrays, not 2d
- delete gatherWeightsDGVM from DGVMMod.F90, no longer needed
- rename surfFileMod to surfrdMod.F90
- reduce size of subgrid_type and redefine gcelldc and gcellsn


Summary of testing:

  bluesky: 	clm test passes, cam pretag passes except ccsm
  tempest: 	cam pretag passes
  bangkok/lf95: cam pretag passes except bl153, bl353, bl553 due to code
	changes and resulting binary produced by compiler optimizations.
	also scam fails.

CLM tag used for the baseline comparison tests if applicable: clm3_expa_65, cam3_3_16

  Summarize any changes to answers: NONE bit-for-bit

===============================================================
===============================================================
Tag name: clm3_expa_65
Originator(s): Erik Kluzek
Date: Mon Jul 10 13:52:20 MDT 2006
One-line Summary: Use share clocks and inputinfo object at driver level

Purpose of changes: Use new version of esmf_wrf and csm_share as next step
  in sequential CCSM development.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: Add ability to use Darwin, add eshr to
Filepath

Describe any changes made to the namelist: Instead of directing namelist from stdin
  explicitly open namelist filename.  Change namelist name from clmexp to clm_inparm.

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Mariana Vertenstein, Tony Craig, Forrest Hoffman

Externals changed:  csm_share        to share3_060710
		    esmf_wrf_timemgr to esmf_wrf_timemgr_060616

List all subroutines eliminated: None

List all subroutines added and what they do: control_setNL (controlMod.F90) sets the
  namelist filename.

List all existing files that have been modified, and describe the changes:

tools/newcprnc/Makefile
bld/offline/tests/CLM_namelist.pm
bld/offline/tests/CLM_lab.pm
bld/offline/tests/CLM.pm
bld/offline/tests/model_specs.csh
bld/offline/tests/configure.csh
bld/offline/tests/config_machine_specs.csh
bld/offline/tests/CLM_run.pm
bld/offline/tests/test_batch.csh
bld/offline/tests/Makefile
bld/offline/jobscript.csh

    Add eshr to Filepath, add Darwin as a valid platform, don't redirect unit 5 for
namelist. Set MODEL_DATDIR explicitly. Use lnd.stdin as default namelist name.
Add "-g" to Makefile. Change clm namelist from clmexp to clm_inparm. Get test_batch.csh
to work both on bangkok for Linux/Lahey and tempest for SGI. Write out Rootdir file
when configuring build directory.

src/main/time_manager.F90 -- Use dayOfYear_r8 for calc_calday.
src/main/clm_comp.F90 ------ Pass CCSMInit in.
src/main/fileutils.F90 ----- Small changes to how using shr_file_mod.
src/main/initializeMod.F90 - Pass clock in.
src/main/program_csm.F90 --- Change where ESMF_Initialize is done.
src/main/controlMod.F90 ---- Add method to set namelist name, pass clock in and use it.
src/main/clm_varctl.F90 ---- Get rid of cam_ variables.
src/main/lnd_comp_mct.F90 -- Pass in clock and CCSMInit object.

Summary of testing:

  bluesky: 	test-batch.csh -- PASS and CAM and CAM CCSM tests pass.
  tempest: 	test-batch.csh -- PASS and CAM tests pass.
  bangkok/lf95: test-batch.csh -- PASS and CAM tests pass.

CLM tag used for the baseline comparison tests if applicable: clm3_expa_64

  Summarize any changes to answers: NONE bit-for-bit

===============================================================
===============================================================
Tag name: clm3_expa_64
Originator(s): Dani Bundy Coleman <bundy@ucar.edu>
Date: Thu Jun 29 14:44:07 MDT 2006
One-line Summary: dust modifications from Natalie Mahowald

Purpose of changes: update dust code 

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Mariana Vertenstein <mvertens@ucar.edu>

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      src/biogeochem/DUSTMod.F90
       OLD     dmt_vma = 2.524e-6_r8 ! [m] Mass median diameter analytic       She84 p.75 Table1
       NEW     dmt_vma = 3.500e-6_r8 ! [m] Mass median diameter analytic 

M      src/main/clm_atmlnd.F90
       add land-to-atmosphere communication of fv,ram1 & dust fluxes
       (only active if defined DUST or PROGSEASALT )
M      src/main/lnd_comp_mct.F90
       add land-to-atmosphere communication of fv,ram1 & dust fluxes
       (only active if defined DUST or PROGSEASALT )

Summary of testing:

  bluesky: tested with cam, bfb when DUST and PROGSEASALT not defined
  tempest:
  bangkok/lf95:  tested with cam, bfb when DUST and PROGSEASALT not defined

CLM tag used for the baseline comparison tests if applicable: clm3_expa_63

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
===============================================================
Tag name: clm3_expa_63
Originator(s): Mariana Vertenstein
Date: Fri May 12 16:08:03 MDT 2006  
One-line Summary: introduced mct domains in COUP_CAM mode

Purpose of changes: To introduce generalized mct domains
in COUP_CAM mode for the purposes of generating a sequential 
ccsm 

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none
 
Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Tony Craig

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
  lnd_comp_mct.f90 
     removed lnd_CheckGrid_mct routine and replaced it with lnd_domain_mct
     each processor sends it local domain information stored in an MCT
     GeneralGrid data structure back to the top level application driver. 
     A global gather is done for the GeneralGrid and domain comparison is
     performed on the master processor.     

Summary of testing:

  bluesky: only cam test suite was run successfully
  tempest: only cam test suite was run successfully
  bangkok/lf95: only cam test suite was run successfully

CLM tag used for the baseline comparison tests if applicable:

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
===============================================================
Tag name: clm3_expa_62
Originator(s): erik, tcraig
Date: Wed May 10 00:06:39 MDT 2006
One-line Summary: merge shrgetput08_clm3_expa_61, fix finemesh bugs

Purpose of changes: changes required for sequential ccsm.  validate
	finemesh is running properly.

Bugs fixed (include bugzilla ID):
	a couple finemesh bugs, not documented.

Describe any changes made to build system: modified makefile slightly
	to set HIDE_MPI when SPMD is FALSE, remove HIDE_SHR_MSG

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: erik, tcraig

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
Makefile:
 - remove HIDE_SHR_MSG, not needed anymore
 - add HIDE_MPI if SPMD is FALSE
SVN_EXTERNALS:
 - change csm_share version from share3_051205 to share3_060428
 - change emsf_wrf_timemgr version from esmf_wrf_timemgr_051212 to esmf_wrf_timemgr_060501
fileutils.F90:
 - uses shr_file_mod.F90 routines
 - use shr_file_mod syntax for archive_dir (using mss: prefix)
initializeMod.F90:
 - add pnamer_bin get
program_csm.F90:
 - add ESMF_Initialize call
clm_atmlnd.F90:
 - fix bug in call to grid_maparray for finemesh mapping, only affects finemesh runs.
controlMod.F90:
 - use shr_file_mod syntax for archive_dir (using mss: prefix)
lnd_comp_mct.F90:
 - change call to get_proc_bounds to get_proc_bounds_atm (bug for finemesh runs).
program_off.F90:
 - add calls to ESMF_Initialize and ESMF_Finalize
 
	
Summary of testing:
  bluesky: cam full suite bfb
	   clm full suite not bfb (TS is bfb for 2 days, history file not bfb
	      after ~1.5 days probably due to new esmf time manager, likely roundoff)
  tempest: cam full suite bfb, ccsm build test
  bangkok/lf95: cam full suite bfb
  bluevista : ccsm TER.01a.1.9x2.5_gx1v3.B.bluevista bfb
	      cam finemesh T42half.clim0 test, bfb for 42 timesteps vs cam3_2_49
  lightning : ccsm TER.01a.4x5_gx3v5.B.bluevista bfb

CLM tag used for the baseline comparison tests if applicable: 
  clm3_expa_61, cam3_3_4, ccsm3_1_beta27

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: clm standalone only
    - what platforms/compilers: only bluesky tested
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	assume roundoff.  it's bfb for at least a day.  in cam and ccsm mode they
	are bfb.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?  guess

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================

===============================================================
Tag name: clm3_expa_61
Originator(s): T Craig
Date: Thu Apr 27 01:10:40 MDT 2006
One-line Summary: merge cammct05_clm3_expa_58 onto main trunk,
  modify surface dataset input

Purpose of changes: merge branch

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself, developed my MV

List all subroutines eliminated:
  clm_camMod.F90 - interface to cam
  MCT_atmlnd_cpl.F90 - mct migrated to sequential driver
  MCT_lnd_comp.F90 - mct migrated to sequential driver

List all subroutines added and what they do:
  lnd_comp_mct.F90 - interface to sequential driver using mct coupling
	
List all existing files that have been modified, and describe the changes:
  clm_comp.F90 - separate init method into init1, init2
  initializeMod.F90 - separate initialize into initialize1 and 2
  program_csm.F90 - add call to clm_init0
  clm_atmlnd.F90 - PWorley's changes to improve phoenix performance,
    packed arrays in clm_mapa2l and clm_mapl2a interpolation.
  program_off.F90 - add call to clm_init0
  areaMod.F90 - PWorley's changes to improve phoenix performance,
    interpolate packed arrays in gridmap_maparray
  Hydrology2Mod.F90 - remove use of iam

  mksurfdata, several files changed to convert
    mksrf_fgrid_global/regional to mksrf_fgrid and mksrf_gridtype
	
Summary of testing:

  bluesky: clm full suite bfb, cam full suite bfb
  bluevista: ccsm bfb TER.01a.T31_gx3v5.B.bluevista, TER.01a.4x5_gx3v5.B.bluevista
  tempest: cam full suite bfb
  bangkok/lf95: cam full suite bfb

  mksrf tested on bluevista, 7 cases, bfb
	
CLM tag used for the baseline comparison tests if applicable:
  clm3_expa_60, cam3_3_2, ccsm3_1_beta25

changes are bit-for-bit
	
===============================================================

	
===============================================================
Tag name: clm3_expa_60
Originator(s): Forrest Hoffman
Date: Fri Apr 14 11:03:34 EDT 2006
One-line Summary: Rearranged physiology fields, changed CO2 constants, fixed Bug #43

Purpose of changes: Make radiation-related physiology fields standard, prepare code for C-LAMP experiments, and make test-model run on Cray X1E (phoenix)

Bugs fixed (include bugzilla ID): Bug #43

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Myself

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

nfwrappers.f90:
Changed intent for ncid from intent(in) to intent(out) since it must be
returned to the calling routines.  This fixed Bug #43 which was discovered
on the Cray X1E (phoenix).

ChangeLog:
Added this log entry.

clm_varcon.F90:
Changed co2_ppmv_const to 283.1878_r8 for both CASA' and CN in preparation
for Experiment 1 of the C-LAMP.

histFldsMod.F90
Moved LAISUN, LAISHA, TLAI, TSAI, SLASUN, and SLASHA out of the CN-only
section of the code so that they appear on the regular CLM output files
since the two-leaf radiation code is now standard.  In addition, TLAI and
TSAI were removed from the DGVM-only section of the code since these
output fields are now standard.

Summary of testing:

  cheetah:
Ran test-model for T31, T31cn, T31cnall, T31casa, and T31dgvm with
baseline clm3_expa_59.  T31 and T31dgvm passed all tests.  The others
passed tests 01-05, but not the 06_control test because of the change
in co2_ppmv_const.

  phoenix:
Ran test-model for T31, T31cn, T31cnall, T31casa, and T31dgvm with
baseline clm3_expa_59.  T31 and T31dgvm passed all tests.  The others
passed tests 01-05, but not the 06_control test because of the change
in co2_ppmv_const.

CLM tag used for the baseline comparison tests if applicable: clm3_expa_59

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations: co2_ppmv_const modification changes answers
    - what platforms/compilers: IBM (cheetah) and Cray X1E (phoenix)
    - nature of change (roundoff; larger than roundoff/same climate; new climate): larger than roundoff because of changes in carbon pools

   If bitwise differences were observed, how did you show they were no worse
   than roundoff? cprnc

   * There is no validated climate in these model configurations. *

===============================================================
===============================================================
Tag name: clm3_expa_59
Originator(s): Tony Craig
Date: Wed Apr  5 18:03:23 MDT 2006
One-line Summary: add fatmlndfrc capability

Purpose of changes:  Support new datasets, other minor improvements,
  update mkgrid and mksurf tools for new dataset generation.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: jobscript.csh modified for
  new surface datasets, change baseline resolution to T31.

Describe any changes made to the namelist: added optional fatmlndfrc
  namelist input for landfrac file on atm grid.

List any changes to the defaults for the boundary datasets:  all new
  grid, frac, and surf datasets generated, located in 
  /fs/cgd/csm/inputdata/lnd/clm2/[griddata,surfdata]

Describe any substantial timing or memory changes: None

Code reviewed by: myself

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

tools/mksurfdata/mkrfdat.F90 - change default output filenames
tools/mksurfdata/mklaiMod.F90 - removed masking since there is no mask anymore
tools/mksurfdata/mkfileMod.F90 - removed read of LANDMASK and LANDFRAC
tools/mksurfdata/creategridMod.F90 - removed write of LANDMASK and LANDFRAC
tools/mksurfdata/Makefile - fix clean bug
tools/mkgriddata/mkgriddata.F90 - add generation of ffracdat file
   force area calculation for ccsm domain files due to noise in scrip areas
   change default output filenames
tools/mkgriddata/mkvarctl.F90 - add support for area recomputation
tools/mkgriddata/mkfileMod.F90 - removed, merged into creategridMod.F90
tools/mkgriddata/areaMod.F90 - add flush(6)
tools/mkgriddata/creategridMod.F90 - add mkfile subroutine
   fix bug in setting of corner points
   handle wrap-around points better with corner points
   add ability to adjust units of area (not automatic)
   add checks for area
   add ability write eigher grid or frac file in write_domain
bld/offline/tests/test_batch.csh - change default version from 53 to 58
   turn on dgvm testing by default
bld/offline/jobscript.csh - change to share queue on bluesky
   run mixed mpi/openmp by default, 2x2
   change default resolution to T31 (was T42)
   update to use new surface datasets
   change default, turn on DUST, RTM, VOC, turn off CN, SUPLN, SUNSHA, STOMATA2
   add unlimit unlimited for AIX
   fix redirection to compile_log.clm output file
src/main/initializeMod.F90 - add fatmlndfrc stuff
   add computation of ldomain%frac and ldomain%mask
src/main/controlMod.F90 - add fatmlndfrc stuff
src/main/clm_varctl.F90 - add fatmlndfrc stuff
src/main/driver.F90 - remove redundant definition of caldayp1
src/main/clmtypeInitMod.F90 - remove landfrac variable for clm3 gridcell_type
src/main/histFileMod.F90 - add indxupsc, jndxupsc indices for upscaling
src/main/program_csm.F90 - move shr_msg_stdio to after MPI_INIT, change
   call so it only redirects log file for masterproc.  this will clean
   up the log file significantly but may lead to error messages ending
   up in stdout.
src/main/surfFileMod.F90 - add fatmlndfrc stuff
src/main/initGridCellsMod.F90 - remove landfrac variable for clm3 gridcell_type
src/main/domainMod.F90 - reorder domain data slightly (nothing changed)
src/main/areaMod.F90 - change default of i_ovr and j_ovr from bigint to -1,
   allows for cleaner writing of indxupsc and jndxupsc in history file.
   change gridmap_setmapsFM to use _a and _l notation instead of _i and _o
src/main/clmtype.F90 - remove landfrac from clm3 gridcell_type

	
Summary of testing:

  Baseline versions, clm3_expa_58, cam3_2_56, ccsm3_1_beta24

  bluesky: clm full suite passes, cam full suite passes
  tempest: cam full suite passes 
  bangkok/lf95: cam full suite passes
  bluevista: ccsm TER.01a B passes for several resolutions, new datasets
     in scripts
	
CLM tag used for the baseline comparison tests if applicable: clm3_expa_58

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Code changes are bfb, but answers may change when using new surface datasets

  Summarize any changes to answers, i.e.,
    - what code configurations: CCSM answers will change with new datasets as
      default datasets are changing.  clm default test is bfb at T31 with new datasets,
      cam will be bfb as current default datasets are not being updated.
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================


===============================================================
Tag name: clm3_expa_58
Originator(s): Forrest Hoffman
Date: Thu Mar  9 17:04:27 EST 2006
One-line Summary: Updates for the Cray X1E and a forcing height error check.

Purpose of changes: Improvements on the Cray X1E and avoiding arithmetic exceptions when the forcing height is below the canopy height.

Bugs fixed (include bugzilla ID): Bug #36

Describe any changes made to build system: jobscript.csh modified for Cray X1E

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: myself and (for forcing height check code) Mariana Vertenstein

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

   jobscript.csh - Modified for Cray X1E and cross-compiler
   inicFileMod.F90 - Added compiler directives for vectorization
   driver.F90 - Commented out CSDs to avoid model hangs caused by write
      statements in science routines within the associated loops
   controlMod.F90 - Changed default clump_pproc to 1 for the Cray (since CSDs
      are not used in driver.F90
   histFldsMod.F90 - Changed type2d='levlak' for the TLAKE field
   CanopyFluxesMod.F90 - Inserted code to check if the forcing height
      is below the canopy height for any pft.  Model will now abort when this
      occurs instead of taking the log() of a negative number.  See Bug #36

Summary of testing:

  bluesky: test-model ran as follows
01_debug_run_SPMD: T31 ran
02_debug_run_nonSPMD: T31 ran
03_start: T31 ran
04_restart: T31 ran
05_norestart_compare_to_restart: T31 ran
06_control: T31 ran
01_debug_run_SPMD: T31cn ran
02_debug_run_nonSPMD: T31cn ran
03_start: T31cn ran
04_restart: T31cn ran
05_norestart_compare_to_restart: T31cn ran
06_control: T31cn ran
01_debug_run_SPMD: T31cnall ran
02_debug_run_nonSPMD: T31cnall ran
03_start: T31cnall ran
04_restart: T31cnall ran
05_norestart_compare_to_restart: T31cnall ran
06_control: T31cnall ran
01_debug_run_SPMD: T31casa ran
02_debug_run_nonSPMD: T31casa ran
03_start: T31casa ran
04_restart: T31casa ran
05_norestart_compare_to_restart: T31casa ran
06_control: T31casa ran
  cheetah:
01_debug_run_SPMD: T31cnall ran
02_debug_run_nonSPMD: T31cnall ran
03_start: T31cnall ran
04_restart: T31cnall ran
05_norestart_compare_to_restart: T31cnall ran
06_control: T31cnall ran
01_debug_run_SPMD: T31 ran
02_debug_run_nonSPMD: T31 ran
03_start: T31 ran
04_restart: T31 ran
05_norestart_compare_to_restart: T31 ran
06_control: T31 ran
01_debug_run_SPMD: T31cn ran
02_debug_run_nonSPMD: T31cn ran
03_start: T31cn ran
04_restart: T31cn ran
05_norestart_compare_to_restart: T31cn ran
06_control: T31cn ran
01_debug_run_SPMD: T31casa ran
02_debug_run_nonSPMD: T31casa ran
03_start: T31casa ran
04_restart: T31casa ran
05_norestart_compare_to_restart: T31casa ran
06_control: T31casa ran
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable: clm3_expa_57

===============================================================
Tag name: clm3_expa_57
Originator(s): Peter Thornton
Date: 31 Jan 2006
One-line Summary: Mods to allow switching between 3 and 4 soil
 organic matter pools

Purpose of changes: New science.

Bugs fixed (include bugzilla ID): bugs in pftdynMod.F90 and ndepfileMod.F90

Describe any changes made to build system:

Describe any changes made to the namelist: Added SOM4 as new CPP directive

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
main/clmtype.F90: added soil4c (and 13C equiv.), soil4n states and associated
    flux variables. Also added long name commenting for many previously defined
    variables.
main/clmtypeInitMod.F90: added initialization for new variables
main/CNiniTimeVar.F90: initialize new state variables.
main/histFldsMod.F90: added new variables, and also added long names for 
    many previously defined variables.
main/pftdynMod.F90: bug fix in mpi_bcast, change MPI_REAL8 to MPI_INTEGER.
main/ndepFileMod.F90: bug fix for mpi_bcast, change MPI_REAL8 to MPI_INTEGER.
biogeochem/CNSetValueMod.F90: add code for new state and flux variables.
biogeochem/CNDecompMod.F90: add code to allow either 3 or 4 SOM pools. Default
    behavior is 3 pools, 4-pool behavior triggered by SOM4 CPP directive.
biogeochem/CNCStateUpdate1Mod.F90: handling for new variables.
biogeochem/CNNStateUpdate1Mod.F90: handling for new variables.
biogeochem/CNSummaryMod.F90: handling for new variables.
biogeochem/CNBalanceCheckMod.F90: handling for new variables
biogeochem/CNPrecisionControlMod.F90: handling for new variables
biogeochem/CNC13FluxMod.F90: handling for isotope version of new variables
biogeochem/C13StateUpdate1Mod.F90: handling for new variables
biogeochem/C13SummaryMod.F90: handling for new variables
biogeochem/CNrestMod.F90: handling for new variables, and modify EXIT_SPINUP
    controls
    
Summary of testing:

  bluesky:
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable: in 3-pool mode 
(SOM4 not set), results are bfb with clm3_expa_55.  in 4-pool mode, changes
answers, as expected.

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
bfb under 3-pools is demonstrated at:
http:/www.cgd.ucar.edu/tss/clm/diagnostics/clm3cn/c13/ccsm3_bgc31_I_5a-ccsm3_bgc31_I_2b/setsIndex.html
	
===============================================================
Tag name: clm3_expa_56
Originator(s): Tony Craig
Date: 31 Jan 2006
One-line Summary: Final changes for finemesh implementation.

Purpose of changes: Integrate final changes for finemesh implementation.  These
changes are 100% backward compatable and bfb, but also support use of a finemesh grid.  finemesh implementation has been test in clm and cam.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: Update Makefile so Depends are regenerated if any code is changed.

Describe any changes made to the namelist: Added one new optional namelist, fatmgrid.  This is a dataset for the coarse grid in clm.  The format is the same as the surface dataset but only needs to include grid variables.

List any changes to the defaults for the boundary datasets:  Generated some new datasets with filled wetland and higher resolution.  Not required and not yet added to default suite of datasets.

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

tools/mksurfdata:
  mksrfdat.F90,areaMod.F90,creategridMod.F90
bld/offline/Makefile
doc/ChangeLog
 src/main:
clm_comp.F90,driver.F90,clm_camMod.F90,atmdrvMod.F90,clmtypeInitMod.F90,initializeMod.F90,histFileMod.F90,program_csm.F90,clm_atmlnd.F90,clm_csmMod.F90,surfFileMod.F90,controlMod.F90,clm_varctl.F90,initGridCellsMod.F90,MCT_lnd_comp.F90,program_off.F90,domainMod.F90,decompMod.F90,areaMod.F90,clmtype.F90
src/biogeophys/SurfaceAlbedoMod.F90

Code changes:
add pftm to domain datatype and history file
modify program_off and program_cs to use clm_init[1,2], clm_run[1,2]
modify coupling to handle coarse <-> finemesh for standlaone, cam, and
  ccsm.
modify Makefile so depends file is reset whenever there is a code change
add normalized area to history files
add lat_a, lon_a, latdeg_a, londeg_a to clm3 datatype for atm lats/lons.  
  required in SurfaceAlbedo computation where the the zenith angle has
  to be based on the atm (coarse) grid, not the fine clm grid.
merge with clm3_expa_53_brnchT_cam01 tag
	
Summary of testing:

  bluesky: clm full suite bfb, cam full suite bfb, ccsm bfb
  tempest: cam full suite bfb
  bangkok/lf95: cam full suite bfb

CLM tag used for the baseline comparison tests if applicable: clm3_expa_55

IF tag changes answers relative to baseline comparison the
following should be filled in: bfb

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff? bfb

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
Tag name: clm3_expa_55
Originator(s): Peter Thornton
Date: 24 Jan 2006
One-line Summary: Fixes for 13C isotope code, migration from cvs

Purpose of changes:

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
Files modified:
1. CNFireMod.F90
Added initialization of variable mep.

2. CNrestMod.F90
Added EXIT_SPINUP controls on column-level 13C pools

3. C13SummaryMod.F90
Added current and excess maintenance respiration terms to summary MR variable.

4. CNC13FluxMod.F90
Added new routines to calculate 13C fluxes. Litter to column, non-mortality fluxes
at the column level, pft-level gap mortality fluxes, pft and column level fire mortality fluxes,

5. CNEcosystemDynMod.F90
Added calls for C13Flux2, C13Flux3, C13StateUpdate2, and C13StateUpdate3.

6. clm_varcon.F90
Added parameters to define a fixed pre_industrial del13C (set to -6 permil)

Summary of testing:

  bluesky:
  tempest:
  bangkok/lf95:

CLM tag used for the baseline comparison tests if applicable: clm3_expa_40

IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

Changes answers for CN only, and then only for the isotope prognostics.

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
http://www.cgd.ucar.edu/tss/clm/diagnostics/clm3cn/c13/ccsm3_bgc31_I_2a-ccsm3_bgc26_I_1d/setsIndex.html
===============================================================
Tag name: clm3_expa_54
Originator(s): Tony Craig
Date: 17 Jan 2006
One-line Summary: Update infrastructure in support of finemesh, migration from cvs

Purpose of changes: bfb infrastructure changes committed, partial step towards finemesh implementation

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: Some memory added for extra coarse grid, atmosphere domain, as well as changes to interpolation datatypes and code.  Redundant memory deleted from some datasets.

Code reviewed by: Mariana Vertenstein

List all subroutines eliminated: 

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

src/main:
initGridIndexMod.F90,lnd2atmMod.F90,CNiniTimeVar.F90,abortutils.F90,clm_comp.F90,driver.F90,clm_camMod.F90,atmdrvMod.F90,subgridRestMod.F90,accFldsMod.F90,clmtypeInitMod.F90,initializeMod.F90,pftdynMod.F90,iniTimeConst.F90,histFileMod.F90,program_csm.F90,clm_atmlnd.F90,clm_varsur.F90,clm_csmMod.F90,restFileMod.F90,surfFileMod.F90,controlMod.F90,initSurfAlbMod.F90,initSubgridMod.F90,clm_varctl.F90,ndepFileMod.F90,initGridCellsMod.F90,MCT_lnd_comp.F90,program_off.F90,domainMod.F90,decompMod.F90,areaMod.F90,clmtype.F90,histFldsMod.F90

src/riverroute:
RtmMod.F90

src/biogeochem:
CASAMod.F90,DUSTMod.F90,CNPhenologyMod.F90,STATICEcosysDynMod.F90,DGVMMod.F90,CNrestMod.F90,VOCEmissionMod.F90,CNNDynamicsMod.F90,CNVegStructUpdateMod.F90

src/biogeophys:
BalanceCheckMod.F90,SurfaceRadiationMod.F90,SoilTemperatureMod.F90,Biogeophysics1Mod.F90,Biogeophysics2Mod.F90,FrictionVelocityMod.F90,Hydrology1Mod.F90,Hydrology2Mod.F90,BiogeophysicsLakeMod.F90,HydrologyLakeMod.F90,BareGroundFluxesMod.F90,CanopyFluxesMod.F90

bld/offline/tests:
CLM_lab.pm,test_batch.csh
	
tools/mksurfdata:
mkdynpftMod.F90,mkgridMod.F90,shr_timer_mod.F90,mklaiMod.F90,mkglacier.F90,mkurban.F90,fileutils.F90,mksoitex.F90,mkfileMod.F90,domainMod.F90,areaMod.F90,creategridMod.F90,mkvarsur.F90,mksrfdat.F90,nanMod.F90,mklanwat.F90,mksoicol.F90,Makefile,mkpftMod.F90

tools/mkgriddata:
mkvarctl.F90,fileutils.F90,mkgriddata.F90,mkfileMod.F90,domainMod.F90,areaMod.F90,creategridMod.F90,mkvarsur.F90,nanMod.F90,Makefile

Code changes:
Merge atm2lnd_state_type, atm2lnd_flux_type.  Same for lnd2atm state/flux.
  Related changes in clm3 and elsewhere in code.
Add domainMod.F90 and domain_type.  Migrate grid data into domain type.
  Instantiate adomain(atm/coarse), ldomain(lnd/finemesh), rdomain(rtm),
  ddomain(atmdrv external data) in model.
Add lats, latn, lonw, lone 2d arrays and associated code changes.
Cleanup areaMod.F90; merging subroutines, removing redundant code, eliminate
  *_point routines.
Remove numlon
Add decomp_type for gcelldc and gcellsn.  Remove redundant data in other
  arrays related to addressing physical space and logical space.
Clean up interface in set_landunit subroutines.  Remove redundant code.
Clean up procs and clumps datatypes, removing redundant data.
Migrate clm3 topology data to pointers from copies
Add gridmap_type for interpolation and associated code and routines to
  support the type.
Add clm_atmlnd.F90 file for upscale/downscale code.  Add clm_mapa2l
  and clm_mapl2a to carry out mapping associated with upscale/downscale.
Add gridmap_setmapsFM for generation of weights for downscale/upscale
  routines.
forc_ndep should not be in atm2lnd_type.
Reuse code as much as possible throughout.
Update mksurfdata, mkgriddata.  Speed code up, bfb, new fields added,
  new input options for files.  Fill with wetland, add PFTDATA_MASK
  field for real/fake land.
Update code to clm3_expa_53
Rename latixy and longxy to latc and lonc.
Remove fullgrid attribute.

Summary of testing:

  bluesky: full clm test, full cam test
  tempest: full cam test
  bangkok/lf95: full cam test

CLM tag used for the baseline comparison tests if applicable: clm3_expa_53

IF tag changes answers relative to baseline comparison the
following should be filled in:  bfb

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff? bfb

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
	
Tag name: clm3_expa_53
Originator(s): Mariana Vertenstein
Date: Fri Dec.16 2005
One-line Summary: Put in MCT communication for cam-clm coupling

Purpose of changes: removed lp_coupling communication and put in
MCT communication interfaces

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none
	
Describe any changes made to the namelist: none

List any changes to the defaults for the input datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Mariana Vertenstein, Rob Jacob
	
List all subroutines eliminated: none

List all subroutines added and what they do: 
  main/MCT_atmlnd_cpl.F90  
     clm/cam MCT coupling interface - will be moved out of clm code in
     near future	
  main/MCT_lnd_comp.F90
     clm MCT wrapper layer
  main/clm_comp.F90
     module containing wrapper routines that separate clm into chunks of
     code that contain no communication (e.g. clm_run1, clm_run2 has no
     communicaiton). This is needed to satisfy requirement for implementing
     multiple coupling interfaces (e.g. concurrent/MCT, sequential/MCT,
     sequential/ESMF) within ccsm.	
  main/clm_varorb.F90	
     module for orbital parameters 
    (this will be added to program_off.F90 and program_csm.F90)
	
List all existing files that have been modified, and describe the changes:
    clm_camMod.F90 - all coupling still exists here

Summary of testing:
	
  bluesky:
  test-model.pl -res T31      
  test-model.pl -res T31cn    
  test-model.pl -res T31cnall 
  test-model.pl -res T31casa  
  test-model.pl -res T31dgvm  
	
  tempest: No testing

  bangkok/lf95: No testing

CLM tag used for the baseline comparison tests if applicable: clm3_expa_48
  results were bfb with clm3_expa48	
	
IF tag changes answers relative to baseline comparison the
following should be filled in:

  Summarize any changes to answers, i.e.,
    - what code configurations:
    - what platforms/compilers:
    - nature of change (roundoff; larger than roundoff/same climate; new climate): 

   If bitwise differences were observed, how did you show they were no worse
   than roundoff?

   If this tag changes climate describe the run(s) done to evaluate the new
   climate in enough detail that it(they) could be reproduced, i.e.,
   - source tag (all code used must be in the repository):
   - platform/compilers:
   - configuration (CPP ifdefs):
   - build-namelist command (or complete namelist):
   - MSS location of output:

   MSS location of control simulations used to validate new climate:
   
   URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
	
Tag name: clm3_expa_52
Originator(s): Mariana Vertenstein
Date: Tues Dec.12 2005
One-line Summary: Put in scam fix needed in CAM mode

Purpose of changes: clean up svn clm structure

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
None
	
Describe any changes made to the namelist:
None

List any changes to the defaults for the input datasets:
None

Describe any substantial timing or memory changes:
None

Code reviewed by:
Mariana Vertenstein
	
List all subroutines eliminated:
None

List all subroutines added and what they do:
None

List all existing files that have been modified, and describe the changes:
clm_camMod.F90 (this change was put into cam3_2_41)

Summary of testing:
No testing done

CLM tag used for the baseline comparison tests if applicable:
NA
	
IF tag changes answers relative to baseline comparison the
following should be filled in:

Summarize any changes to answers, i.e.,
 - what code configurations:
 - what platforms/compilers:
 - nature of change (roundoff; larger than roundoff/same climate; new climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
 - source tag (all code used must be in the repository):
 - platform/compilers:
 - configuration (CPP ifdefs):
 - build-namelist command (or complete namelist):
 - MSS location of output:

MSS location of control simulations used to validate new climate:

URL for LMWG diagnostics output used to validate new climate:
	
===============================================================
	
Tag name:  clm3_expa_51
Originator(s): mvr
Date: Tues Dec.12 2005
One-line Summary: removed src/utils dir

Purpose of changes: should've been done with external setup in prev tag

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the input datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvr, mvertens

List all subroutines eliminated: 
D      src/utils

List all subroutines added and what they do: 
none

List all existing files that have been modified, and describe the changes:
none
	
Summary of testing:

bluesky: none
tempest: none
bangkok/lf95: none

CLM tag used for the baseline comparison tests if applicable:

IF tag changes answers relative to baseline comparison the
following should be filled in:

Summarize any changes to answers, i.e.,
 - what code configurations:
 - what platforms/compilers:
 - nature of change (roundoff; larger than roundoff/same climate; new climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff? b4b

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
 - source tag (all code used must be in the repository):
 - platform/compilers:
 - configuration (CPP ifdefs):
 - build-namelist command (or complete namelist):
 - MSS location of output:

MSS location of control simulations used to validate new climate:

URL for LMWG diagnostics output used to validate new climate:

===============================================================
Tag name: clm3_expa_50
Originator(s): Mariana Vertenstein
Date: Tues Dec.12 2005
One-line Summary: Updated external definitions for utils

Purpose of changes: clean up svn clm structure

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
None
	
Describe any changes made to the namelist:
None

List any changes to the defaults for the input datasets:
None

Describe any substantial timing or memory changes:
None

Code reviewed by:
NA
	
List all subroutines eliminated:
None

List all subroutines added and what they do:
None

List all existing files that have been modified, and describe the changes:
None

Summary of testing:
No testing done

CLM tag used for the baseline comparison tests if applicable:
NA
	
IF tag changes answers relative to baseline comparison the
following should be filled in:

Summarize any changes to answers, i.e.,
 - what code configurations:
 - what platforms/compilers:
 - nature of change (roundoff; larger than roundoff/same climate; new climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
 - source tag (all code used must be in the repository):
 - platform/compilers:
 - configuration (CPP ifdefs):
 - build-namelist command (or complete namelist):
 - MSS location of output:

MSS location of control simulations used to validate new climate:

URL for LMWG diagnostics output used to validate new climate:

===============================================================
	
Tag name: clm3_expa_49
Originator(s): Mariana Vertenstein
Date: Mon Dec 12 2005
One-line Summary: Updated clm with changes put into cam3_2_38

Purpose of changes:
Cray-X1E OpenMP/CSD compatibility modifications.
	
Bugs fixed (include bugzilla ID): 
None

Describe any changes made to build system:
None	
	
Describe any changes made to the namelist:
None	
	
List any changes to the defaults for the input datasets:
None	
	
Describe any substantial timing or memory changes:
None	
	
Code reviewed by:
Mariana Vertenstein	
	
List all subroutines eliminated:
None
	
List all subroutines added and what they do:
None
	
List all existing files that have been modified, and describe the changes:
- Allowed coexistence of OpenMP and CSD's on Cray-X1E provided they do not operate
  on same loop index
- Removed nested OpenMP capability
	
src/main: 
   areaMod.F90
   driver.F90
   histFileMod.F90
   atmdrvMod.F90
	
src/riverroute: 
   RtmMod.F90
	
tools/mksurfdata
   mkdynpftMod.F90 
   mklaiMod.F90 
   mkpftMod.F90 
   mksoitex.F90
   mkglacier.F90
   mklanwat.F90
   mksoicol.F90
   mkurban.F90
	
Summary of testing:

bluesky:
test-model.pl -res T31      
test-model.pl -res T31cn    
test-model.pl -res T31cnall 
test-model.pl -res T31casa  
test-model.pl -res T31dgvm  
	
tempest: No testing

bangkok/lf95: No testing

CLM tag used for the baseline comparison tests if applicable:
clm3_expa_48 (results were bfb)	
	
IF tag changes answers relative to baseline comparison the
following should be filled in:
	
Summarize any changes to answers, i.e.,
 - what code configurations:
 - what platforms/compilers:
 - nature of change (roundoff; larger than roundoff/same climate; new climate): 
	
If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
  - source tag (all code used must be in the repository):
  - platform/compilers:
  - configuration (CPP ifdefs):
  - build-namelist command (or complete namelist):
  - MSS location of output:
	
MSS location of control simulations used to validate new climate:
	
URL for LMWG diagnostics output used to validate new climate:
	
===============================================================

clm3_expa_48
Originator: forrest (Forrest Hoffman)
Date: Fri Dec  2 06:50:57 MST 2005
Model: CLM
Version: CLM3.expa.48
One-line Summary: Added bug fix for reading TpoolC in CASA, split long line in DGVM, and modified Makefiles for Cray X1E
Requires change in build system: yes
Modified Makefile for the Cray X1E and the newcprnc build
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM (cheetah)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:

1. Fixed TpoolC initialization not to overwrite pools if they were read from
   initial dataset.
2. Split a long line in DGVMEstablishmentMod.F90
3. Updated Makefile for Cray X1E
4. Updated test system for use on Cray X1E and changed netCDF path for ORNL IBM
5. Replaced cprnc.f90 with cprnc.F90 in newcprnc and modified its Makefile to
   use CPP for this file.  NOTE: This was tested only on the IBM and Cray X1E,
   and may require minor Makefile modifications for other platforms.

Ran the following tests on IBM (cheetah):
./test-model.pl -res T31      -c $HOME/CCSM/clm3_expa_47
./test-model.pl -res T31cn    -c $HOME/CCSM/clm3_expa_47
./test-model.pl -res T31cnall -c $HOME/CCSM/clm3_expa_47
./test-model.pl -res T31casa  -c $HOME/CCSM/clm3_expa_47

===============================================================

clm3_expa_47
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Nov 25 10:26:47 MST 2005
Model: CLM
Version: CLM3.expa.47
One-line Summary: updated to wrf esmf time manager interfaces
Requires change in build system: yes
Makefile is modified	
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:
1) Update offline clm to new wrf esmf time manager interfaces.
   This change has already been made in the cam code base.
   This change also implies that the ESMF prototye time manager code
   is no longer needed. The new time manager interfaces are identical
   to the latest ESMF library. 	   
2) Testing done:
   Verified that the following tests passed and were also bfb 
   with clm3_expa_46.
   ./test-model.pl -res T31      
   ./test-model.pl -res T31cn    
   ./test-model.pl -res T31cnall 
   ./test-model.pl -res T31casa  
   Note - CCSM testing with this code base must still be done.	
===============================================================
	
===============================================================

clm3_expa_46
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Nov 11 12:50:40 MST 2005
Model: CLM
Version: CLM3.expa.46
One-line Summary: put in change to csoilc and change in CanopyFluxesMod.F90
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: none
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: Yes (new-physics)
Changes made:

1) The following two coding changes were made
In CanopyFluxesMod.F90

  w = exp(-2*(elai(p)+esai(p)))  
     changed to 
  w = exp(-(elai(p)+esai(p)))

In clm_varcon.F90

   real(r8) :: csoilc = 0.0025   !Drag coefficient for soil under canopy
      changed to 
   real(r8) :: csoilc = 0.004    !Drag coefficient for soil under canopy

2) The following simulation documents the changes 
   (relative to the clm3 release)- see:

http://www.cgd.ucar.edu/ccr/dlawren/research/hydrology/vh_ncs_lai-hyd_cona/sets.htm
	
   hyd_cona  : is the released version of clm3
   vh_ncs_lai: is new hydrology without csoil changes with new lai dataset
	
(contact David Lawrence for more details)	
	
3) No other tests were run since the changes were so straightforward
===============================================================
	
===============================================================

clm3_expa_45
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Oct 26 15:13:28 MDT 2005
Model: CLM
Version: CLM3.expa.45
One-line Summary: updated to share3_051025 and ESMF_0_0_8 and modified clm_camMod.F90
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: yes
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Mat Rothstein
Changes answers: no (bit-for-bit) 
Name of tests cases on NCAR Mass-Store: 
  see following diagnostic output for cam control simulation
	
     /MVERTENS/csm/cam3_2_29_fv4x5dom (cam3_2_29 with changes to clm_camMod.F90)
         vs 
      /MVERTENs/csm/cam3_2_29_cam3_2_29_fv4x5dom_0 (cam3_2_29 with no changes)

      http://www.cgd.ucar.edu/~mvertens/AMWG_diag/cam3229_fv4x5dom-cam3229_fv4x5dom_0/
         and also comparison relative to last fv control run done:
      http://www.cgd.ucar.edu/~mvertens/AMWG_diag/cam3_2_29_fv4x5dom-cam321_fv4x5dom_1

1)Modified clm_camMod.F90 so that cam and clm grid do not have to be bfb. 
  The tolerance is that the grid latitudes/longitudes grids match to 1.e-12. 
o  The fractional land however, must be identical.
2) updated csm_share to share3_051025 (this removes need for autopromotion)
   in share code and modified clm Makefiles to remove autopromotion	
3) updated esmf prototype code to ESMF_0_0_8	
4) Testing done (following tests passed successfully)
 ./test-model.pl -res T31cnall -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_44
 ./test-model.pl -res T31      -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_44
 ./test-model.pl -res T31cn    -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_44
===============================================================
	
===============================================================

clm3_expa_44
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Oct 17 09:49:04 MDT 2005
Model: CLM
Version: CLM3.expa.44
One-line Summary: fixed bug in initializeMod.F90 for linux systems
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: yes
Machines tested: IBM, SGI, Linux
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:
1) Fixed bug in initializeMod.F90 so that all cam tests could
   pass on linux platform. This was done as part of the cam3_2_28
   checkin.	
	
===============================================================
===============================================================

clm3_expa_43
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Oct 13 20:25:37 MDT 2005
Model: CLM
Version: CLM3.expa.43
One-line Summary: put in fixes to get all cam tests working and bfb with basline cam
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: yes
Machines tested: IBM, SGI, Linux
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:
1) Put in changes to cam_clmMod.F90 to reset the clm grid
to the cam grid. This was done to ensure bfb answers. Given
the number of interface changes that went into clm3_expa_42,
it seemed that isolating the effects of permitting clm to have
a grid that was roundoff level different should be done.
Only a few lines of code need to be changed in order to remove
this restriction. A climate simulation will be done to verify
the effect of permitting grid independence to the roundoff level.
2) Put in fixe to restFileMod.F90 to get cam branch test to
work on tempest.
3) Files changed:
   clm_camMod.F90
   inicFileMod.F90
   restFileMod.F90
4) Testing done - ran cam test-driver.sh with cam3_2_25 and clm3_expa_43 
on bluesky, tempest and bangkok with BL_ROOT=cam3_2_24.	All tests passed
successfully.	
===============================================================
	
===============================================================

clm3_expa_42
Originator: mvertens ( Mariana Vertenstein)
Date: Tue Oct 11 09:21:49 MDT 2005
Model: CLM
Version: CLM3.expa.42
One-line Summary: put in changes to remove need for autopromotion of floats
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: yes
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Changes made:

1) Nearly every file in CLM was modified in order to 
explicitly type variables and constants in order to 
enable the removal of autopromotion of reals in the Makefile.
Note that this change was already incorporated into the clm
version corresponding to cam3_2_23.

Tom Henderson's tool "addrealkind" was used to change "real"
declarations to "real(r8)" and to add "_r8" to all floating
point constants that were not already typed. These changes
were not incorporated into csm_share or utils/esmf.

2) Updated clm_camMod.F90 so that it was consistent with cam3_2_23.
Put in a tentative change to clm_cam_CheckGrid routine so that
BFB changes with the current version of cam could be produced.
Effectively, the cam grid still overrides the clm grid, even
though the differences in the grids were only on the order of
1.e-13 for latitudes (no differences in longitudes). A climate simulation
will have to be done to verify that making the grids independent does
not change the climate.

3) Testing done	
   Ran the following tests successfully:	 
 ./test-model.pl -res T31cnall -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_41
 ./test-model.pl -res T31      -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_41
 ./test-model.pl -res T31cn    -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_41
 ./test-model.pl -res T31casa  -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_41
 ./test-model.pl -res T31dgvm
===============================================================
	
===============================================================

clm3_expa_41
Originator: mvertens ( Mariana Vertenstein)
Date: Sun Oct  2 12:51:03 MDT 2005
Model: CLM
Version: CLM3.expa.41
One-line Summary: changed and simplified clm/cpl6 initializaiton
Requires change in build system: no
Tested to work coupled with CCSM: yes (Tony Craig)
Tested to work with CAM: no
Machines tested: IBM, SGI
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Tony Craig
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:
	
1) CLM/CPL6 initialization has been changed so that clm no longer
receives the grid and landfrac/landmask from the coupler, but rather
reads it in from its surface dataset and sends it to the coupler.
The coupler in turn then checks for consistency between the land/atm
grid and the land fractions received.
As part of this, an offline tool has now been constructed by Tony
Craig that will generate the landfrac and grid appropriate for running
on a given ocn/atm resoloution. CLM now no longer will permit fsurdat
to be set to blanks.	
The following files were modified:
    main/clm_csmMod.F90
    main/driver.F90
    main/program_csm.F90
    main/histFileMod.F90	
    biogeochem/DGVMMod.F90	

2) tools/mksurfdata has been modified so that grids can only be
   read in for the purposes of generating surface datasets. A
   new directory - tools/mkgriddata - has been created to enable
   the generation of regular offline clm grids. The functionality
   of grid generation and surface dataset generation has thereby
   been separated. There are complete README files in both directories
   that specify the new namelist settings for generating surface
   datasets and grids.	
	
3) Testing done:
   ran test-model.pl -c clm3_expa_40 and verifed that results were
   bfb in the default non-CN case. Further testing in coupled mode
   will be done by Tony Craig.
	
===============================================================
===============================================================

clm3_expa_40
Originator: jeff ( Yen-Huei Lee)
Date: Thu Sep 29 15:26:28 MDT 2005
Model: CLM
Version: CLM3.expa.40
One-line Summary: bug fix restFilemod.F90
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Compaq
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:

 

===============================================================
===============================================================
clm3_expa_39
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Sep  9 13:55:43 MDT 2005
Model: CLM
Version: CLM3.expa.39
One-line Summary: made restart files netcdf
Requires change in build system: no
Tested to work coupled with CCSM: yes
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:
	
1) Made all restart data netcdf - EXCEPT for history file restarts
   (this still binary - they are used for restart runs only, not for branch runs).
   The effect of this change is that inicFileMod.F90 now only contains code for
   doing perpetual runs in CAM mode.
   Initial files and restart files are still written - but they are the same - 
   ****EXCEPT FOR THE TIME STEP AT WHICH THE ARE OUTPUT***.

   In the current code, the restart file
        casename.clm2.r.1998-01-01-00000.nc
   is written on model date 1998-01-01-00000, whereas the initial file
        casename.clm2.r.1998-01-01-00000.nc 
   is written on model date 1997-12-31-84600 

   There is a fundamental difference between restart runs and initial runs in clm.
   On a restart run (assuming 1800 sec time steps), the restart file 
        casename.clm2.r.1998-01-01-00000.nc
   will be used to determine the time step 
        1998-01-01-01800 
   whereas on an initial run the same restart file (for this tag) will be 
   used to determine the timestep
        1998-01-01-00000
   This is because the restart code increments the time step as part 
   (by calling advance_timestep()) as part of the time manager initialization.
   Note that when running in OFFLINE mode, clm also increments the time step
   for an initial run, so that all initial runs start at time step 1. In 
   CAM and CSM mode, all initial runs start at time step 0. 

   -----------------------------------------------------------------
   THE FOLLOWING THINGS ARE IMPORTANT TO NOTE:
   -----------------------------------------------------------------

   o) initsurfalb will be called either when nsrest is 0 if:
      - finidat = ' ' 
      - finidat /= ' ' and albd and albi are not on the initial (or restart) dataset

   o) restart and initial datasets can now be used interchangeably to start up a run
      Assuming you wanted to start up a run at 1998-01-01-00000 from another run
      with case "casename"
      a) Initial runs: finidat should point to 
        - the restart dataset casename.clm2.r.1998-01-01-00000.nc in OFFLINE mode
          (this would have been written out at 1999-01-01-00000)
        - the initial dataset casename.clm2.i.1998-01-01-00000.nc in CAM or CSM mode
          (this would have been written out at 1997-12-31-84600)
      b) Branch runs: nrevsn should point to 
        - the resart filename (CURRENTLY WITHOUT the .nc suffix)
         (this was done to maintain backwards compatibility) 

   o) The current code base is completly backwards compatible with older versions
      of the code in terms of doing intitial runs. It is NOT backwards compatible with restart
      files produced by older versions of the code. 

2) The following routines were changed.

      biogeochem/CNrestMod.F90         (added)
      biogeochem/DGVMMod.F90
      biogeochem/DGVMRestMod.F90
      biogeophys/BiogeophysRestMod.F90 (added)
      main/CNrestMod.F90               (removed)
      main/abortutils.F90
      main/accFldsMod.F90
      main/accumulMod.F90
      main/Attic/clm_camMod.F90
      main/clm_csmMod.F90
      main/controlMod.F90
      main/driver.F90
      main/histFileMod.F90
      main/Attic/histFldsMod.F90
      main/inicFileMod.F90
      main/Attic/initSurfAlbMod.F90
      main/initializeMod.F90
      main/Attic/ncdio.F90
      main/program_csm.F90
      main/program_off.F90
      main/restFileMod.F90
      main/subgridRestMod.F90           (added)
      main/Attic/time_manager.F90
      riverroute/RtmMod.F90
      riverroute/Attic/RunoffMod.F90

3) The automated tests were modified to now run both CASA and DGVM.
   (A new DGVM control run needs to be performed).
   Ran the following tests successfully:

  Offline:
  -------------------
  ./test-model.pl -res T31cnall -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_38
  ./test-model.pl -res T31      -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_38
  ./test-model.pl -res T31cn    -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_38
  ./test-model.pl -res T31casa  -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_38
  ./test-model.pl -res T31dgvm  

  Note that ./test-model.pl -res T31cnall now points to finidat obtained from the CCSM
  BGC case ccsm3_bgc19_F_2: ccsm3_bgc19_F_2.clm2.i.1900-01-01-00000.c050905.nc
  This initial dataset does not contain all the information that an initial dataset 
  produced by clm3_expa_19 would have. 

  CCSM:
  -------------------
  Checked out two versions of the ccsm tag ccsm3_0_brnchT_bgc19 tags and updated
  the clm version in one checkout to clm3_expa_38 and the other to clm3_expa_39.
  Created two test cases 
        ccsm3_bgc19_F_2_mod1 - used ccsm3_0_brnchT_bgc19 with clm3_expa_38 clm
        ccsm3_bgc19_F_2_mod2 - used ccsm3_0_brnchT_bgc19 with clm3_expa_39 clm
  Verified that running the output after a month was bfb with the two cases.
  (Note that ccsm3_bgc_19 will not give bit-for-bit with 
  ccsm3_0_brnchT_bgc19 with clm3_expa_38 clm - this needs to be looked into).
  Also verified that ccsm3_bgc19_F_2_mod2 gave bfb restarts (ran 1 month, restarted
  and ran another month).
      	
	
===============================================================
===============================================================

clm3_expa_38
Originator: thornton ( Peter Thornton)
Date: Wed Aug 17 10:21:19 MDT 2005
Model: CLM
Version: CLM3.expa.38
One-line Summary: Added C13 isotopes to CN code
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Neil Suits
Changes answers: the non-isotope results are bit-for-bit against clm3_expa_37, 
	except that the variable xsmrpool has been added as a new carbon state
        variable, replacing some of the functionality of the cpool variable.
        So comparisons against clm3_expa_37 will differ in cpool, but this 
        does not change the behavior of the rest of the prognostic pools. 
Changes made:
This work was carried out by Peter Thornton and Neil Suits over multiple
working sessions during summer 2005. 
The following files were modified to include C13 isotopes:
 1. biogeochem/CNAllocationMod.F90
 2. biogeochem/CNBalanceCheckMod.F90
 3. biogeochem/CNCStateUpdate1Mod.F90
 4. biogeochem/CNDecompMod.F90
 5. biogeochem/CNEcosystemDynMod.F90
 6. biogeochem/CNPrecisionControlMod.F90
 7. biogeochem/CNSetValueMod.F90
 8. biogeochem/CNSummaryMod.F90
 9. biogeochem/C13SummaryMod.F90
10. biogeochem/CNC13FluxMod.F90
11. biogeochem/CNC13StateUpdate1Mod.F90
12. biogeochem/CNC13StateUpdate2Mod.F90
13. biogeochem/CNC13StateUpdate3Mod.F90
14. biogeophys/BareGroundFluxesMod.F90
15. biogeophys/CanopyFluxesMod.F90
16. csm_share/shr/shr_const_mod.F90
17. main/CNiniSpecial.F90
18. main/CNiniTimeVar.F90
19. main/CNrestMod.F90
20. main/atmdrvMod.F90
21. main/clm_camMod.F90
22. main/clm_csmMod.F90
23. main/clm_varcon.F90
24. main/clmtype.F90
25. main/clmtypeInitMod.F90
26. main/histFldsMod.F90

The overall logic was to add new instances of the carbon state and carbon flux
derived types at the pft and column level to hold the c13 variables.
Discrimination is calcualted in CanopyFluxes(), and the state variable update
routines are based on the C13/(C13+C12) ratios for the upstream pools.  There
is now a C13 state and C13 flux associated with each of the origianl C state
and C flux variables. A number of new pps and pepv variables have also been
added as diagnostics for the C13 discrimination during assimilation.

This code passed the clm offline test suite as:
test-model.pl -res T31 -c clm3_expa_37
whith the caveat as above for bfb comparisons against expa_37 for cpool.

 
===============================================================
===============================================================

clm3_expa_37
Originator: thornton ( Peter Thornton)
Date: Thu Aug 11 12:37:40 MDT 2005
Model: CLM
Version: CLM3.expa.37
One-line Summary: CN hydrology mods and a few other C4MIP mods
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit:yes 
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Yes for CN, no for non-CN
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:
1. Added CN control in CanopyFluxesMod.F90 to use the original formulation for local variable w in calculation of csoilcn.
2. Added CN control in clm_varcon.F90 to use original value of csoilc (0.004)
3. Added CN control to SurfaceRunoff() in SoilHydrologyMod.F90 to eliminate the use of infiltration enhancement factor.
4. Modified CNFireMod.F90 to set the number of steps for fire period averaging to its maximum value from the start of the run. Avoids transient fire algorithm behavior at the start of a new run launching from spun-up initial conditions.

Tested with: 
test-model.pl -res T31cnoff -c clm3_expa_36 (passed)
test-model.pl -res T31 (passed)


===============================================================
===============================================================

clm3_expa_36
Originator: forrest (Forrest Hoffman)
Date: Thu Jul 21 13:26:51 MDT 2005
Model: CLM
Version: CLM3.expa.36
One-line Summary: Modified PLAI and PET calculations in CASA' and made minor bug fixes
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: yes, on Cray X1E (phoenix)
Tested to work with CAM: no
Machines tested: IBM (cheetah)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Yes for CASA' only (same-physics)
Name of tests cases on NCAR Mass-Store:
Changes made:

1. Fix PLAI calculation in CASA'
   Added an initialization of stress factors in CASAPhenology for every
   timestep.
2. Fix PET calculate in CASA'
   Changed surface pressure variable used to forc_pbot which is required for
   CCSM configuration.  Moved the call to CASAPot_Evptr back down into casa()
   subroutine because of a bug on the Cray X1E which caused crashes in some
   configurations.
3. Moved calculation of watopt, watdry, sz, watoptc, watdryc, and szc for
   CASA' to initCASA() since they need to be calculated only once.
4. Removed nstep>1 requirement for CASA' routines by moving them to a later
   stage in driver (after Biogeophysics2).
5. Moved a vector directive in CASAMod.
6. Broke two long lines (write statements) in clm_csmMod which cause problems
   for the Cray compilers.
7. Replaced the second t_startf() around the call to driver2() in program_csm
   to a t_stopf().

Ran test-model on IBM (cheetah) for T31cnoff, T31cnoffallpfts, T31, and
T31allpfts.

===============================================================
===============================================================

clm3_expa_35
Originator: mvertens ( Mariana Vertenstein)
Date: Tue May 31 11:25:06 MDT 2005
Model: CLM
Version: CLM3.expa.35
One-line Summary: bug fixes 
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: yes
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: kyesno
Code reviewed by: myself
Changes answers: no (bit-for-bit) (see below)
Changes made:
1) clm_csmMod.F90 - changed error check for differences in landfrac to
   not stop if differences are greater than 1.e-12 and the landfrac is
   smaller than 1.e-8.
2) clm_camMod.F90 - replaced all_to_all with all2all in lp_coupling
   subroutines due to character length limitations of subroutine names
   on sgi (tempest)
3) iniTimeConst.F90, surfFileMod.F90 - put in bug fixes for SCAM mode 
4) mkarbinitMod.F90 - put in bug fix for soilpsi calculation that
   only occurs for CN mode
5) modified many of the  routines in tools/mksurfdata so that lsmlon
   and lsmlat are no longer parameters - but are read dynamically
   from the input grid file
6) Testing done:
   Successfully ran
   test-model.pl -res T31cnoff   -c clm3_expa_34 (bfb)
   test-model.pl -res T31        -c clm3_expa_34 (only difference was SOILPSI)
   test-model.pl -res T31allpfts -c clm3_expa_34 (only difference was SOILPSI)
===============================================================
	
===============================================================

clm3_expa_34
Originator: thornton ( Peter Thornton)
Date: Tue May 24 14:29:04 MDT 2005
Model: CLM
Version: CLM3.expa.34
One-line Summary: Limit on negative N leaching, fix units for NEE to coupler
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Compaq
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself, Jeff Lee
Changes answers: Yes (new-physics)
Changes made:
1. Added a new limit in CNNDynamicsMod.F90, CNNLeaching(), to prevent 
   negative sminn_leached fluxes.
2. Added a new conversion in clm_csmMod.F90 to put the NEE flux sent
   to the coupler from gC/m2/s to kg CO2/m2/s.
===============================================================
===============================================================
clm3_expa_33
Originator: mvertens ( Mariana Vertenstein)
Date: Wed May 11 21:07:39 MDT 2005
Model: CLM
Version: CLM3.expa.33
One-line Summary: made driver.F90 into a module with two run phases
Requires change in build system: no
Tested to work coupled with CCSM: yes (see below)
Tested to work with CAM:  yes (see below)
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit) (offline) or Yes (same-to-roundoff) (cam, ccsm)
Changes made:
	
1) modified driver.F90 so that it is not a module containing
   subroutines driver1 and driver2. This is a step necessary to make
   clm an ESMF gridded component. The commmunication calls in CCSM
   mode have now been moved out of driver and into program_csm.F90.
   Routine driver1 contains the code executed between the CCSM send
   and receive calls. Routine driver2 contains the history and restart
   updates, as well as calls to the DGVM and RTM drivers (if the CPP
   tokens are defined). This involved mods to program_off.F90,
   program_csm.F90 and clm_camMod.F90.

2) modified the interface to initialize and driver so that declination
   angles and calendar day were passed in (caldayp1, declinp1) rather
   than the orbital parameters (eccen, obliqr, lambm0, mvelpp). This
   also involved mods to SurfaceAlbedo.F90 and DGVMMod.F90.

3) modified clm_camMod.f90 and program_csm.F90 so that the grid
   received from cam or the coupler would no longer overwrite the clm
   grid if differences were less than 1.e-6. Now, if differences in
   the corresponding grids are greater than 1.e-6, the model will
   stop, otherwise, the clm grid read in will be used. This leads to
   round-off level differences in cam and clm compared to the case when
   the grids were over-written.

4) Modifed clm_varsur.F90 so that external grid information was
   removed and moved to the appropriate component model.

5) Summary of modified files:
   biogeochem/DGVMMod.F90,v
   biogeophys/SurfaceAlbedoMod.F90,v
   main/clm_camMod.F90,v
   main/clm_csmMod.F90,v
   main/clm_varsur.F90,v
   main/driver.F90,v
   main/initSurfAlbMod.F90,v
   main/initializeMod.F90,v
   main/program_csm.F90,v
   main/program_off.F90,v
   main/surfFileMod.F90,v

6) Summary of testing done:

   offline testing (on bluesky - ran following tests successfully):
     test-model.pl -res T31cnoff        -c clm3_expa_31
     test-model.pl -res T31             -c clm3_expa_31
     test-model.pl -res T31allpfts      -c clm3_expa_31

   cam3_1_7 with (clm3_expa_32 with above mods): on bluesky ran
     test_driver.sh successfully and showed that results were only to
     roundoff when compared with cam3_1_7 run with clm3_expa_29

   ccsm3_0_brnchT_bgc10 with (clm3_expa_32 with above mods) on bluesky
     showed that TER.TER.01a.T31_gx3v5.I.bluesky32 passed and that
     results were only different to roundoff when compared to
     ccsm3_0_brnchT_bgc10.
	
===============================================================
===============================================================

clm3_expa_32
Originator: thornton ( Peter Thornton)
Date: Tue May 10 14:16:45 MDT 2005
Model: CLM
Version: CLM3.expa.32
One-line Summary: Mod to Surface Radiation to avoid divide-by-zero under dynamic pft
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself, Sam Levis, Mariana Vertenstein
Changes answers: no (bit-for-bit) 
Changes made:
1. A one-line change to SurfaceRadiationMod.F90, adding a new test on gdir(p)
   > 0.0 in block to assess sunlit and shaded lai.  Corrects a divide-by-zero
   problem encountered under dynamic PFTs with diagnostic (default) canopy
   model.

===============================================================
===============================================================

clm3_expa_31
Originator: thornton ( Peter Thornton)
Date: Mon May  9 12:45:03 MDT 2005
Model: CLM
Version: CLM3.expa.31
One-line Summary: migrate CN mods for C4MIP to head of branch
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit:yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers:non-CN is BFB w/ 29, CN has new physics
Changes made:
1. Mods in CNDecompMod.F90 to implement accelerated decomposition spinup
   algorithm. Also required some mods in restart read in CNrestMod.F90.
2. Mods in CNNDynamicsMod.F90 to implement new N fixation algorithm.
3. Setting the CN default CO2 concentration to the C4MIP spinup value, in 
   clm_varcon.F90.
4. Mods in surfFileMod.F90 to test for deciduous temperate types in the
   tropics, under allpfts mode.
5. Using the CLM algorithm for rresis in CanopyFluxesMod.F90, instead of
   the LSM algorithm that was introduced at tag clm3_expa_27.
6. Adopting the mods for csoilc (the mid-point mods from clm3_expa_29) for
   use in CN.
7. Adopting the surface runoff treatment introduced by David Lawrence in
   clm3_expa_27 for use in CN.  THis is slightly different than the version
   used in clm3_expa_23.
8. Passed offline test-model suite for res: T31cnoff (BFB w/ expa_29), 
   T31allpfts, and T31. 

===============================================================
===============================================================

clm3_expa_30
Originator: thornton ( Peter Thornton)
Date: Sun May  8 23:20:27 MDT 2005
Model: CLM
Version: CLM3.expa.30
One-line Summary: merge CN mods for C4MIP to head of branch
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Changes are BFB in non-CN mode, new physics in CN mode.
Changes made:
1. Due to a tagging error, clm3_expa_30 is identical with clm3_expa_29.
===============================================================
===============================================================

clm3_expa_29
Originator: mvertens ( Mariana Vertenstein)
Date: Wed May  4 14:05:30 MDT 2005
Model: CLM
Version: CLM3.expa.29
One-line Summary: incorporated csoilc changes provided by David Lawrence
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: None
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself, Peter Thornton
Changes answers: Yes (new-physics)
Changes made:
In clm_varcon.F90 changed
   old: real(r8) :: csoilc = 0.001    !Drag coefficient for soil under canopy [-]
   new: real(r8) :: csoilc = 0.0025   !Drag coefficient for soil under canopy [-]

In CanopyFluxesMod.F90 changed
   old: w = exp(-3._r8*(elai(p)+esai(p)))
   new: w = exp(-2._r8*(elai(p)+esai(p)))
===============================================================
	
===============================================================

clm3_expa_28
Originator: mvertens ( Mariana Vertenstein)
Date: Wed May  4 13:08:48 MDT 2005
Model: CLM
Version: CLM3.expa.28
One-line Summary: updated code to have different soil colors classes dependent on surface dataset
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Keith Oleson, Peter Thornton
Changes answers: no (bit-for-bit)
Changes made:
1) modified clm_varpar.F90, clm_varcon.F90 and iniTimeConst.F90 so that new and 
   old soil color classes could be used
2) modified pftdynMod.F90 to fix bug
3) modified initialize.F90 in order for CNiniTimeVar to always be called.
   (this fixes a qflx_drain not initialized problem that occured when initial files were read)
4) modified RtmMod.F90 to set tempgp and fluxout at ghost latitudes (0 and rtmlat+1) to zero.
   Thise setting assumes that the river routing data has no communication across the
   poles - this is true for the river routing file rdirc.05.
5) modified tools/mksrfdata code so that it could generate either new or old soil color classes
   based on input from raw datasets
6) changed testing scripts so that T31 tests would be done by default
7) following tests were run
   ./test-model.pl -res T31        -c clm3_expa_27
   ./test-model.pl -res T31cnoff   -c clm3_expa_27
   ./test-model.pl -res T31allpfts -c clm3_expa_27
===============================================================
	
===============================================================

clm3_expa_27
Originator: thornton ( Peter Thornton)
Date: Tue Apr 26 14:29:20 MDT 2005
Model: CLM
Version: CLM3.expa.27
One-line Summary: Mods to make sun/shade canopy and soil hydrology changes the default
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no 
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, David Lawrence
Changes answers: Yes (new-physics)
Changes made:

1. Removed old SurfaceRadiation(), and moved SurfaceRadiationSunShade() 
   to SurfaceRadiation() as the new default subroutine.  Eliminated SUNSHA cpp
   directive.
2. Removed old Stomata() and moved StomataCN() to Stomata() as the new default
   subroutine.  Eliminated STOMATA2 cpp directive.
3. Changed the default treatment of BTRAN to the LSM approach, and added watdry
   and watopt as new variables in data structure.  This was part of the suite of
   changes recommended by David Lawrence.
4. Made the simple canopy interception correction suggested by Thornton the
   default behavior (new_fpi = old_fpi * 0.25)
5. Modified csoilcn to reduce ground evaporation under canopies, as suggested
   by David Lawrence.
6. Modified drainage() to eliminate drainage from mid-layer soils, both wet
   and dry.
7. Eliminate exponential decrease in saturated hydraulic conductivity (hksat)
   with depth, change in iniTimeConst().
8. Modify surface runoff from dry soils, introducing a function of rooting
   fraction in the top three layers. Change recommended by David Lawrence.
9. Testing done: The following tests all passed:
	test-model.pl -res T42
	test-model.pl -res T42allpfts
	test-model.pl -res T42cnoff
10. These changes were also compared with the earlier simulations done by David
   Lawrence and Peter Thornton, and found to give consistent results. 
	
===============================================================
===============================================================
clm3_expa_26
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Apr 22 10:47:01 MDT 2005
Model: CLM
Version: CLM3.expa.26
One-line Summary: updated to new timing library
Requires change in build system: no
Tested to work coupled with CCSM: yes
Tested to work with CAM: yes (with cam interface changes)
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:
1) Code Changes
utils/timing
   - uptdated to new timing library changes put in by Jim Rosinski
clm_camMod
   - removed parallel and streaming directives which should not be in clm-model interfaces
     (these were removed from the clm_csmMod.F90 as well)
   - moved call to radiation_get from initext.F90 to here to keep the interface simple
   - removed orbital parameters from the clm_camRun interface to keep the interface simple
clm_varcon, iniTimeConst
   - made albdry, albsat allocatable arrays and initialized them in iniTimeConst
     depending on the presence and value of mxsoil_color in the input surface dataset
controlMod, clm_varctl
   - removed csm_dtime
   - removed local time_manager variables for COUP_CAM mode and only permitted those
     to be in the namelist when running through COUP_CSM or OFFLINE mode (only local varialbe
     dtime was kept)
   - removed allocate_all_vegpfts, rank_veg_pfts as a namelist variables
     ***when maxpatch_pft is set to numpft+1 then allocate_all_vegpfts is always true***
   - removed all msrf_***_*** namelist variables
program_off, program_csm
   - removed old copyright notice
   - put in changes to be compatible with new timing library
restFileMod
   - removed get_nstep for COUP_CAM mode
   - removed csm_dtime
surfFileMod
   - put in changes of fullgrid that were introduced in cam3_0_28 to work with reduced grid
   - removed rank_veg_pfts logic and introduced allocate_all_vegpfts

2) Updated test-model.pl related code to correspond to above changes

3) Testing done
   Ran following tests successfully on bluesky:
     test-model.pl -res T42        -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_25
     test-model.pl -res T42allpfts -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_25
     test-model.pl -res T42cnoff   -c /fis/cgd/cseg/people/mvertens/src/clm/clm3_expa_25
   Ran cam testing suite on bluesky and bankgok with cam interface changes
   and this code and all tests successfully passed
===============================================================
	
===============================================================

clm3_expa_25
Originator: forrest (Forrest Hoffman)
Date: Wed Mar 30 23:47:17 MST 2005
Model: CLM
Version: CLM3.expa.25
One-line Summary: CASA' bug fixes and Cray X1 changes
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM (cheetah) and x86 Linux (anchorage)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:

Modified jobscript.csh to add selection of Programming Environment for Cray X1
and to support cross compiling.

Modified test_batch.csh to add selection of Programming Environment for Cray X1.

Fixed minor bugs in CASA' code and added co2flux variable and history field
in the CASA configuration for flux to the atmosphere (instead of re-using the
fco2 variable).

Removed CSDs around the allocation loop in filterMod.F90.

Ran test-model on IBM (cheetah) and x86 Linux (anchorage); bit-for-bit with clm3_expa_24.

===============================================================
===============================================================

clm3_expa_24
Originator: jeff ( Yen-Huei Lee)
Date: Fri Mar 18 11:01:33 MST 2005
Model: CLM
Version: CLM3.expa.24
One-line Summary: pass co2 flux to atm
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Compaq
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:

M /src/main/clm_csmMod.F90
M /src/main/lnd2atmMod.F90

        (Put your detailed description of the changes you made here...)
       (You will get your edited copy e-mailed to you.)

===============================================================
===============================================================

clm3_expa_23
Originator: thornton ( Peter Thornton)
Date: Thu Mar 10 11:32:02 MST 2005
Model: CLM
Version: CLM3.expa.23
One-line Summary: CLM Coupling mods to pass CO2 to CLM from CAM, through cpl6
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: yes
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: Jeff Lee, Mariana Vertenstein, myself
Changes answers: no (bit-for-bit)
Changes made:

Modifications to allow passing CO2 concentration from CAM to CLM, through cpl6, in CCSM coupled mode.
1. new namelist variable in CLM: co2_type.  'constant' = use co2 value from clm_varcon.F90.  'diagnostic' = use co2 concentration passed from CAM in the co2_diag field.  'prognostic' = use CO2 concentration passed from CAM in the co2_prog field.  both co2_diag and co2_prog are 2d fields.
2. modifications to the communications code that allows passing the new fields in from CAM.
3. Tested for BFB against clm3_expa_22.

===============================================================
===============================================================

clm3_expa_22
Originator: thornton ( Peter Thornton)
Date: Fri Mar  4 14:29:36 MST 2005
Model: CLM
Version: CLM3.expa.22
One-line Summary: Changes to soil hydrology to improve plant water availability for CLM-CN
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Yes (new-physics)
Changes made:
1. Removed exponential decrease in saturated hydraulic condicutivity with depth (modified iniTimeConst.F90)
2. Set smpmax = -2.57e5 (=-2.5Mpa) in clmtypeInit.F90, to better agree with the observed soil water potential at stomatal closure for most trees and grasses.  The original value was -1.55e5 (=-1.5MPa), which is a wetter soil than is observed to cause complete stomatal closure for most species.  The new value is still not negative enough for drought-tolerant species like semiarid shrubs.
3. Modified the qflx_over (surface runoff) term, keeping the components unchanged that relate to impermeable and saturated soils, but turning off this flux entirely for unsaturated soils.
4. Modified the qflx_drai (drainage flux) term (in SoilHydrology) to turn off the mid-layer drainage for both saturated and unsaturated fractions.  Remaining drainage terms are for drainage out of the bottom soil layer, and for drainage in excess of saturation in any layer.
5. Changed the implementation of rooting distribution from exponential to linear, with a bottom layer specified differently for woody and non-woody vegetation.  Woody vegetation is now set to decrease rooting distribution linearly with depth, ending at zero rooting for the bottom of the last soil layer.  Non-woody vegetation also decreases rooting distribution linearly with depth, ending at zero distribution at the bottom of layer 8 (of 10).  This gives a bottom for woody vegetation at 3.43 m, and a bottom for non-woody vegetation at 1.38 m.  THis change improves the access of both trees and grasses to water in deeper soil layers, compared to the original exponential depth distribution.

===============================================================
===============================================================

clm3_expa_21
Originator: thornton ( Peter Thornton)
Date: Fri Feb 18 12:42:48 MST 2005
Model: CLM
Version: CLM3.expa.21
One-line Summary: Mods in prep for C4MIP runs: dynamic N deposition, changed N fixation, moved order of calls in driver
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Yes (new-physics)
Changes made:
1. Implemented dynamic N deposition through single netcdf file with annual
timeseries.  Turn on with namelist variable fndepdyn = <filename>
2. Moved call to EcosystemDyn to the end of the timestep in driver, before mass balance checks, which are before Surface Albedo.  This changes answers slightly
because soil temperature is used in CNEcosystemDyn, and is being updated in
Biogeophysics2, which used to be called after ecosystemdyn, but is now called
before. No compelling science reason for doing this one way vs the other,
but doing it this way cleans up the order of calls in driver.
3. Moved the initialization of mass balance checking to the front of the
timestep, for C and N, which was done for water in expa_17.  This is in prep
for dynamic shifting of C and N mass due to dynamic landcover information.
Note that this code does not yet implement the C and N mass shifting required 
for mass balance under dynamic pft weight.  THat will come in my next tag.
4. Modified N fixation to use a siongle global constant instead of relating
it to NPP.  This speeds up the spinup, but it leaves unresolved the problem of
hpw to dynamically estimate a value for Nfix.
5. Modified tools/mksurfdata/mkpftMod.F90 to remove the commenting around the
complete PFT list that I had put in during testing for expa_17.  This will only 
affect use of the offline tool for creating new surface datasets.

Testing done:
ran test-model on bluesky (IBM).
Did extensive testing for restart and MPI/OMP configurations with the
dynamic N deposition capability.
===============================================================
===============================================================

clm3_expa_20
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Feb 10 15:14:44 MST 2005
Model: CLM
Version: CLM3.expa.20
One-line Summary: 
Requires change in build system: no
Tested to work coupled with CCSM: yes
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit) (yes for CCSM relative to clm3_expa_19)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:
1) Put in changes from clm3_expa_16->clm3_expa_17 for clm_clmsMod.F90 back -
   these changes were inadvertently removed in clm3_expa_18	  
2) Testing done:
   Checked out ccsm3_0_brnchT_bgc1 and used clm code from
   clm3_expa_17 and clm3_expa_20 for tests
   verified that TER.01a.T31_gx3v5.I.bluesky
   was bfb when	clm3_expa_20 code and clm3_expa_17 code 
   was used for clm (note that when using clm3_expa_17 code, 
   cpl_fields_mod.F90 from ccsm3_0_1_beta03 had to be used for the test)	
	
===============================================================
===============================================================

clm3_expa_19
Originator: forrest (Forrest Hoffman)
Date: Mon Jan 31 10:09:45 MST 2005
Model: CLM
Version: CLM3.expa.19
One-line Summary: Changes for CASA model version and vector mods for recent code changes
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM (cheetah), x86 Linux (anchorage)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:

Changes for CASA model version and vector mods for recent code changes

CASA-related changes:
1. Added pft-level clayfrac(:) variable which, like sandfrac(:), contains
   the first level clay fractions.  These are now set in iniTimeConst for
   all pfts since the sand3d(i,j,l) and clay3d(i,j,l) variables from which
   they are obtained are local to that subroutine.
2. Moved call to pftdyn_wbal_init() outside ifdef so that column-level
   h2ocan_loss(:) is initialized in all configurations since it is always
   used in Hydrology1Mod.F90.
3. Removed CASA from ifdef line so that water balance routines are
   performed in the CASA configuration with dynamic landuse.

Vector and performance mods:
1. Removed loop exits in BalanceCheckMod.F90 which prevented
   vectorization.
2. Modified filter construction loop in SurfaceAlbedoMod.F90 for
   vectorization.
3. Added vector directives for filter loop recently added to filterMod.F90
4. Added OpenMP and Cray Streaming directives to loop over clumps in
   filterMod.F90 since setFilters() is called repeatedly in dynamic
   landuse configuration.
5. Vectorized pftdynMod.F90.

Ran test-model on IBM (cheetah) and x86 Linux (anchorage) comparing with
clm3_expa_18.

===============================================================
===============================================================

clm3_expa_18
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Jan 28 16:59:10 MST 2005
Model: CLM
Version: CLM3.expa.18
One-line Summary: put in new interface in clm_csmMod.F90 for BGC generalization
Requires change in build system: no
Tested to work coupled with CCSM: yes
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes (CCSM)
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself, Rob Jacob
Changes answers: no (bit-for-bit) 
Changes made:
Changed clm_csmMod.F90 and csm_share/cpl/cpl_fields_mod.F90 so
that indexing of fields would occur via MCT prompting commands
rather than through parameters.	
===============================================================
===============================================================

clm3_expa_17
Originator: thornton ( Peter Thornton)
Date: Mon Jan 24 10:21:26 MST 2005
Model: CLM
Version: CLM3.expa.17
One-line Summary: modifications to allow water conservation with dynamic pft weights
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Yes (new-physics)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:

Added code that references the pft weight shifts introduced in
clm3_expa_16, and alters state and flux variables to maintain water
mass balance across the weight shift.
1. added routine pftdyn_wbal, called from driver(), that calculates
   the necessary changes in state and flux variables.  The only state variable
   affected are the pft and column level h2ocan (intercepted water stored on
   canopy).  For timesteps in which weight of a PFT increases, the water
   state is spread over the increased area, resulting in lower h2ocan
   concentration, but conserved mass.  For increases from zero weight in the
   previous timestep, the previous h2ocan mass is controlled to be zero.
   For timesteps in which a pft weight is decreasing, the h2ocan mass
   associated with the lost area is transferred to to top of the snow/soil
   column, through a flux in parallel with throughfall. Weight shifting is
   constrained to occur on albedo timesteps.
2. Beginning water balance for the timestep is assessed prior to the weight
   shift, and the end balance is assessed following the weight shift.  Since
   the water balance is assessed at the column level, using pft-level h2ocan
   states that have been averaged to the column based on the new pft weights,
   this ordering will catch mass balance errors associated with incorrectly
   accounting for the pft-level changes in h2ocan mass.
3. pftdyn_interp() is also modified from clm3_expa_16, so that now if a 
   pftdyn dataset is specified and the current model time is before the first
   year of the pftdyn dataset, the first year of the pftdyn dataset is used
   until the model time enters the pftdyn dataset time range.  Likewise, if
   the model time is after the final year of the pftdyn dataset, pft weights
   from the last year of the pftdyn dataset are used for the rest of the 
   simulation.
===============================================================
===============================================================

clm3_expa_16
Originator: mvertens ( Mariana Vertenstein)
Date: Tue Dec 21 13:38:17 MST 2004
Model: CLM
Version: CLM3.expa.16
One-line Summary: incorporated dynamic land use functionality
Requires change in build system: yes (see notes below)
Tested to work coupled with CCSM: no
Tested to work with CAM: yes (no comparison made however)
Machines tested: IBM, Linux(lf95)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Peter Thornton
Changes answers: no (bit-for-bit) 
Changes made:
1) removed generation of surface datasets as part of CLM and created offline tool
   see $ROOTDIR/tools/mksurfdata and look at README file in this directory

2) parameters:
   clm_varpar.F90 - the paramater maxpatch_pft is now set to a cpp token MAXPATCH_PFT
   (note that the cpp token can be set to numpft+1)

3) namelist:
   namelist addition - the following variables have been added to the namelist
     rank_vegpfts, allocate_all_vegpfts, fpftdyn  
   - the following defaults are set for these variables
     fpftdyn = ' '
     if (maxpatch_pft == numpft+1) then	
        allocate_all_vegpfts = .true.
        rank_vegpfts = .false.
     else
        allocate_all_vegpfts = .false.	
        rank_vegpfts = .true. 
     end if
   - if fpftdyn is non-blank: 
      - the dynamic landuse dataset specified by fpftdyn is used at
        every time step to read in and interpolate the weights and 
        a new call to setFilters is done after the weights are read in
      - rank_vegpfts must be false and allocate_all_vegpfts must be true
        if fpftdyn is non-blank
      - SCAM, DGVM and CASA cannot be defined if fpftdyn dyn is non-blank
   - the following namelist options can still be read in (for backwards compatibility)
     but currently do not do anything
        mksrf_fvegtyp, mksrf_fsoitex, mksrf_fsoicol, mksrf_flanwat, &
        mksrf_fglacier, mksrf_furban, mksrf_flai, mksrf_offline_fgrid, &
        mksrf_offline_edgen, mksrf_offline_edgee, mksrf_offline_edges, &
        mksrf_offline_edgew, mksrf_offline_fnavyoro

4) surfFileMod.F90:
   this routine has been completely rewritten in order to facilitate the
   addition of dynamic land use (fpftdyn)
   the public interface - surfrd now contains the following logic:

   surfrd(veg, wtxy)
       call surfrd_get_grid(ncid) 
       call surfrd_wtxy_special(ncid, pctspec, veg, wtxy)
   #if (! defined DGVM)     
       if (rank_vegpfts) then
          call surfrd_wtxy_veg_rank(ncid, pctspec, veg, wtxy)
       else
          call surfrd_wtxy_veg_all(ncid, pctspec, veg, wtxy)
       end if
   #else
       call surfrd_wtxy_veg_dgvm(pctspec, veg, wtxy)
   #endif

   routine surfrd_get_grid reads in grid information from the surface dataset
   and if COUP_CAM or COUP_CSM are defined - compares this grid information
   with that obtained from either the CAM or CSM via the arrays 
   (ext_longxy, ext_latixy, etc)

5) any calculations involving weights have been removed from inicFileMod.F90
   and restFileMod.F90 and put into DriverInitMod.F90. All future coding should
   maintain this requirement the inicFileMod.F90 and restFileMod.F90 do not
   need updated weights for any calculations.

6) initializeMod.F90:
   this routine was completely rewritten in order to facilitate the addition
   of dynamic land use (fpftdyn). New documentation in the routine should help
   the readability:

7) iniTimeConst.F90:
   The following arrays are now local to iniTimeConst.F90 which obtains their
   values in a separate read from the surface dataset. This was done to conserve
   memory as higher resolutions CLM versions are implemented.
     soic2d(lsmlon,lsmlat)         ! read in - soil color
     sand3d(lsmlon,lsmlat,nlevsoi) ! read in - soil texture: percent sand
     clay3d(lsmlon,lsmlat,nlevsoi) ! read in - soil texture: percent clay
     ndep(lsmlon,lsmlat)           ! read in - annual nitrogen deposition rate (gN/m2/yr)

8) iniTimeVar.F90
   this routine has been split up into module mkarbinitMod.f90 and initSurfAlbMod.F90.
   
9) COUP_CAM
   atm_lndMod.F90 and lp_coupling.F90 have been combined into a new module - 
   clm_camMod.F90. All the routines in lp_coupling.F90 are now private to clm_camMod.F90.

10) testing done:
   # summary of tests:
   # T42       : CN on , allocate_all_vegpfts = .true. , maxpatch_pft=4
   # T42cnoff  : CN off, allocate_all_vegpfts = .false., maxpatch_pft=4
   # T42allpfts: CN on , allocate_all_vegpfts = .true. , maxpatch_pft=numpft+1
   # DGVM      : CN off, allocate_all_vegpfts = .false., maxpatch_pft=10
   all final tests were done on ibm and linux(lf95)
   - ran test-model.pl               -c clm3_expa_14 successfully (ibm, linux)
   - ran test-model.pl -res T42cnoff -c clm3_expa_14 successfully (ibm, linux)
   - ran test-model.pl -res DGVM     -c clm3_expa_14 successfully (ibm)
   - verified that ccsm3_0_1_beta03_clm3_expa_16 and ccsm3_0_1_beta03_clm3_expa_14
     were bfb for TSM.01a.T31_gx3v5.I.blackforest
   - verified that ccsm3_0_1_beta03_clm3_expa_16 TER.01a.T31_gx3v5.F.blackforest passed
   - ran test-model.pl successfully cam (cam3_0_21_clm3_expa_16) but did not
     compare to cam3_0_31 (***this still needs to be done***)
   - created dynamic landuse dataset for 1980 and 1981 that had identical
     pft information as the corresponding surface dataset - verified
     that interpolation	was working correctly - however, was not able
     to introduce roundoff level changes for a long time period when
     these dynamic datatset was used since the interpolation introduced
     roundoff level changes in the weights which corrpespondingly
     introduced higher than roundoff level changes in the simulation
     due to the averaging of pft->col weights.	      
===============================================================
	
===============================================================

clm3_expa_15
Originator: forrest (Forrest Hoffman)
Date: Mon Dec 20 14:33:59 MST 2004
Model: CLM
Version: CLM3.expa.15
One-line Summary: CN and subgridAve vector modifications and CASA' flux initialization fix
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM (blackforest and cheetah), i386 Linux (anchorage)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Mariana Vertenstein
Changes answers: no (bit-for-bit) except on Cray X1
Changes made:

CN Vector Modifications
-----------------------
Modified all CN source files in biogeochem/ and main/ to provide vector
performance of code on Cray X1.  Performed offline model validation test on
Cray X1 compared by Peter Thornton against results from the IBM.

subgridAve Vector Modifications
-------------------------------
Modified the subgrid averaging routines to provide vector performance since
they must now be called every timestep for dynamic prescribed vegetation.
CPP_VECTOR must be defined for these code sections to be used; otherwise, the
more compact non-vector version is compiled.

CASA' Flux and Carbon Pool Initialization
-----------------------------------------
fco2, fnpp, and Cflux are now initialized to 0._r8 in initCASA() so that
they are scaled correctly up to the gridcell level.  Vegetation and wood
carbon pools are now scaled either by 1.0 or 0.0 since CASA initial carbon
pool file contains values in terms of vegetation percent averages.

test-model was run on blackforest and cheetah (IBMs) and anchorage (Linux).
test-model no longer runs correctly on the Cray X1, but the validation
demonstrated correct results on the Cray X1.

===============================================================
===============================================================

clm3_expa_14
Originator: mvertens ( Mariana Vertenstein)
Date: Tue Nov 16 15:08:17 MST 2004
Model: CLM
Version: CLM3.expa.14
One-line Summary: bug fix in clm_csmMod.F90
Requires change in build system: no
Tested to work coupled with CCSM: yes
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: see (clm3_expa_13)
Changes made:
1) put in a bug fix that enabled coupled mode to work
2) testing done:	
   validated that coupled mode gave bfb answers with clm3_expa_12 
   when old pft dataset and maxpatch_pfts were used (did F case and K case).
   validated that using maxpatch_pft = 17 worked and gave restarts
   (needed to create a new T31 surface format dataset to do this)	
===============================================================
	
===============================================================

clm3_expa_13
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Nov  1 09:48:45 MST 2004
Model: CLM
Version: CLM3.expa.13
One-line Summary: added allocation for all pfts on new surface dataset
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Linux(lf95)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Peter Thornton
Changes answers:  Yes (same-to-roundoff) - climate validation is needed
Changes made:
	
1) Introduced a new clm namelist, allocate_all_vegpfts, that if set to
   true will reserve memory for numpft+1 pfts on the vegetated
   landunit. This namelist setting is only valid when the new format
   surface dataset is used (with all possible pfts present on the
   gridcell). This namelist setting is not valid in DGVM mode.

2) Changed the calculations so that are done only on pfts where the
   weight relative to the gridcell is greater than 0.

3) Changed the history file code so that if xy output is requested,
   the history buffer is always on the gridcell level and mapping to
   the gridcell is done for every history field at every timestep.

4) loops that went from 1,maxpatch_pft were modified to go from
   1,max_pft_per_col where max_pft_per_col is set to numpft+1 in 
   clm_varpar.F90.
   
5) Changes were as follows:

  o) modified clm_varpar so that 

     integer, parameter :: max_pft_per_gcell = (numpft+1) + 4 + maxpatch_cft
     integer, parameter :: max_pft_per_col   = numpft+1

  o) The following files were change so that calculations were only done
     if the pft weight relative to the gridcell was > 0.

      biogeochem/CNFireMod.F90
      biogeochem/CNGapMortalityMod.F90
      biogeochem/CNPhenologyMod.F90
      biogeochem/DUSTMod.F90
      biogeophys/BalanceCheckMod.F90
      biogeophys/Biogeophysics2Mod.F90
      biogeophys/DriverInitMod.F90
      biogeophys/SoilHydrologyMod.F90
      biogeophys/SoilTemperatureMod.F90
      biogeophys/SurfaceAlbedoMod.F90
      biogeophys/Attic/SurfaceRadiationMod.F90
      main/CNiniTimeVar.F90
      main/clm_csmMod.F90
      main/lnd2atmMod.F90
      main/subgridAveMod.F90

   o) Rewrote CanopyFluxesMod.F90 so that calls to 
      Stomata, StomataCN and FrictionVelocity would not result in array copies
      (modified Stomata and StomataCN to point to clm3 type arrays rather than
      passing these in as arguments).  Also changed calculations so that
      they were only done if the pft weight relative to the gridcell was > 0.

   o) Removed unnecesary variables from DGVMMod.F90

   o) Changed biogeochem/STATICEcosysDynMod.F90 so that logic is more extensible
      in setting mlai, msai, mhvt, mhvtb to non-zero values 

   o) Removed the Error check: global sum fld_o = global sum fld_i in areaMod.F90.
      this resulted in erroneous error messages when running with a reduced grid.

   o) Added allocate_all_vegpfts to clm_varctl.F90 and controlMod.F90. 
      By default this is set to .false.

   o) Modified FilterMod.F90 so that pft filters are only calculated where the
      pft weights relative to the gridcell are greater than 0.

   o) Modified histFileMod.F90 so that history buffer is at the gridcell level
      when xy output is requested. Also 1d history buffer is only updated when
      the weight relative to the gridcell is greater than 0. Also, modified
      histFldsMod.F90 so that RSSHA, RSSUN are now time averaged fields
      and TSNOW, SNOWLIQ and SNOWICE are now instantaneous fields.
 
   o) Modified inicFileMod.F90 so that T_REF2M was added. 

   o) Modified initSubGridMod so that npfts_per_lunit = numpft+1 if allocate_all_vegpfts
      is true.

   o) Modified mlai.F90, mkpft.F90 and mksrfdatMod.F90 so that only new surface data format
      is created.

6) Testing Done:

   incorporated allocate_all_pfts=.true. as default in test-model.pl

   linux (lf95) (anchorage)
      ran test-model.pl               successfully (CN on , full alloc on )
      ran test-model.pl -res T42cnoff successfully (CN off, full alloc on )
      ran test-model.noalloc.pl       successfully (CN on , full alloc off)

      Comparing the diagnostic output from for alloc-on and alloc-off for CN on,
      the output was the same for first 5 time steps and then started diverging. 
      A climate simulation needs to be done to verify that the roundoff level 
      differences results in the same climate.

   ibm-sp (blackforest)
      ran test-model.noalloc.pl and test-model.pl (CN is on)
         diagnostic output was the same for the first 3 timesteps and then started diverging
      ran test-model.noalloc.pl -res T42cnoff and test-model.pl -res T42CNoff (CN is off)
         diagnostic output was the same for the first 8 timesteps and then started diverging
      ran test-model.noalloc.pl -res T42cnoff compared with clm3_expa_12
         verified that only roundoff differences appeared in the history file fields accept
         for RSSHA, RSSUN, TSNOW, SNOWLIQ, SNOWICE (see above)
      ran test-model.hist1d.pl 
      ran test-model.noalloc.hist1d.pl compared with clm3_expa_12 
	 1d history file output was identical except for TSNOW, SNOWLIQ and SNOWICE 
	
   sgi-irix64 (tempest)
      ran test-model.noalloc.pl and test-model.pl (CN is on)
         diagnostic output was the same for the first 3 timesteps and then started diverging
      ran test-model.pl -res T42cnoff (CN is off)
      ran test-model.noalloc.pl -res DGVM 

   ***Note*** testing must still be done for COUP_CSM and COUP_CAM model
   ***Note*** more testing needs to be done with DGVM to validate answers 
   ***Note*** did not test generation of surface datasets, this must also be done
	
===============================================================
===============================================================

clm3_expa_12
Originator: thornton ( Peter Thornton)
Date: Mon Oct 18 13:03:57 MDT 2004
Model: CLM
Version: CLM3.expa.12
One-line Summary: Moved surface albedo call to end of driver loop.
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: yes
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: Yes
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: Mariana Vertenstein, Peter Thornton
Changes answers: Yes (new-physics)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
ccsm3_K_sa1, ccsm3_K_sa2, ccsm3_K_cnsa1, ccsm3_K_cnsa2
Changes made:

Merged loop1 and loop2 in clm driver. Now surface albedo is called at the
end of the loop, and csm_send is called after the loop. This change is the
first step in getting all updates to prognostic variables moved to the end
of the timestep, in preparation for water and carbon isotope code.

===============================================================
===============================================================

clm3_expa_11
Originator: forrest (Forrest Hoffman)
Date: Mon Sep 20 11:49:36 MDT 2004
Model: CLM
Version: CLM3.expa.11
One-line Summary: Added experimental CASA' carbon cycle model to CLM.  Renamed *_transfer* variables in CN code to *_xfer* and modified history field names to match.
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: yes
Machines tested: IBM (cheetah and blackforest), x86 Linux (anchorage), Cray X1 (phoenix)
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself, Jasmin John
Changes answers: no (bit-for-bit)
Changes made:

Added the CASA' carbon cycle model to the CLM code.  CASA' can be used by
compiling with the CASA and SUNSHA cpp variables set.  It can not be used
with either DGVM or CN enabled.

Renamed all *_transfer* variable in the CN code to *_xfer* and modified
history field names consistently, so *_TRANSFER* fields became *_XFER* fields.

Ran test-model on cheetah, blackforest, anchorage, and phoenix.

===============================================================
===============================================================
	
clm3_expa_10
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Aug 25 11:10:34 MDT 2004
Model: CLM
Version: CLM3.expa.10
One-line Summary: put in new subgrid initialization interface
Requires change in build system: no (unless a new crop landunit is desired)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit) (except for roundoff on 2d history files)
Changes made:
1) Removed cpp variable NOCOMPETE from code.
2) Added namelist variable create_crop_landunit.  
   This permits the user to decide if a separate crop landunit is to
   be created with the new surface dataset format (where all pfts appear).
   By default create_crop_andunit is set to .false.
   Removed logic that tied the use of new surface dataset format to the presence
   of a separate crop landunit.
   modified files:
     main/controlMod.F90
     main/surfFileMod.F90
     min/clm_varctl.F90.
3) Unified interface to create gridcells and landunits.
   modified files:
     main/Attic/decompMod.F90
     main/histFileMod.F90
     main/inicFileMod.F90
     main/Attic/initGridCellsMod.F90
   added files:
     main/initGridIndexMod.F90
     main/initSubgridMod.F90
   - all logic to create new landunits now goes in module initSubGridMod.F90.
   - If a new landunit (landunit_xxx) is to be created
      o subroutine get_gcell_info should be modified to contain logic for landunit_xxx
      o a new subroutine set_landunit_xxx should be added to the module
      o a new call to set_landunit_xxx should be added in subroutine initGridCells in 
        module subroutine initGridCellsMod.F90

       call set_landunit_veg_compete( &
            ltype=xxx, wtxy=wtxy, vegxy=vegxy, &
            i=i      , j=j      , gi=gi      , li=li      , ci=ci      , pi=pi, &
            i_sn=i_sn, j_sn=j_sn, gi_sn=gi_sn, li_sn=li_sn, ci_sn=ci_sn, pi_sn=pi_sn, &
            nump=nump, numc=numc, numl=numl, &
            land1d_sn_gi=land1d_sn_gi, cols1d_sn_li=cols1d_sn_li, cols1d_sn_gi=cols1d_sn_gi, &
            pfts1d_sn_ci=pfts1d_sn_ci, pfts1d_sn_li=pfts1d_sn_li, pfts1d_sn_gi=pfts1d_sn_gi)

       note - the only thing that is unique about this call is the setting of ltype.
4) Testing done
   a) ran test-model.pl (with CN on) and verified that code is bfb with clm3_expa_9.
      Note, however, that the 2d history output will have roundoff differences with 
      respect to clm3_expa_9 due to the new calculation of the weights in initSubGridMod.F90.
      Also verified that the initial datasets created with clm3_exap_10 were bfb with clm3_expa_9.
   b) verified that clm3_expa_10 is bfb with clm3_expa_9 when create_crop_landunit=.true..
      and a new format surface dataset is used 
      (fsurdat = '/fs/cgd/csm/inputdata/lnd/clm2/srfdata/csm/surface-data.128x064_atm.gx1v3_ocn.allpfts_c040426.nc).
===============================================================
===============================================================

clm3_expa_9
Originator: thornton ( Peter Thornton)
Date: Sat Aug 14 01:09:21 MDT 2004
Model: CLM
Version: CLM3.expa.9
One-line Summary: Added constraint preventing zero height in CNVegStructUpdateMod.F90
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: Yes (new-physics)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:
Fixed a bug in CNVegStructUpdateMod.F90 that caused divide-by-zero in
FrictionVelocity when htop -> 0.0, causing z0m -> 0.0. Added constraint so that
htop is always greater than 0. Bug only appeared in fire simulation when deadstemc
was forced very low by fire.
===============================================================
===============================================================

clm3_expa_8
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Aug 12 15:35:51 MDT 2004
Model: CLM
Version: CLM3.expa.8
One-line Summary: merged in changes from clm3_deva_10 to clm3_deva_21 except for removal of DUST code
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Changes made:
1) Brought clm_exp branch up to date with clm3_deva_21
   (branch was created starting from clm3_deva_10)
2) Testing done:
   Ran test-model.pl at T42 on IBM and verified that it was 
   bfb with clm3_expa_7
===============================================================
===============================================================

clm3_expa_7
Originator: thornton ( Peter Thornton)
Date: Wed Aug  4 13:29:18 MDT 2004
Model: CLM
Version: CLM3.expa.7
One-line Summary: Added fire to CN code, other minor mods
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: Yes (new-physics)
Changes made:
1. Added Thonicke fire algorithm, working mainly from 2001 paper. Modifications
   to that algorithm made to represent fire occurrence on every timestep, instead of
   as an annual process. Set cpp variable NOFIRE in job script to eliminate the 
   effects of fire algorithm (results bit-for-bit with previous code).
2. Modified CNPrecisionControlMod.F90 to truncate C and N state variables when they
   go below a specified threshold value.  Tracking these modifications in new
   truncation state variables, which accumulate the net changes over a run.
3. Moved CN state update calls and summary call into CNEcosysdyn, from driver.
   (bit-for-bit)
===============================================================
===============================================================

clm3_expa_6
Originator: thornton ( Peter Thornton)
Date: Fri Jul 16 13:17:43 MDT 2004
Model: CLM
Version: CLM3.expa.6
One-line Summary: Added initial file capability for CN code
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: yes (some bug fixes)
Changes made:

1. Added all required fields on initial file for CN start from spunup values
2. (bug fix) Added pepv%tampsum_npp and pepv%annsum_npp to CNSetPepv()
3. (bug fix) Added pepv%prev_leafc_to_litter and pepv%prev_frootc_to_litter
   to CNiniTimeVar().
4. Added totlitn, totsomn, totecosysn, totcoln to column loop of
   CNiniTimeVar(). Added dispvegn, storvegn, totvegn, totpftn to 
   pft loop of CNiniTimeVar().
5. set all c and n state and flux variables to 0.0 on special landunits, instead of spval.  
6. (bug fix) Added missing (p) to frac_veg_nosno in CNiniSpecial().
7. Modified treatment of AGNPP and BGNPP so that they correspond better to
   likely measurements of above and belowground NPP, in CSummary().
8. modified setting for noveg pft rootfr from spval to 0.0

===============================================================
===============================================================

clm3_expa_5
Originator: thornton ( Peter Thornton)
Date: Thu Jul  1 15:37:19 MDT 2004
Model: CLM
Version: CLM3.expa.5
One-line Summary: added two files that were omitted from clm3_expa_4 tag
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Compaq
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Changes made:
added two files (CNNdynamicsMod.F90 and ndepFileMof.F90) that
were omitted from the clm3_expa_4 tag

===============================================================
===============================================================

clm3_expa_4
Originator: thornton ( Peter Thornton)
Date: Tue Jun 29 09:30:18 MDT 2004
Model: CLM
Version: CLM3.expa.4
One-line Summary: Added NDep input, NFix, NLeaching, NSummary
Requires change in build system: no
Modifications to finish the N cycle
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: Yes 
Changes made:
1. Added routine to read a new surface dataset for N deposition (optional)
2. Added routine to estimate biological N fixation as a function of annual NPP
3. Added N leaching routine, function of mineral N concentration and drainage flow
4. Added new N cycle summary variables as standard history file outputs (with CN on)
5. Turned on bulk denitrification (previously implemented, but constant set to 0)
6. Fixed problem with current datasets where temperate deciduous forest was being assigned
   in the tropics - the phenology algorithm for temperate deciduous doesn't work in this case
   because of daylength constraints.  These pfts are now set on initialization to seasonal
   deciduous types.  Solves high-LAI problem in tropics.
7. Fixed bug in calculation of diagnostic total carbon (previously excluded coarse woody debris).
8. Added coarse woody debris decomposition fluxes (previously turned off).
===============================================================
===============================================================

clm3_expa_3
Originator: thornton ( Peter Thornton)
Date: Thu May 27 15:01:39 MDT 2004
Model: CLM
Version: CLM3.expa.3
One-line Summary: Merged Thornton's CN code onto clm_exp branch
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Compaq
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Changes made:
Merged Thornton's CN code from branch clm2_deva_41_brnch_cn onto the new
clm_exp branch.  Tested that the results are BFB for 1-day run against 
clm3_expa_2 with all CN options turned off, and tested that results are
BFB for 1-day run against the final tag on the original CN branch
(clm3_expa_2_brnchT_cn3_9) with all CN options turned on.

===============================================================
===============================================================

clm3_expa_2
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Apr 30 10:21:42 MDT 2004
Model: CLM
Version: CLM3.expa.2
One-line Summary: removed cpl/ code directory from csm_share/ 
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: none
Tested that restarts are bit-for-bit: no
Tested that different domain decompositions match bit-for-bit: no
Code reviewed by: myself
Changes answers: no (bit-for-bit) 
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes made:
Removed cpl/ code directory from csm_share/ - this is never needed
	
===============================================================
===============================================================

clm3_expa_1
Originator: erik ( Erik Kluzek)
Date: Wed Apr 28 14:33:52 MDT 2004
Model: CLM
Version: CLM3.expa.1
One-line Summary: Start of clm_exp experimental development branch -- same as clm3_deva_10
Requires change in build system: no
Tested to work coupled with CCSM: no
Tested to work with CAM: no
Machines tested: IBM, SGI, Linux
Tested that restarts are bit-for-bit: yes
Tested that different domain decompositions match bit-for-bit: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Changes made:

This is the start of the clm_exp experimental development 
branch. This version is the same as clm3_deva_10 which was checked
into clm_dev by Mariana Vertenstein on April 27th, 2004.
===============================================================
===============================================================
===============================================================





















