<!-- Begin introduction preface -->
<preface id="acknowledge">
<prefaceinfo>
<releaseinfo>$Id$</releaseinfo>
</prefaceinfo>
<title>Acknowledgments</title>
<para>
We acknowledge all of the people that helped review or edit the model documentation: 
David Lawrence, Samuel Levis, and Keith Oleson. 
</para>
</preface>

<preface id="intro">
<title>Introduction</title>

<para>
The Community Land Model (&clm;) is the latest in a series of
global land models developed at the National Center for
Atmospheric Research (<acronym>NCAR</acronym>). This guide is intended to instruct both
the novice and experienced user on running &clm;. 
</para>

<para>
The novice user should read
<xref linkend="customize"></xref> in detail before beginning work. While the
expert user should read <xref linkend="what_is_new"></xref> and 
<xref linkend="quickstart"></xref> chapters, and then use the more detailed
chapters as reference. Before novice users go onto more technical problems covered
in <xref linkend="tools"></xref>, <xref linkend="adding_files"></xref>, <xref
linkend="special_cases"></xref>, or the <xref linkend="single_point"></xref> they
should know the material covered in <xref linkend="customize"></xref> and be able
to replicate some of the examples given there. 
</para>
<para>
All users should read the 
<xref linkend="how_to"></xref>
and <xref linkend="help"></xref> sections to understand the document conventions
and the various ways of getting help on using &clm4;. Users should also read
the <xref linkend="whats_validated"></xref> chapter to see if their planned use of the
model is something that has been scientifically validated and well tested. Users
that are NOT using NCAR machines or our list of well tested machines should also
read the <xref linkend="utilities_required"></xref> chapter to make sure they have
all the required UNIX utilities on the system they want to do their work.
</para>
</preface>

<!-- ======================================================================= -->
<preface id="doc_intro">
<title>Introduction to the &clm4; Users Guide</title>
<subtitle>What is in here anyway?</subtitle>

<para>
Here in the introduction we first give a simple guide to understand the document
conventions in <xref linkend="how_to"></xref>. The next <xref linkend="what_is_new"></xref>
goes into detail the differences between &clm40; and &clm35;, both from a scientific
as well as a software engineering point of view. It also details differences in the
configuration, namelist, and history fields. The next <xref linkend="quickstart"></xref>
for users that are already experts in using &clm; gives a quickstart guide to the bare
details on how to use &clm4;. The next <xref linkend="whats_validated"></xref> tells
you about what has been extensively tested and scientifically validated (and maybe more
importantly) what has NOT. <xref linkend="utilities_required"></xref> lists the UNIX utilties
required to use &clm40; and is important if you are running on non-NCAR machines, generic
local machines, or machines NOT as well tested by us at <acronym>NCAR</acronym>. Next we
have <xref linkend="best_practice"></xref> to detail some of the best practices for using
&clm4; for science. The last introduction chapter is <xref linkend="help"></xref> which lists
different resources for getting help with &ccsm4; and &clm4;.
</para>

<para>
The first <xref linkend="customize"></xref> goes into detail on how to setup and run simulations with
&clm4; and especially how to customize cases for things you might be interested in. Details of &configure;
modes and &buildnml; options as well as namelist options are given in this chapter. 
</para>

<para>
The next <xref linkend="tools"></xref> gives instructions on the &clm40; tools for creating input datasets
for use by &clm;, for the expert user. There's an overview of what each tool does, and some general notes on how to build 
the FORTRAN tools. Then each tool is described in detail and different ways you might use it. A final section
on how to customize datasets for observational sites for very savvy expert users is given as the last section of this chapter.
</para>

<para>
As a followup to the tools chapter the next <xref linkend="adding_files"></xref> tells how to add files to the
XML database for &buildnml; to use. This is important if you want to use the XML database to automatically select
input files that you have created when you setup new cases with &clm;.
</para>

<para>
In the next <xref linkend="special_cases"></xref> again for the expert user we give details on how to do some particularly
difficult special cases. For example, we give the protocol for spinning up both the &clmcn; model and &clm; with dynamic
vegetation active <acronym>CNDV</acronym>. We also talk about validating a port to a new machine using the Perturbation error
growth technique. And finally we tell the user how to use the DATM model to send historical &CO2; data to &clm;.
</para>

<para>
The final <xref linkend="single_point"></xref> is on how to do single-point simulations using &clm4; rather than global gridded
simulations. This is useful to either compare &clm; simulations with point observational stations, such as tower sites, or
to do quick simulations with &clm; for a specific climate regime. There are a couple different ways given on how to perform
single-point simulations which range from simple &PTSMODE; to more complex where you create all your own datasets, tying into
the <xref linkend="tools"></xref> and also <xref linkend="adding_files"></xref> to add the files into the &buildnml; XML database.
</para>

<para>
In <xref linkend="editing_templates"></xref> we give some basic background to the &clm; developer on how to edit the 
<filename>models/lnd/clm/bld/clm.cpl7.template</filename>. This is a very difficult exercise and we don't recommend it for
any, but the most advanced users of &clm; who are also experts in UNIX and UNIX scripting.
</para>

<!--
<sect1 id="listsofthings">
<title>List of Tables, Figures and Examples</title>

<sect2 id="lot">
<title>List of Tables</title>

<para>
List of tables in the document.
</para>
<lot id="listoftables">
<lotentry>Empty</lotentry>
<lotentry linkend="table_required_files">Required Files<xref linkend="required_files"></xref></lotentry>
<lotentry pagenum="31">Page 31</lotentry>
<lotentry pagenum="57">Page 57</lotentry>
</lot>
</sect2>

<sect2 id="loe">
<title>List of Examples</title>
<para>
List of formal examples in the document.
</para>

<lot id="listofexamples">
<lotentry linkend="quickstart">Example of Running &clm4; on bluefire at 2-degree Resolution with Data Atmosphere Model</lotentry>
<lotentry linkend="default_nml">Example of the Default Namelist</lotentry>
<lotentry linkend="add_rm_primary_hist">Example of Namelist Adding and Removing Fields from the Primary History Files</lotentry>
<lotentry linkend="add_aux_hist_chng_output_frq">Example of Namelist Add Auxillary History Files and Change the Output History Frequency</lotentry>
<lotentry linkend="rm_hist">Example of Namelist Removing All History Files</lotentry>
<lotentry linkend="hist_averaging">Example of Namelist with Different Ways of Averaging on History Files</lotentry>
<lotentry linkend="hist_vector">Example of Namelist Outputting History Fields as a 1D Vector</lotentry>
<lotentry linkend="CN_SPINUP">Example of Doing a Spinup for CN</lotentry>
<lotentry linkend="CNDV_SPINUP">Example of Doing a Spinup for CNDV</lotentry>
<lotentry linkend="PERGRO">Example of Doing Perturbation Error Growth Testing to Help Validate a Port to a New Machine</lotentry>
<lotentry linkend="DATM_CO2_TSERIES">Example of Sending Historical &CO2; Data from the Data Atmosphere Model</lotentry>
</lot>
</sect2>

</sect1>
-->

</preface>

<!-- ======================================================================= -->

<preface id="best_practice">
<title>Important Notes and Best Practices for Usage of &clm4;</title>

<para>
The main important note for using &clm4; especially with &clmcn; is that you
need to startup from spun-up initial conditions. We've provided a few spun-up
datasets for 1-degree and 2-degree resolutions, but you'll need to do your own
spinup's for other resolutions.
</para>
</preface>


<!-- ======================================================================= -->
<preface id="how_to">
<!--
<prefaceinfo>
<itermset>
   <indexterm zone="how_to" id="EDITOR"><primary>$EDITOR</primary></indexterm>
</itermset>
</prefaceinfo>
-->
<title>How to Use This Document</title>
<subtitle>Conventions used in the document for code and commands</subtitle>

<para>
This section provides the details in using &clm; with the &ccsm; modeling
system. Links to descriptions and definitions have been provided in the code below.
We use the same conventions used in the &ccsm; documentation as outlined below.
</para>

<screen>
Throughout the document this style is used to indicate shell
commands and options, fragments of code, namelist variables, etc.
Where examples from an interactive shell session are presented, lines
starting with > indicate the shell prompt.  Note that $EDITOR" is used
to refer to the text editor of your choice. $EDITOR is a standard UNIX
environment variable and should be set on most UNIX systems. Comment
lines are signaled to start with a "#" sign, which is the standard UNIX
comment sign as well.

> This is a shell prompt.
> $EDITOR filename # means you are using a text editor to edit the file "filename"
# This is a comment line

</screen>

</preface>


<!-- ======================================================================= -->
<preface id="what_is_new">
<!--
<prefaceinfo>
<itermset>
   <indexterm zone="science" id="clmcn"><primary>&clmcn;</primary></indexterm>
   <indexterm zone="science" id="clmsp"><primary>&clmsp;</primary></indexterm>
</itermset>
</prefaceinfo>
-->
<title>What is new with &clm4; since &clm35;?</title>

<para>
Since &clm35; there have been advances in both the science and the software infrastructure.
There are also new configure and namelist options as well as new history fields. In this
section we will describe each of these changes in turn.
</para>

<sect1 id="science">
<title>What is new with &clm4; Science?</title>
<para>
The following aspects are changes to the science in &clm; since &clm35;.
</para>
<para>
Changes to &clm4; beyond &clm35; (Oleson et al., 2008a; Stockli et al., 2008) include
updates throughout the model. The hydrology scheme has been modified with a revised
numerical solution of the Richards equation (Zeng and Decker, 2009; Decker and Zeng,
2009); a revised soil evaporation parameterization that removes the soil resistance term
introduced in &clm35; and replaces it with a so-called	formulation, as well as accounts for the role of litter and within-
canopy stability (Sakaguchi and Zeng, 2009).
</para>
<para>
The snow model is significantly modified via incorporation of SNICAR (SNow and Ice Aerosol Radiation) which represents the effect of aerosol deposition (e.g. black and organic carbon and dust) on albedo, introduces a grain-size dependent snow aging parameterization, and permits vertically resolved snowpack heating (Flanner and Zender, 2005; Flanner and Zender, 2006; Flanner et al., 2007). The new snow model also includes a new density-dependent snow cover fraction parameterization (Niu and Yang, 2007), a revised snow burial fraction over short vegetation (Wang and Zeng, 2009) and corrections to snow compaction (Lawrence and Slater, 2009).
</para>
<para>
&clm4; also includes a representation of the thermal and hydraulic properties of organic soil that operates in conjunction with the mineral soil properties (Lawrence and Slater, 2008). The ground column has been extended to ~50-m depth by adding five additional hydrologically inactive ground layers (making a total of 15 ground layers, 10 soil layers and 5 bedrock layers; Lawrence et al., 2008). An urban landunit and associated urban canyon model has been added which permits the study of urban climate and urban heat island effects (Oleson et al., 2008b). The PFT distribution is as in Lawrence and Chase (2007) except that a new cropping dataset is used (Ramankutty et al., 2008) and a grass PFT restriction has been put in place to reduce a high grass PFT bias in forested regions by replacing the herbaceous fraction with low trees rather than grass. Grass and crop PFT optical properties have been adjusted according to values presented in Asner et al. (1998), resulting in significantly reduced albedo biases. Soil colors have been re-derived according to the new PFT distribution.
</para>
<para>
The model is extended with a carbon-nitrogen biogeochemical model (Thornton et al., 2007;
Thornton et al., 2009; Randerson et al., 2009) which is referred to as &clmcn;. CN is
based on the terrestrial biogeochemistry Biome-BGC model with prognostic carbon and
nitrogen cycle (Thornton et al., 2002; Thornton and Rosenbloom, 2005). &clmcn; is
prognostic with respect to carbon and nitrogen state variables in the vegetation, litter,
and soil organic matter. Vegetation phenology and canopy heights are also prognostic. A
detailed description of the biogeochemical component can be found in Thornton et al.
(2007). Note that &clm4; can be run with either prescribed satellite phenology
(&clmsp;) or with prognostic phenology provided by the carbon- nitrogen cycle model 
(&clmcn;).  Additionally, a transient land cover and land use change, including wood harvest,
capability has been introduced that enables the evaluation of the impact of historic and
future land cover and land use change on energy, water, and momentum fluxes as well as
carbon and nitrogen fluxes.	The dynamic global vegetation model in &clm3; has been
revised such that the carbon dynamics (e.g. productivity, decomposition, phenology,
allocation, etc.) are controlled by CN and only the dynamic vegetation biogeography
(competition) aspect of the &clm3; DGVM is retained.
</para>
<para>
Several other minor changes have been incorporated including a change to the atmospheric reference height so that it is the height above zo+d for all surface types. The convergence of
canopy roughness length zo and displacement height d to bare soil values as the
above-ground biomass, or the sum of leaf and stem area indices, goes to zero is ensured
(Zeng and Wang, 2007). Several corrections have been made to the way the offline forcing
data is interpreted. The main change is a vastly improved and smooth diurnal cycle of
incoming solar radiation that conserves the total incoming solar radiation from the
forcing dataset. Additionally, in offline mode rather than partitioning incoming solar
radiation into a constant 70%/30% direct vs diffuse split, it is partitioned according to
empirical equations that are a function of total solar radiation. Finally, to improve
global energy conservation in fully coupled simulations, runoff is split into separate
liquid and ice water streams that are passed separately to the ocean. Input to the ice
water comes from excess snowfall in snow-capped regions. The biogenic volatile organic
compounds model (BVOC) that was available in &clm3; has been replaced with the MEGAN BVOC model (Heald et al. 2008).
</para>
<para>
Taken together, these augmentations to &clm35; result in improved soil moisture dynamics
that lead to higher soil moisture variability and drier soils. Excessively wet and
unvarying soil moisture was recognized as a deficiency in &clm35; (Oleson et al. 2008a,
Decker and Zeng, 2009). The revised model also simulates, on average, higher snow cover,
cooler soil temperatures in organic-rich soils, greater global river discharge, lower
albedos over forests and grasslands, and higher transition-season albedos in snow covered
regions, all of which are improvements compared to &clm35;.
</para>
</sect1>
<sect1 id="software">
<title>What is new with &clm4; Software Infrastructure?</title>
<para>
The following aspects are changes to the software infrastructure in &clm; since &clm35;.
</para>
<para>
<simplelist>
    <member>Update to cpl7 and scripts.</member>
    <member>Remove offline and cpl6 modes.</member>
    <member>Remove support for CASA model.</member>
    <member>Update to datm8 atmospheric data model.</member>
    <member>Add gx3v7 land mask for T31 and fv-4x5 horizontal resolutions.</member>
    <member>Add gx1v6 land mask for f05, f09, and f19 horizontal resolutions.</member>
    <member>Add tx1v1 land mask and 1.9x2.5_tx1v1 horizontal resolution.</member>
    <member>Add in 2.5x3.33 horizontal resolution.</member>
    <member>Add in T62 horizontal resolution so can run at same resolution as input datm
data.</member>
    <member>Allow first history tape to be 1D.</member>
    <member>Add ability to use own version of input datasets with &CLMUSRDAT;
variable.</member>
    <member>Add a script to extract out regional datasets.</member>
    <member>New &buildnml; system with XML file describing all namelist
items.</member>
    <member>Add glacier_mec use-case and stub glacier model.</member>
    <member>Add &ncl; script to time-interpolate between 1850 and 2000 for fndepdat
dataset, for fndepdyn version.</member>
    <member>Make default of maxpatch_pft=numpft+1 instead of 4.</member>
    <member>Only output static 3D fields on first h0 history file to save space.</member>
    <member>Add new fields for VOC (Volatile Organic Compounds) on surface datasets, 
    needed for the new MEGAN VOC model.</member>
    <member>Add irrigation area to mksurfdata tool (NOT used in &clm; yet).</member>
    <member>Add multiple elevation class option for glaciers in mksurfdata tool (NOT used
in &clm; yet).</member>
    <member>Add ascale field to land model in support of model running on it's own
grid.</member>
</simplelist>
</para>
</sect1>

<sect1 id="new_config">
<title>What are The New Configuration Options?</title>
<para>
<programlisting>
Describe any changes made to build system:

   Change directory structure to match &ccsm;.
   Add BGP target.
   Add choice between ESMF and MCT frameworks.
   Start removing #ifdef and directives that supported Cray-X1 Phoenix as now decommisioned.
   Make default of maxpatch_pft=numpft+1 instead of 4 for all configurations.
   By default turn on CLAMP when either CN or CASA is enabled
   New SNICAR_FRC, CARBON_AERO, and C13 CPP ifdef tokens.

   New options added to &configure;:

     -comp_intf &lt;name&gt;>   Component interface to use (ESMF or MCT) (default MCT)
     -nofire             Turn off wildfires for bgc setting of CN (default includes fire for CN)
     -pio &lt;name&gt;         Switch enables building with Parallel I/O library. [on | off] (default is on)
     -snicar_frc &lt;name&gt;  Turn on SNICAR radiative forcing calculation. [on | off] (default is off)
</programlisting>
More information on options to clm &configure; are given in <xref linkend="clm_configure_script"></xref>.
</para>
</sect1>

<sect1 id="new_namelist">
<title>What are The New Namelist Options?</title>
<para>
<programlisting>
Describe any changes made to the namelist:

   NOTE: &buildnml; now checks the validity of your namelist you generate by looking at data in the namelist_definition.xml
         file. In order to add new namelist items you need to change the code and also edit this file. To view information
         on the namelist view the file:
         models/lnd/clm/bld/namelist_files/namelist_definition.xml
         in your browser and you'll see the names, type, description and valid_values for all namelist variables.

   Changes to &buildnml;:
     Transient sim_year ranges (i.e. 1850-2000)
     Remove cam_hist_case option.
     Make sure options ONLY used for stand-alone testing have a "drv_" or "datm_" prefix in them and list these
     options all together and last when asking for help from &buildnml;.
   New options to &buildnml;:
     -clm_usr_name     "name" Dataset resolution/descriptor for personal datasets. Default: not used
                              Example: 1x1pt_boulderCO_c090722 to describe location,
                                       number of pts, and date files created
   New list options to &buildnml;
     &buildnml; -res list          # List valid resolutions
     &buildnml; -mask list         # List valid land-masks
     &buildnml; -sim_year list     # List valid simulation years and simulation year ranges
     &buildnml; -clm_demand list   # List namelist variables including those you could demand to be included.
     &buildnml; -use_case list     # List valid use-cases

     New use-cases for:

   1850_control = Conditions to simulate 1850 land-use
   2000_control = Conditions to simulate 2000 land-use
20thC_transient = Simulate transient land-use, and aerosol deposition changes from 1850 to 2005
    glacier_mec = Placeholder for running IG cases with the ice sheet model glimmer

   New namelist items:

        urban_hac = OFF, ON or ON_WASTEHEAT   (default OFF)     Flag for urban Heating and Air-Conditioning
                                                       OFF          = Building internal temperature is un-regulated.
                                                       ON           = Building internal temperature is bounded to reasonable range.
                                                       ON_WASTEHEAT = Building internal temperature is bounded and resultant waste
                                                                      heat is given off.
        urban_traffic = .true. or .false.     (default .false.) Flag to include additional multiplicative factor of urban traffic
                                                                to sensible heat flux.
        fsnowoptions = filename          file for snow/aerosol optical properties (required)
        fsnowaging   = filename          file for snow aging parameters (required)
        faerdep      = filename          file of aerosol deposition (required)
</programlisting>
More information on the &buildnml; options are given in how to use <link linkend="CLMBLDNML">&CLMBLDNML;</link> and in <xref
linkend="nl_def"></xref>.
</para>
</sect1>

<sect1 id="new_history">
<title>What are The New History Fields?</title>
<para>
<programlisting>
  New history variables: (note watt vs. W in units, 26 vs. 76)
     BCDEP                      total BC deposition (dry+wet) from atmosphere                kg/m^2/s
     BIOGENCO                   biogenic CO flux                                             uGC/M2/H
     C13_PRODUCT_CLOSS          C13 total carbon loss from wood product pools                gC13/m^2/s
     DSTDEP                     total dust deposition (dry+wet) from atmosphere              kg/m^2/s
     EFLX_DYNBAL                dynamic land cover change conversion energy flux             W/m^2
     FGR12                      heat flux between soil layers 1 and 2                        watt/m^2
     FSAT                       fractional area with water table at surface                  unitless
     FSH_NODYNLNDUSE		sensible heat flux not including correction for land use change
                                                                                             watt/m^2
     GC_HEAT1                   initial gridcell total heat content                          J/m^2
     GC_HEAT2                   post land cover change total heat content                    J/m^2    inactive
     GC_ICE1                    initial gridcell total ice content                           mm/s
     GC_ICE2                    post land cover change total ice content                     mm/s     inactive
     GC_LIQ1                    initial gridcell total liq content                           mm
     GC_LIQ2                    initial gridcell total liq content                           mm       inactive
     H2OSNO_TOP                 mass of snow in top snow layer                               kg
     HEAT_FROM_AC               sensible heat flux put into canyon due to heat removed from air conditioning
                                                                                             watt/m^2
     HK                         hydraulic conductivity                                       mm/s     inactive
     ISOPRENE                   isoprene flux                                                uGC/M2/H
     LAND_USE_FLUX              total C emitted from land cover conversion and wood product pools gC/m^2/s
     LAND_UPTAKE                NEE minus LAND_USE_FLUX, negative for update                 gC/m^2/s
     LWup                       upwelling longwave radiation                                 watt/m^2 inactive
     MONOTERP                   monoterpene flux                                             uGC/M2/H
     NBP                        net biome production, includes fire, landuse, and harvest flux, positive for sink
                                                                                             gC/m^2/s
     OCDEP                      total OC deposition (dry+wet) from atmosphere                kg/m^2/s
     OVOC                       other VOC flux                                               uGC/M2/H
     ORVOC                      other reactive VOC flux                                      uGC/M2/H
     PBOT                       atmospheric pressure                                         Pa
     PCO2                       atmospheric partial pressure of &CO2;                        Pa
     PRODUCT_CLOSS              total carbon loss from wood product pools                    gC/m^2/s
     PRODUCT_NLOSS              total N loss from wood product pools                         gN/m^2/s
     Qair                       atmospheric specific humidity                                kg/kg    inactive
     Qanth                      anthropogenic heat flux                                      watt/m^2 inactive
     Qtau                       momentum flux                                                kg/m/s^2
     QFLX_LIQ_DYNBAL            liq dynamic land cover change conversion runoff flux         mm/s
     QFLX_ICE_DYNBAL            ice dynamic land cover change conversion runoff flux         mm/s
     QRUNOFF_NODYNLNDUSE        total liquid runoff not including correction for land use change (does not include QSNWCPICE) 
                                                                                             mm/s
     QSNWCPICE                  excess snowfall due to snow capping                          mm/s
     QSNWCPICE_NODYNLNDUSE      excess snowfall due to snow capping not including correction for land use change
                                                                                             mm/s
     QSNWCPLIQ                  excess rainfall due to snow capping                          mm/s     inactive
     SMP                        soil matric potential                                        mm       inactive
     SNOAERFRC2L                surface forcing of all aerosols in snow, averaged only when snow is present (land)
                                                                                             watt/m^2
     SNOAERFRCL                 surface forcing of all aerosols in snow (land)               watt/m^2
     SNOBCFRCL                  surface forcing of BC in snow (land)                         watt/m^2
     SNOBCMCL                   mass of BC in snow column                                    kg/m2
     SNOBCMSL                   mass of BC in top snow layer                                 kg/m2
     SNOdTdzL                   top snow layer temperature gradient (land)                   K/m
     SNODSTFRC2L                surface forcing of dust in snow, averaged only when snow is present (land)
                                                                                             watt/m^2
     SNODSTFRCL                 surface forcing of dust in snow (land)                       watt/m^2
     SNODSTMCL                  mass of dust in snow column                                  kg/m2
     SNODSTMSL                  mass of dust in top snow layer                               kg/m2
     SNOFSRND                   direct nir reflected solar radiation from snow               watt/m^2 inactive
     SNOFSRNI                   diffuse nir reflected solar radiation from snow              watt/m^2 inactive
     SNOFSRVD                   direct vis reflected solar radiation from snow               watt/m^2 inactive
     SNOFSRVI                   diffuse vis reflected solar radiation from snow              watt/m^2 inactive
     SNOFSDSND                  direct nir incident solar radiation on snow                  watt/m^2 inactive
     SNOFSDSNI                  diffuse nir incident solar radiation on snow                 watt/m^2 inactive
     SNOFSDSVD                  direct vis incident solar radiation on snow                  watt/m^2 inactive
     SNOFSDSVI                  diffuse vis incident solar radiation on snow                 watt/m^2 inactive
     SNOLIQFL                   top snow layer liquid water fraction (land)                  fraction inactive
     SNOOCMCL                   mass of OC in snow column                                    kg/m2
     SNOOCMSL                   mass of OC in top snow layer                                 Kg/m2
     SNOOCFRC2L                 surface forcing of OC in snow, averaged only when snow is present (land)
     SNOOCFRCL                  surface forcing of OC in snow (land)                         watt/m^2
                                                                                             watt/m^2
     SNORDSL                    top snow layer effective grain radius                        m^-6     inactive
     SNOTTOPL                   snow temperature (top layer)                                 K/m      inactive
     SWup                       upwelling shortwave radiation                                watt/m^2 inactive
     TSOI_10CM                  soil temperature in top 10cm of soil                         K
     URBAN_AC                   urban air conditioning flux                                  watt/m^2
     URBAN_HEAT                 urban heating flux                                           watt/m^2
     VOCFLXT                    total VOC flux into atmosphere                               uGC/M2/H
     Wind                       atmospheric wind velocity magnitude                          m/s      inactive
     WOOD_HARVESTC              wood harvest (to product pools)                              gC/m^2/s
     WOOD_HARVESTN              wood harvest (to product pools)                              gN/m^2/s

  History field name changes:

     ANNSUM_PLANT_NDEMAND  = ANNSUM_POTENTIAL_GPP
     ANNSUM_RETRANSN       = ANNMAX_RETRANSN
     C13_DWT_PROD10C_LOSS  = C13_PROD10C_LOSS
     C13_DWT_PROD100C_LOSS = C13_PROD100C_LOSS
     C13_DWT_PROD10N_LOSS  = C13_PROD10N_LOSS
     C13_DWT_PROD100C_LOSS = C13_PROD100C_LOSS
     DWT_PROD100N_LOSS     = PROD10N_LOSS
     DWT_PROD100N_LOSS     = PROD100N_LOSS
     DWT_PROD100C_LOSS     = PROD10C_LOSS
     DWT_PROD100C_LOSS     = PROD100C_LOSS
     HCSOISNO              = HC
     TEMPSUM_PLANT_NDEMAND = TEMPSUM_POTENTIAL_GPP
     TEMPSUM_RETRANSN      = TEMPMAX_RETRANSN

   History field names deleted:
     SNOWAGE, TSNOW, FMICR, FCO2, DMI, QFLX_SNOWCAP

  Add new urban oriented _U, and _R (Urban and Rural) for:
        EFLX_LH_TOT, FGR, FIRA, FSH, FSM, Q2M, QRUNOFF, RH2M, SoilAlpha, TG, TREFMNAV, TREFMXAV, and TSA
        (missing _R for SoilAlpha)

</programlisting>

</para>
</sect1>

</preface>

<!-- ======================================================================= -->
<preface id="quickstart">
<title>Quickstart to using &clm4;</title>
<para>
Before working with &clm4; read the QuickStart Guide in the
<ulink url="http://www.ccsm.ucar.edu/models/ccsm4.0/ccsm_doc/book1.html">&ccsm4;
Scripts User Guide</ulink>. Once you are familiar with how to setup cases for 
any type of simulation with &ccsm; you will want to direct your attention to the specifics
of using &clm;.
</para>
<para>
For some of the details of setting up cases for &clm4; read the README and text files available
from the "models/lnd/clm/doc" directory (see the "&clm; Web pages" section for a link to the list
of these files). Here are the important ones that you should be familiar with.
<orderedlist>
<listitem><para><ulink url="../README">README</ulink> file describing the directory structure.</para></listitem>
<listitem><para><ulink url="../Quickstart.userdatasets">Quickstart.userdatasets</ulink> file describing how to
use your own datasets in the model (also see <xref linkend="own_single_point_datasets"></xref>).</para></listitem>
<listitem><para><ulink url="../KnownBugs">KnownBugs</ulink> file describing known
problems in &clm4;.</para></listitem>
</orderedlist>
</para>
<para>The <emphasis>IMPORTANT_NOTES</emphasis> file is given in the next chapter on what
is functional/validated in &clm4;?
</para>
<para>The <emphasis>ChangeLog/ChangeSum</emphasis> files are largely explained in the previous chapter on "What is new with
&clm4;?"</para>
<para>
Note other directories have README files that explain different components and tools used
when running &clm; and are useful in
understanding how those parts of the model work and should be consulted when using tools in those directories.
For more details on configuring and customizing a case with CLM see <xref linkend="customize"></xref>.
</para>
<para>The <emphasis>Quickstart.GUIDE</emphasis> is repeated in the section below.</para>
<programlisting>
&quickstart_guide;
</programlisting>
</preface>
<!-- ======================================================================= -->
<preface id="whats_validated">
<title>What is scientifically validated and functional in &clm4;?</title>
<para>
In this section we go over what has been extensively tested and scientifically validated
with &clm40;, and maybe more importantly what has NOT been tested and may NOT be
scientifically validated. You can use all features of &clm;, but need to realize that
some things haven't been tested extensively or validated scientifically. When you use
these features you may run into trouble doing so, and will need to do your own work to
make sure the science is reasonable.
</para>

<sect1 id="standard_validated">
<title>Standard Configuration and Namelist Options that are Validated</title>
<para>
The standard version of the model is &clmcn; at 1-degree horizontal resolution (0.9x1.25). This version has been scientifically
validated with long simulations for: fully coupled simulations ("B" cases), coupled to atmosphere model CAM ("F" cases), and stand-alone CLM
cases ("I" cases). We've also done both long simulations for 1850 conditions, and transient 20th century simulations from 1850 to 2005 (with
transient land-use, Nitrogen and Aerosol deposition). To a lesser extent there have also been simulations done at 2-degree horizontal 
resolution (1.9x2.5), and with &clmsp; for these resolutions. As such we have provided appropriate 1-degree and 2-degree initial condition
datasets for these configurations. Other resolutions, configurations, and namelist options are less well tested or scientifically validated.
The further you get away from the standard configurations and resolutions, the more likely you are to run into trouble, and/or need to
scientifically validate your work.
</para>
<para>
In the sections below we go through configuration and/or namelist options or modes that the user should be especially wary of using. You
are of course free to use these options, and you may find that they work functionally. Although in some cases you will find issues even
with functionality of using them. If so you will need to test, debug and find solutions for these issues on your own. But in every case 
you will need to go through more extensive work to validate these options from a scientific standpoint.
</para>
</sect1>

<sect1 id="config_not_validated">
<title>Configure Modes NOT scientifically validated, documented, supported or even advised to be used:</title>
<para>
<orderedlist>
<listitem>
   <para>
   <varname>C13</varname><screen>(-c13)</screen>
       The C13 mode for bgc=cn is NOT scientifically validated or documented and NOT recommended to be used.
   </para>

</listitem>
<listitem>
   <para>
   <varname>CASA</varname><screen>(-bgc casa)</screen>
       The bgc=casa mode is NOT scientifically validated or documented and NOT recommended to be used.
   </para>

</listitem>
<listitem>
   <para>
   <varname>SUPLN</varname><screen>(-bgc cn -supln on)</screen>
       The supplemental Nitrogen mode of the CN Biogeochemistry model is known to be over
productive.
       And hence not recommended to be used.
   </para>

</listitem>
<listitem>
   <para>
   <varname>BUILDPIO</varname><screen>(-pio)</screen>
       This mode is NOT tested and not even functional and hence should NOT be used. PIO WILL be provided
       in future versions however.
   </para>
</listitem>
<listitem>
   <para>
   <varname>SNICAR_FRC</varname><screen>(-snicar_frc)</screen>
       This mode is tested and functional, but is NOT constantly scientifically validated, and should be 
       considered experimental.
   </para>
</listitem>
<listitem>
   <para>
   <varname>PERGRO</varname><screen>(-pergro)</screen>
       This mode is tested to be functional, but NOT scientifically validated. It's purpose is in an attempt
       to validate that a port to a new machine is reasonable, or changes that are only roundoff will NOT 
       affect the climate. The best method for this validation is to run 100 year simulations with both and
       make sure the climate is similar between each. We hope to validate the method using PERGRO in future
       versions of the model.
   </para>
</listitem>
</orderedlist>
</para>
</sect1>

<sect1 id="nml_not_validated">
<title>Namelist options that should NOT be exercised:</title>
<sect2 id="bld_nml_not_validated">
<title>Build-Namelist options that should NOT be exercised:</title>
<para>
<orderedlist>
<listitem><para><emphasis>-lnd_res:</emphasis>  Fine-mesh mode, functional, but experimental</para>
</listitem>
<listitem><para><emphasis>-rcp:</emphasis>  Representative Concentration Pathway (RCP)
for future scenarios, functional for limited resolutions, but experimental</para>
</listitem>
<listitem><para><emphasis>-datm_*:</emphasis>  All options that start with "datm_" they are
only used for &clm; stand-alone testing.</para>
</listitem>
<listitem><para><emphasis>-drv_*:</emphasis>  All options that start with "drv_" they are
only used for &clm; stand-alone testing.</para>
</listitem>
</orderedlist>
</para>
</sect2>

<sect2 id="nml_items_not_validated">
<title>Namelist items that should NOT be exercised:</title>
<para>
<orderedlist>
<listitem><para><emphasis>casa namelist options:</emphasis> lnpp, lalloc, q10, spunup, and fcpool

        As above CASA is NOT scientifically validated and hence we don't recommend using it, thus we don't
        recommend using the casa namelist options (they are only available when running with CASA).</para>
</listitem>
<listitem><para><emphasis>create_crop_landunit:</emphasis>  Functional, but experimental</para>
</listitem>
<listitem><para><emphasis>fine-mesh namelist options:</emphasis> flndtopo, and fatmtopo.
        These options are functional but experimental. See the -lnd_res option above.</para>
</listitem>
<listitem><para><emphasis>pio namelist options:</emphasis>  hist_pioflag, ncd_lowmem2d, ncd_pio_def, ncd_pio_UseRearranger, ncd_pio_UseBoxRearr, 
                         ncd_pio_SerialCDF, ncd_pio_DebugLevel, and ncd_pio_num_iotasks
        These options are NOT currently tested or functional. See the pio &configure; mode above.</para>
</listitem>
<listitem><para><emphasis>urban_traffic:</emphasis>         Not currently functional</para>
</listitem>
</orderedlist>
</para>
</sect2>
</sect1>
</preface>

<!-- ======================================================================= -->
<preface id="utilities_required">
<title>What are the UNIX utilities required to use &clm;?</title>
<para>
Running the &clm; requires a suite of UNIX utilities and programs and you should
make sure you have all of these available before trying to go forward with using
it. If you are missing one of these you should contact the systems administrator
for the machine you wish to run on and make sure they are installed.
<simplelist>
<member>&FORTRAN90; compiler</member>
<member>"C" compiler</member>
<member>GNU make</member>
<member>UNIX csh and tcsh shells</member>
<member>UNIX sh shell</member>
<member>UNIX bash shell</member>
<member>UNIX awk</member>
<member>UNIX sed</member>
<member>&netcdf; library</member>
<member>MPI Library</member>
<member>"C" pre-processor</member>
<member>&perl;</member>
<member>Autoconf</member>
<member>m4 macro processor</member>
<member>Parallel &netcdf; (optional)</member>
<member>&ncl; (for some of the offline tools for creating/modifying &clm; input
datasets see <xref linkend="tools"></xref> for more information on &ncl;)</member>
</simplelist>
</para>
</preface>

<!-- ======================================================================= -->
<preface id="help">
<!--
<prefaceinfo>
<itermset>
  <indexterm zone="CCSM_BB"><primary>&ccsm; Online Bulletin Board</primary></indexterm>
  <indexterm zone="CCSM_UG"><primary>&ccsm4; Scripts Users-Guide</primary></indexterm>
</itermset>
</prefaceinfo>
-->
<title>Other resources to get help from</title>

<para>
Outside this users-guide there are several other resources that we recommend you get help
with when using CLM. The first one is the &ccsm; Users-Guide, which documents the entire
process of creating cases with &ccsm;. The next is the &ccsm; bulletin board which is 
a web-site for exchanging information between users of &ccsm;. Next there are &clm;
web-pages specific for &clm;, and finally there is an email address to report bugs that
you find in &ccsm4;.
</para>

<sect1 id="CCSM_UG">
<title>The &ccsm; Users-Guide</title>
<para>
&clm4; is always run from within the standard &ccsm4; build and run scripts. Therefore, the
user of &clm4;
should familiarize themselves with the &ccsm4; scripts and understand and know how to work with them.
Users-Guide documentation on the &ccsm4; scripts are available from the following web-page. The purpose
of this &clm4; Users Guide is to give the &clm4; user better descriptions and more details on how to work
with &clm; and the set of tools that support &clm;, as well as give examples that are unique to the use
of &clm;. But, the &ccsm4; Scripts Users-Guide is the source to get detailed understanding of how to build
and run the &ccsm; system in total.
<simplelist>
<member><ulink url="http://www.ccsm.ucar.edu/models/ccsm4.0/ccsm_doc/book1.html">&ccsm4; Scripts
Users-Guide</ulink></member>
</simplelist>
</para>
</sect1>

<sect1 id="CCSM_BB">
<title>The &ccsm; Bulletin Board</title>
<para>
There is a rich and diverse set of people that use the &ccsm;, and often it is useful to be in contact with
others to get help in solving problems or trying something new. To facilitate this we have an online
Bulletin Board for questions on the &ccsm;. There are also different sections in the Bulletin Board for
the different component models or for different topics.
<simplelist>
<member><ulink url="http://bb.cgd.ucar.edu/">&ccsm; Online Bulletin Board</ulink></member>
</simplelist>
</para>
</sect1>

<sect1 id="CLM_web">
<title>The &clm; web pages</title>
<para>
The main &clm; web page contains information on the &clm;, it's history, developers, as well as
downloads for previous model versions. There are also documentation text files in the 
models/lnd/clm/doc directory that give some quick information on using &clm;.
<simplelist>
<member><ulink url="http://www.cgd.ucar.edu/tss/clm/">&clm; web page</ulink></member>
<member><ulink url="../">&clm; Documentation Text Files</ulink></member>
</simplelist>
</para>
</sect1>

<sect1 id="reporting_bugs">
<title>Reporting bugs in &clm4;</title>
<para>
If you have any problems, additional questions, bug reports, or any other feedback, please send an email to
<email>ccsm4-help@cgd.ucar.edu</email>.
</para>
</sect1>

</preface>



<!-- End introduction preface -->
